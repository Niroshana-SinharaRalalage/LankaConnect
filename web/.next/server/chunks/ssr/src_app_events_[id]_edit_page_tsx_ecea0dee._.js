module.exports=[13670,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(210),f=a.i(92e3),g=a.i(50388),h=a.i(93003),i=a.i(50253),j=a.i(42043),k=a.i(95245),l=a.i(59501),m=a.i(37927),n=a.i(41675),o=a.i(24987),p=a.i(60246),q=a.i(90166),r=a.i(4720),s=a.i(33350),t=a.i(33508),u=a.i(92258),v=a.i(13858),w=a.i(22544),x=a.i(75391),y=a.i(72988),z=a.i(69212),A=a.i(29312),B=a.i(18478),C=a.i(90154),D=a.i(74934);function E({event:a}){let e=(0,d.useRouter)(),f=(0,m.useQueryClient)(),{user:g}=(0,y.useAuthStore)(),[h,E]=(0,c.useState)(null),[F,G]=(0,c.useState)(!1),{data:H=[],isLoading:I}=(0,B.useEmailGroups)(),J=(0,c.useCallback)(a=>"number"==typeof a?a:({Religious:z.EventCategory.Religious,Cultural:z.EventCategory.Cultural,Community:z.EventCategory.Community,Educational:z.EventCategory.Educational,Social:z.EventCategory.Social,Business:z.EventCategory.Business,Charity:z.EventCategory.Charity,Entertainment:z.EventCategory.Entertainment})[a]??z.EventCategory.Community,[]),K=(0,c.useCallback)(a=>"number"==typeof a&&a>=1&&a<=6?a:"string"==typeof a?({USD:z.Currency.USD,LKR:z.Currency.LKR,GBP:z.Currency.GBP,EUR:z.Currency.EUR,CAD:z.Currency.CAD,AUD:z.Currency.AUD})[a]??z.Currency.USD:z.Currency.USD,[]),L=a=>{let b=new Date(a),c=b.getFullYear(),d=String(b.getMonth()+1).padStart(2,"0"),e=String(b.getDate()).padStart(2,"0"),f=String(b.getHours()).padStart(2,"0"),g=String(b.getMinutes()).padStart(2,"0");return`${c}-${d}-${e}T${f}:${g}`},{register:M,handleSubmit:N,watch:O,reset:P,setValue:Q,control:R,formState:{errors:S}}=(0,k.useForm)({resolver:(0,l.zodResolver)(x.editEventSchema),defaultValues:{title:a.title,description:a.description,category:J(a.category),startDate:L(a.startDate),endDate:L(a.endDate),capacity:a.capacity,isFree:a.isFree??!0,enableDualPricing:a.hasDualPricing??!1,enableGroupPricing:a.hasGroupPricing??!1,ticketPriceAmount:void 0,ticketPriceCurrency:void 0,adultPriceAmount:void 0,adultPriceCurrency:void 0,childPriceAmount:void 0,childPriceCurrency:void 0,childAgeLimit:void 0,groupPricingTiers:[],locationAddress:a.address||void 0,locationCity:a.city||void 0,locationState:a.state||void 0,locationZipCode:a.zipCode||void 0,locationCountry:a.country||void 0,emailGroupIds:a.emailGroupIds||[]}});(0,c.useEffect)(()=>{let b=J(a.category),c=a.ticketPriceCurrency?K(a.ticketPriceCurrency):z.Currency.USD,d=a.adultPriceCurrency?K(a.adultPriceCurrency):z.Currency.USD,e=a.childPriceCurrency?K(a.childPriceCurrency):z.Currency.USD;console.log("ðŸ”„ Resetting form with event data:",{eventId:a.id,category:a.category,categoryType:typeof a.category,categoryNumber:b,isFree:a.isFree,hasDualPricing:a.hasDualPricing,hasGroupPricing:a.hasGroupPricing,adultPriceAmount:a.adultPriceAmount,adultPriceCurrency:a.adultPriceCurrency,adultCurrencyConverted:d,childPriceAmount:a.childPriceAmount,childPriceCurrency:a.childPriceCurrency,childCurrencyConverted:e,childAgeLimit:a.childAgeLimit,ticketPriceAmount:a.ticketPriceAmount,ticketPriceCurrency:a.ticketPriceCurrency,ticketCurrencyConverted:c,emailGroupIds:a.emailGroupIds,emailGroupsCount:a.emailGroupIds?.length||0});let f=a.hasDualPricing??!1,g=a.hasGroupPricing??!1,h=!a.isFree&&!f&&!g;P({title:a.title,description:a.description,category:b,startDate:L(a.startDate),endDate:L(a.endDate),capacity:a.capacity,isFree:a.isFree,ticketPriceAmount:h?a.ticketPriceAmount??void 0:void 0,ticketPriceCurrency:h?c:void 0,enableDualPricing:f,adultPriceAmount:f?a.adultPriceAmount??void 0:void 0,adultPriceCurrency:f?d:void 0,childPriceAmount:f?a.childPriceAmount??void 0:void 0,childPriceCurrency:f?e:void 0,childAgeLimit:f?a.childAgeLimit??void 0:void 0,enableGroupPricing:g,groupPricingTiers:g&&a.groupPricingTiers?a.groupPricingTiers.map(a=>({...a,currency:K(a.currency)})):void 0,locationAddress:a.address||void 0,locationCity:a.city||void 0,locationState:a.state||void 0,locationZipCode:a.zipCode||void 0,locationCountry:a.country||void 0,emailGroupIds:a.emailGroupIds||[]})},[a.id]);let T=O("isFree"),U=O("enableDualPricing"),V=O("enableGroupPricing"),{fields:W,append:X,remove:Y}=(0,k.useFieldArray)({control:R,name:"groupPricingTiers"}),Z=N(async b=>{if(!g?.userId)return void E("You must be logged in to edit events");if(a.organizerId!==g.userId)return void E("You can only edit your own events");try{let c,d;G(!0),E(null),console.log("ðŸ“‹ Form Submission - Updating Event:",{eventId:a.id,userId:g.userId,userRole:g.role});let h=!!(b.locationAddress&&b.locationCity);if(h){console.log("ðŸ—ºï¸ Geocoding address for location-based filtering...");let a=await (0,C.geocodeAddress)(b.locationAddress,b.locationCity,b.locationState||void 0,b.locationCountry||"United States",b.locationZipCode||void 0);a?(c=a.latitude,d=a.longitude,console.log("âœ… Geocoding successful:",{lat:c,lon:d,display:a.displayName})):console.warn("âš ï¸ Geocoding failed - event will not appear in location-based filters")}let i=new Date(b.startDate).toISOString(),j=new Date(b.endDate).toISOString(),k=!b.isFree&&b.enableDualPricing,l=!b.isFree&&b.enableGroupPricing,m=!b.isFree&&!b.enableDualPricing&&!b.enableGroupPricing,n={eventId:a.id,title:b.title,description:b.description,startDate:i,endDate:j,capacity:b.capacity,category:b.category,emailGroupIds:b.emailGroupIds||[],...h&&{locationAddress:b.locationAddress,locationCity:b.locationCity,locationState:b.locationState||null,locationZipCode:b.locationZipCode||null,locationCountry:b.locationCountry||null,locationLatitude:c??null,locationLongitude:d??null},ticketPriceAmount:m?b.ticketPriceAmount:null,ticketPriceCurrency:m?b.ticketPriceCurrency:null,adultPriceAmount:k?b.adultPriceAmount:null,adultPriceCurrency:k?b.adultPriceCurrency:null,childPriceAmount:k?b.childPriceAmount:null,childPriceCurrency:k?b.childPriceCurrency:null,childAgeLimit:k?b.childAgeLimit:null,...l&&b.groupPricingTiers&&b.groupPricingTiers.length>0&&{groupPricingTiers:b.groupPricingTiers.map(a=>({minAttendees:a.minAttendees,maxAttendees:a.maxAttendees??null,pricePerPerson:a.pricePerPerson,currency:a.currency}))}};console.log("ðŸ“¤ Updating event with payload:",JSON.stringify(n,null,2)),console.log("ðŸ“‹ Event details before update:",{eventId:a.id,eventStatus:a.status,isFree:b.isFree,pricingMode:k?"dual":m?"single":"free",ticketPriceAmount:b.ticketPriceAmount,enableDualPricing:b.enableDualPricing,adultPriceAmount:b.adultPriceAmount,childPriceAmount:b.childPriceAmount,childAgeLimit:b.childAgeLimit}),console.log("ðŸŒ API Request Details:",{url:`/events/${a.id}`,method:"PUT",payloadSize:JSON.stringify(n).length,payloadKeys:Object.keys(n)}),await A.eventsRepository.updateEvent(a.id,n),console.log("âœ… Event updated successfully!"),await f.invalidateQueries({queryKey:D.eventKeys.detail(a.id)}),await f.invalidateQueries({queryKey:D.eventKeys.lists()}),console.log("ðŸ”„ Cache invalidated - fresh data will be fetched"),e.push(`/events/${a.id}/manage`)}catch(a){console.error("âŒ Event update failed:",a),E(a instanceof Error?a.message:"Failed to update event. Please try again.")}finally{G(!1)}}),$=[{value:z.EventCategory.Religious,label:"Religious"},{value:z.EventCategory.Cultural,label:"Cultural"},{value:z.EventCategory.Community,label:"Community"},{value:z.EventCategory.Educational,label:"Educational"},{value:z.EventCategory.Social,label:"Social"},{value:z.EventCategory.Business,label:"Business"},{value:z.EventCategory.Charity,label:"Charity"},{value:z.EventCategory.Entertainment,label:"Entertainment"}];return(0,b.jsxs)("form",{onSubmit:Z,className:"space-y-6",children:[(0,b.jsxs)(i.Card,{children:[(0,b.jsxs)(i.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(r.FileText,{className:"h-5 w-5",style:{color:"#FF7900"}}),(0,b.jsx)(i.CardTitle,{style:{color:"#8B1538"},children:"Basic Information"})]}),(0,b.jsx)(i.CardDescription,{children:"Update the essential details about your event"})]}),(0,b.jsxs)(i.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-neutral-700 mb-2",children:"Event Title *"}),(0,b.jsx)(v.Input,{id:"title",type:"text",placeholder:"e.g., Sri Lankan Cultural Festival 2025",error:!!S.title,...M("title")}),S.title&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.title.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-neutral-700 mb-2",children:"Event Description *"}),(0,b.jsx)("textarea",{id:"description",rows:6,placeholder:"Provide a detailed description of your event, including what attendees can expect...",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 resize-none ${S.description?"border-destructive":"border-neutral-300"}`,...M("description")}),S.description&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.description.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"category",className:"block text-sm font-medium text-neutral-700 mb-2",children:"Event Category *"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(s.Tag,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-neutral-400"}),(0,b.jsx)("select",{id:"category",className:`w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 appearance-none ${S.category?"border-destructive":"border-neutral-300"}`,...M("category",{valueAsNumber:!0}),children:$.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))})]}),S.category&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.category.message})]})]})]}),(0,b.jsxs)(i.Card,{children:[(0,b.jsxs)(i.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(n.Calendar,{className:"h-5 w-5",style:{color:"#FF7900"}}),(0,b.jsx)(i.CardTitle,{style:{color:"#8B1538"},children:"Date & Time"})]}),(0,b.jsx)(i.CardDescription,{children:"Update when your event will take place"})]}),(0,b.jsx)(i.CardContent,{className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"startDate",className:"block text-sm font-medium text-neutral-700 mb-2",children:"Start Date & Time *"}),(0,b.jsx)(v.Input,{id:"startDate",type:"datetime-local",error:!!S.startDate,...M("startDate")}),S.startDate&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.startDate.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"endDate",className:"block text-sm font-medium text-neutral-700 mb-2",children:"End Date & Time *"}),(0,b.jsx)(v.Input,{id:"endDate",type:"datetime-local",error:!!S.endDate,...M("endDate")}),S.endDate&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.endDate.message})]})]})})]}),(0,b.jsxs)(i.Card,{children:[(0,b.jsxs)(i.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(o.MapPin,{className:"h-5 w-5",style:{color:"#FF7900"}}),(0,b.jsx)(i.CardTitle,{style:{color:"#8B1538"},children:"Location"})]}),(0,b.jsx)(i.CardDescription,{children:"Update where the event will take place (Optional but recommended)"})]}),(0,b.jsxs)(i.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"locationAddress",className:"block text-sm font-medium text-neutral-700 mb-2",children:"Street Address"}),(0,b.jsx)(v.Input,{id:"locationAddress",type:"text",placeholder:"e.g., 123 Main Street",error:!!S.locationAddress,...M("locationAddress")}),S.locationAddress&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.locationAddress.message})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"locationCity",className:"block text-sm font-medium text-neutral-700 mb-2",children:"City"}),(0,b.jsx)(v.Input,{id:"locationCity",type:"text",placeholder:"e.g., Columbus",error:!!S.locationCity,...M("locationCity")}),S.locationCity&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.locationCity.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"locationState",className:"block text-sm font-medium text-neutral-700 mb-2",children:"State"}),(0,b.jsx)(v.Input,{id:"locationState",type:"text",placeholder:"e.g., Ohio",error:!!S.locationState,...M("locationState")}),S.locationState&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.locationState.message})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"locationZipCode",className:"block text-sm font-medium text-neutral-700 mb-2",children:"ZIP Code"}),(0,b.jsx)(v.Input,{id:"locationZipCode",type:"text",placeholder:"e.g., 43201",error:!!S.locationZipCode,...M("locationZipCode")}),S.locationZipCode&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.locationZipCode.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"locationCountry",className:"block text-sm font-medium text-neutral-700 mb-2",children:"Country"}),(0,b.jsx)(v.Input,{id:"locationCountry",type:"text",placeholder:"e.g., United States",error:!!S.locationCountry,...M("locationCountry")}),S.locationCountry&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.locationCountry.message})]})]})]})]}),(0,b.jsxs)(i.Card,{children:[(0,b.jsxs)(i.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(p.Users,{className:"h-5 w-5",style:{color:"#FF7900"}}),(0,b.jsx)(i.CardTitle,{style:{color:"#8B1538"},children:"Capacity & Pricing"})]}),(0,b.jsx)(i.CardDescription,{children:"Update attendance limits and ticket pricing"})]}),(0,b.jsxs)(i.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"capacity",className:"block text-sm font-medium text-neutral-700 mb-2",children:"Maximum Capacity *"}),(0,b.jsx)(v.Input,{id:"capacity",type:"number",min:"1",max:"10000",placeholder:"e.g., 100",error:!!S.capacity,...M("capacity",{valueAsNumber:!0})}),S.capacity&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.capacity.message})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-neutral-50 rounded-lg",children:[(0,b.jsx)("input",{id:"isFree",type:"checkbox",className:"h-5 w-5 rounded border-neutral-300 text-orange-500 focus:ring-2 focus:ring-orange-500",...M("isFree")}),(0,b.jsx)("label",{htmlFor:"isFree",className:"text-sm font-medium text-neutral-700",children:"This is a free event (no ticket purchase required)"})]}),!T&&(0,b.jsxs)("div",{className:"space-y-4 p-4 border-2 border-orange-200 rounded-lg bg-orange-50",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)(q.DollarSign,{className:"h-5 w-5",style:{color:"#FF7900"}}),(0,b.jsx)("h4",{className:"text-sm font-semibold text-neutral-900",children:"Ticket Pricing"})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-white rounded-lg border border-orange-200",children:[(0,b.jsx)("input",{id:"enableDualPricing",type:"checkbox",className:"h-5 w-5 rounded border-neutral-300 text-orange-500 focus:ring-2 focus:ring-orange-500",...M("enableDualPricing",{onChange:a=>{a.target.checked&&Q("enableGroupPricing",!1)}})}),(0,b.jsx)("label",{htmlFor:"enableDualPricing",className:"text-sm font-medium text-neutral-700",children:"Enable Adult/Child Pricing (different prices for adults and children)"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-white rounded-lg border border-orange-200",children:[(0,b.jsx)("input",{id:"enableGroupPricing",type:"checkbox",className:"h-5 w-5 rounded border-neutral-300 text-orange-500 focus:ring-2 focus:ring-orange-500",...M("enableGroupPricing",{onChange:a=>{a.target.checked&&Q("enableDualPricing",!1)}})}),(0,b.jsx)("label",{htmlFor:"enableGroupPricing",className:"text-sm font-medium text-neutral-700",children:"Enable Group Tiered Pricing (quantity-based discounts for groups)"})]})]}),!U&&!V&&(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"ticketPriceAmount",className:"block text-sm font-medium text-neutral-700 mb-2",children:"Ticket Price *"}),(0,b.jsx)(v.Input,{id:"ticketPriceAmount",type:"number",min:"0",max:"10000",step:"1",placeholder:"e.g., 25",error:!!S.ticketPriceAmount,...M("ticketPriceAmount",{valueAsNumber:!0})}),S.ticketPriceAmount&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.ticketPriceAmount.message}),(O("ticketPriceAmount")??0)>0&&(0,b.jsxs)("div",{className:"mt-2 p-2 bg-gray-50 border border-gray-200 rounded text-xs text-gray-600",children:[(0,b.jsx)("p",{children:"5% Stripe + LankaConnect commission applies"}),(0,b.jsxs)("p",{className:"font-medium text-green-700",children:["You'll receive: $",((O("ticketPriceAmount")??0)*.95).toFixed(2)," per ticket"]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"ticketPriceCurrency",className:"block text-sm font-medium text-neutral-700 mb-2",children:"Currency *"}),(0,b.jsxs)("select",{id:"ticketPriceCurrency",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 ${S.ticketPriceCurrency?"border-destructive":"border-neutral-300"}`,defaultValue:z.Currency.USD,...M("ticketPriceCurrency",{valueAsNumber:!0}),children:[(0,b.jsx)("option",{value:z.Currency.USD,children:"USD ($)"}),(0,b.jsx)("option",{value:z.Currency.LKR,children:"LKR (Rs)"})]}),S.ticketPriceCurrency&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.ticketPriceCurrency.message})]})]}),U&&!V&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"adultPriceAmount",className:"block text-sm font-medium text-neutral-700 mb-2",children:"Adult Ticket Price *"}),(0,b.jsx)(v.Input,{id:"adultPriceAmount",type:"number",min:"0",max:"10000",step:"1",placeholder:"e.g., 25",error:!!S.adultPriceAmount,...M("adultPriceAmount",{valueAsNumber:!0})}),S.adultPriceAmount&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.adultPriceAmount.message}),(O("adultPriceAmount")??0)>0&&(0,b.jsxs)("div",{className:"mt-2 p-2 bg-gray-50 border border-gray-200 rounded text-xs text-gray-600",children:[(0,b.jsx)("p",{children:"5% Stripe + LankaConnect commission applies"}),(0,b.jsxs)("p",{className:"font-medium text-green-700",children:["You'll receive: $",((O("adultPriceAmount")??0)*.95).toFixed(2)," per ticket"]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"adultPriceCurrency",className:"block text-sm font-medium text-neutral-700 mb-2",children:"Currency *"}),(0,b.jsxs)("select",{id:"adultPriceCurrency",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 ${S.adultPriceCurrency?"border-destructive":"border-neutral-300"}`,defaultValue:z.Currency.USD,...M("adultPriceCurrency",{valueAsNumber:!0}),children:[(0,b.jsx)("option",{value:z.Currency.USD,children:"USD ($)"}),(0,b.jsx)("option",{value:z.Currency.LKR,children:"LKR (Rs)"})]}),S.adultPriceCurrency&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.adultPriceCurrency.message})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"childPriceAmount",className:"block text-sm font-medium text-neutral-700 mb-2",children:"Child Ticket Price *"}),(0,b.jsx)(v.Input,{id:"childPriceAmount",type:"number",min:"0",max:"10000",step:"1",placeholder:"e.g., 15",error:!!S.childPriceAmount,...M("childPriceAmount",{valueAsNumber:!0})}),S.childPriceAmount&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.childPriceAmount.message}),(O("childPriceAmount")??0)>0&&(0,b.jsxs)("div",{className:"mt-2 p-2 bg-gray-50 border border-gray-200 rounded text-xs text-gray-600",children:[(0,b.jsx)("p",{children:"5% Stripe + LankaConnect commission applies"}),(0,b.jsxs)("p",{className:"font-medium text-green-700",children:["You'll receive: $",((O("childPriceAmount")??0)*.95).toFixed(2)," per ticket"]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"childPriceCurrency",className:"block text-sm font-medium text-neutral-700 mb-2",children:"Currency *"}),(0,b.jsxs)("select",{id:"childPriceCurrency",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 ${S.childPriceCurrency?"border-destructive":"border-neutral-300"}`,defaultValue:z.Currency.USD,...M("childPriceCurrency",{valueAsNumber:!0}),children:[(0,b.jsx)("option",{value:z.Currency.USD,children:"USD ($)"}),(0,b.jsx)("option",{value:z.Currency.LKR,children:"LKR (Rs)"})]}),S.childPriceCurrency&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.childPriceCurrency.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"childAgeLimit",className:"block text-sm font-medium text-neutral-700 mb-2",children:"Child Age Limit *"}),(0,b.jsx)(v.Input,{id:"childAgeLimit",type:"number",min:"1",max:"18",placeholder:"12",error:!!S.childAgeLimit,...M("childAgeLimit",{valueAsNumber:!0})}),S.childAgeLimit&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.childAgeLimit.message}),(0,b.jsx)("p",{className:"mt-1 text-xs text-neutral-500",children:"Age under which child pricing applies (1-18)"})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,b.jsx)("svg",{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:(0,b.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),(0,b.jsx)("p",{className:"text-xs text-blue-700",children:"Example: If child age limit is 12, attendees age 11 and under will be charged the child price, while attendees age 12 and over will be charged the adult price."})]})]}),V&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-semibold text-neutral-900",children:"Group Pricing Tiers"}),(0,b.jsx)("p",{className:"text-xs text-neutral-600 mt-1",children:"Edit pricing tiers by changing the attendee numbers and prices below"})]}),(0,b.jsxs)(j.Button,{type:"button",variant:"outline",onClick:()=>X({minAttendees:W.length>0?(O(`groupPricingTiers.${W.length-1}.maxAttendees`)??0)+1:1,maxAttendees:null,pricePerPerson:0,currency:z.Currency.USD}),className:"flex items-center gap-2",children:[(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Tier"]})]}),W.length>0&&(0,b.jsx)("div",{className:"space-y-4",children:W.map((a,c)=>{let d=O(`groupPricingTiers.${c}.pricePerPerson`)??0;return(0,b.jsxs)("div",{className:"p-4 bg-white border-2 border-orange-200 rounded-lg space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("h5",{className:"text-sm font-semibold text-neutral-900",children:["Tier ",c+1]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("span",{className:"text-xs bg-orange-100 text-orange-700 px-2 py-1 rounded",children:["Original: ",a.minAttendees,a.maxAttendees?`-${a.maxAttendees}`:"+"," attendees"]}),(0,b.jsx)("button",{type:"button",onClick:()=>Y(c),className:"p-1 hover:bg-red-50 rounded transition-colors",title:"Delete this tier",children:(0,b.jsx)(t.X,{className:"h-4 w-4 text-red-600"})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Min Attendees *"}),(0,b.jsx)(v.Input,{type:"number",min:"1",max:"10000",...M(`groupPricingTiers.${c}.minAttendees`,{valueAsNumber:!0}),error:!!S.groupPricingTiers?.[c]?.minAttendees}),S.groupPricingTiers?.[c]?.minAttendees&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.groupPricingTiers[c]?.minAttendees?.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Max Attendees"}),(0,b.jsx)(v.Input,{type:"number",min:"1",max:"10000",placeholder:"Leave empty for unlimited",...M(`groupPricingTiers.${c}.maxAttendees`,{setValueAs:a=>""===a||null==a?null:parseInt(a)}),error:!!S.groupPricingTiers?.[c]?.maxAttendees}),(0,b.jsx)("p",{className:"mt-1 text-xs text-neutral-500",children:'Leave empty for unlimited (e.g., "3+")'}),S.groupPricingTiers?.[c]?.maxAttendees&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.groupPricingTiers[c]?.maxAttendees?.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Price Per Person *"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("select",{className:"px-2 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",...M(`groupPricingTiers.${c}.currency`,{valueAsNumber:!0}),children:[(0,b.jsx)("option",{value:z.Currency.USD,children:"USD ($)"}),(0,b.jsx)("option",{value:z.Currency.LKR,children:"LKR (Rs)"})]}),(0,b.jsx)(v.Input,{type:"number",min:"0",max:"10000",step:"1",...M(`groupPricingTiers.${c}.pricePerPerson`,{valueAsNumber:!0}),error:!!S.groupPricingTiers?.[c]?.pricePerPerson})]}),S.groupPricingTiers?.[c]?.pricePerPerson&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.groupPricingTiers[c]?.pricePerPerson?.message}),d>0&&(0,b.jsxs)("div",{className:"mt-2 p-2 bg-gray-50 border border-gray-200 rounded text-xs text-gray-600",children:[(0,b.jsx)("p",{children:"5% (Stripe + LankaConnect commission) applies"}),(0,b.jsxs)("p",{className:"font-medium text-green-700",children:["You'll receive: $",(.95*d).toFixed(2)," per person"]})]})]})]})]},a.id)})}),(0,b.jsxs)("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,b.jsx)("h5",{className:"text-xs font-semibold text-blue-900 mb-1",children:"Tier Guidelines:"}),(0,b.jsxs)("ul",{className:"text-xs text-blue-700 space-y-1 list-disc list-inside",children:[(0,b.jsx)("li",{children:"First tier must start at 1 attendee"}),(0,b.jsx)("li",{children:"Tiers must be continuous with no gaps"}),(0,b.jsx)("li",{children:"All tiers must use the same currency"}),(0,b.jsx)("li",{children:"Only the last tier can have unlimited max attendees"})]})]}),S.groupPricingTiers&&"object"==typeof S.groupPricingTiers&&"message"in S.groupPricingTiers&&(0,b.jsx)("p",{className:"mt-2 text-sm text-destructive",children:S.groupPricingTiers.message})]})]})]})]}),(0,b.jsxs)(i.Card,{children:[(0,b.jsxs)(i.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(u.Mail,{className:"h-5 w-5",style:{color:"#FF7900"}}),(0,b.jsx)(i.CardTitle,{style:{color:"#8B1538"},children:"Email Groups (Optional)"})]}),(0,b.jsx)(i.CardDescription,{children:"Select email groups to notify about this event"})]}),(0,b.jsx)(i.CardContent,{className:"space-y-4",children:(0,b.jsx)(w.MultiSelect,{options:H.map(a=>({id:a.id,label:a.name,disabled:!a.isActive})),value:O("emailGroupIds")||[],onChange:a=>Q("emailGroupIds",a),placeholder:"Select email groups to notify",isLoading:I,error:!!S.emailGroupIds,errorMessage:S.emailGroupIds?.message,helperText:"Select groups that should receive invitations for this event"})})]}),(0,b.jsx)(i.Card,{children:(0,b.jsx)(i.CardContent,{className:"py-6",children:(0,b.jsxs)("div",{className:"flex items-start gap-3 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,b.jsx)("div",{className:"flex-shrink-0",children:(0,b.jsx)("svg",{className:"w-5 h-5 text-blue-600 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,b.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h4",{className:"text-sm font-semibold text-blue-900 mb-1",children:"ðŸ“¸ Manage Images & Videos"}),(0,b.jsx)("p",{className:"text-sm text-blue-700",children:"You can add or remove event images and videos from the event detail page."})]})]})})}),Object.keys(S).length>0&&(0,b.jsxs)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-red-700 mb-2",children:"Please fix the following errors:"}),(0,b.jsx)("ul",{className:"text-sm text-red-600 space-y-1 list-disc list-inside",children:Object.entries(S).map(([a,c])=>(0,b.jsxs)("li",{children:[(0,b.jsxs)("strong",{children:[a,":"]})," ",c.message||"Invalid value"]},a))})]}),h&&(0,b.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,b.jsx)("p",{className:"text-sm text-red-600",children:h})}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-4",children:[(0,b.jsx)(j.Button,{type:"button",variant:"outline",onClick:()=>e.push(`/events/${a.id}/manage`),disabled:F,children:"Cancel"}),(0,b.jsx)(j.Button,{type:"submit",disabled:F,style:{background:"#FF7900"},className:"min-w-[150px]",children:F?"Updating...":"Update Event"})]})]})}var F=a.i(64734);function G({params:a}){let{id:k}=(0,c.use)(a),l=(0,d.useRouter)(),{user:m,isAuthenticated:n}=(0,y.useAuthStore)(),{data:o,isLoading:p,error:q}=(0,D.useEventById)(k);return((0,c.useEffect)(()=>{n&&m?.userId?m.role!==F.UserRole.EventOrganizer&&m.role!==F.UserRole.Admin&&m.role!==F.UserRole.AdminManager&&l.push("/dashboard"):l.push("/login?redirect="+encodeURIComponent(`/events/${k}/edit`))},[n,m,l,k]),(0,c.useEffect)(()=>{o&&m&&o.organizerId!==m.userId&&m.role!==F.UserRole.Admin&&m.role!==F.UserRole.AdminManager&&l.push(`/events/${k}`)},[o,m,l,k]),!p&&n&&m?.userId)?q||!o?(0,b.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-neutral-50 to-white",children:[(0,b.jsx)(g.Header,{}),(0,b.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:(0,b.jsx)(i.Card,{children:(0,b.jsxs)(i.CardContent,{className:"p-12 text-center",children:[(0,b.jsx)(f.AlertCircle,{className:"h-16 w-16 mx-auto mb-4 text-destructive"}),(0,b.jsx)("h3",{className:"text-xl font-semibold text-neutral-900 mb-2",children:"Event Not Found"}),(0,b.jsx)("p",{className:"text-neutral-500 mb-6",children:"The event you're trying to edit doesn't exist or has been removed."}),(0,b.jsx)(j.Button,{onClick:()=>l.push("/events"),children:"Back to Events"})]})})}),(0,b.jsx)(h.default,{})]}):(0,b.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-neutral-50 to-white",children:[(0,b.jsx)(g.Header,{}),(0,b.jsxs)("div",{className:"bg-gradient-to-r from-orange-600 via-rose-800 to-emerald-800 py-12 relative overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute inset-0 opacity-10",children:(0,b.jsx)("div",{className:"absolute inset-0",style:{backgroundImage:"url(\"data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")"}})}),(0,b.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute -top-24 -left-24 w-96 h-96 bg-orange-400/20 rounded-full blur-3xl"}),(0,b.jsx)("div",{className:"absolute -bottom-24 -right-24 w-96 h-96 bg-emerald-400/20 rounded-full blur-3xl"}),(0,b.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-rose-400/10 rounded-full blur-3xl"})]}),(0,b.jsx)("div",{className:"relative max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("h1",{className:"text-4xl font-bold text-white mb-4",children:"Edit Event"}),(0,b.jsx)("p",{className:"text-lg text-white/90 max-w-2xl mx-auto",children:"Update your event details and keep your attendees informed"})]})})]}),(0,b.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,b.jsxs)(j.Button,{variant:"outline",onClick:()=>l.push(`/events/${k}/manage`),className:"flex items-center gap-2",children:[(0,b.jsx)(e.ArrowLeft,{className:"h-4 w-4"}),"Back to Manage Event"]})}),(0,b.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 pb-12",children:(0,b.jsx)(E,{event:o})}),(0,b.jsx)(h.default,{})]}):(0,b.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-neutral-50 to-white",children:[(0,b.jsx)(g.Header,{}),(0,b.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:(0,b.jsx)(i.Card,{className:"animate-pulse",children:(0,b.jsxs)(i.CardContent,{className:"p-12",children:[(0,b.jsx)("div",{className:"h-8 bg-neutral-200 rounded w-3/4 mb-4"}),(0,b.jsx)("div",{className:"h-4 bg-neutral-200 rounded w-1/2 mb-8"}),(0,b.jsx)("div",{className:"h-64 bg-neutral-200 rounded mb-8"})]})})}),(0,b.jsx)(h.default,{})]})}a.s(["default",()=>G],13670)}];

//# sourceMappingURL=src_app_events_%5Bid%5D_edit_page_tsx_ecea0dee._.js.map