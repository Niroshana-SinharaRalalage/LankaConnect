(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,75244,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(57022);let a=s.forwardRef(({className:e,type:s="text",error:a,...i},n)=>(0,t.jsx)("input",{type:s,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a&&"border-destructive focus-visible:ring-destructive",e),ref:n,"aria-invalid":a?"true":void 0,...i}));a.displayName="Input",e.s(["Input",()=>a])},42490,e=>{"use strict";var t=e.i(48831);class s{basePath="/auth";async login(e,s=!1){return await t.apiClient.post(`${this.basePath}/login`,{...e,rememberMe:s})}async register(e){return await t.apiClient.post(`${this.basePath}/register`,e)}async refreshToken(e){return await t.apiClient.post(`${this.basePath}/refresh-token`,{refreshToken:e})}async logout(){await t.apiClient.post(`${this.basePath}/logout`)}async requestPasswordReset(e){return await t.apiClient.post(`${this.basePath}/forgot-password`,{email:e})}async resetPassword(e,s){return await t.apiClient.post(`${this.basePath}/reset-password`,{token:e,newPassword:s})}async verifyEmail(e){return await t.apiClient.post(`${this.basePath}/verify-email`,{token:e})}async resendVerificationEmail(e){return await t.apiClient.post(`${this.basePath}/resend-verification`,{email:e})}async testVerifyEmail(e){return await t.apiClient.post(`${this.basePath}/test/verify-user/${e}`,{})}}let r=new s;e.s(["AuthRepository",()=>s,"authRepository",0,r])},71689,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],71689)},97353,e=>{"use strict";var t=e.i(66027),s=e.i(54616),r=e.i(12598),a=e.i(3318);let i={all:["events"],lists:()=>[...i.all,"list"],list:e=>[...i.lists(),e],details:()=>[...i.all,"detail"],detail:e=>[...i.details(),e],search:e=>[...i.all,"search",e],featured:(e,t,s)=>[...i.all,"featured",{userId:e,lat:t,lng:s}]};function n(e,s){return(0,t.useQuery)({queryKey:i.list(e||{}),queryFn:async()=>await a.eventsRepository.getEvents(e),staleTime:3e5,refetchOnWindowFocus:!0,retry:1,...s})}function o(e,s){return(0,t.useQuery)({queryKey:i.detail(e||""),queryFn:()=>a.eventsRepository.getEventById(e),enabled:!!e,staleTime:6e5,refetchOnWindowFocus:!0,...s})}function l(e,s,r,n){return(0,t.useQuery)({queryKey:i.featured(e,s,r),queryFn:()=>a.eventsRepository.getFeaturedEvents(e,s,r),staleTime:3e5,refetchOnWindowFocus:!0,retry:1,...n})}function c(){let e=(0,r.useQueryClient)();return(0,s.useMutation)({mutationFn:e=>a.eventsRepository.createEvent(e),onSuccess:()=>{e.invalidateQueries({queryKey:i.lists()})}})}function d(){let e=(0,r.useQueryClient)();return(0,s.useMutation)({mutationFn:e=>a.eventsRepository.rsvpToEvent(e.eventId,e.userId,e.quantity),onMutate:async({eventId:t})=>{await e.cancelQueries({queryKey:i.detail(t)});let s=e.getQueryData(i.detail(t));return e.setQueryData(i.detail(t),e=>e?{...e,currentRegistrations:e.currentRegistrations+1}:e),{previousEvent:s}},onError:(t,{eventId:s},r)=>{r?.previousEvent&&e.setQueryData(i.detail(s),r.previousEvent)},onSuccess:(t,s)=>{e.invalidateQueries({queryKey:i.detail(s.eventId)})}})}e.s(["eventKeys",0,i,"useCreateEvent",()=>c,"useEventById",()=>o,"useEvents",()=>n,"useFeaturedEvents",()=>l,"useRsvpToEvent",()=>d])},46897,e=>{"use strict";let t=(0,e.i(75254).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);e.s(["MapPin",()=>t],46897)},37727,e=>{"use strict";let t=(0,e.i(75254).default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["X",()=>t],37727)},74063,e=>{"use strict";var t=e.i(43476),s=e.i(22016),r=e.i(84924),a=e.i(57022);function i({size:e="md",textColor:i="text-[#8B1538]",subtitleColor:n="text-gray-600",linkTo:o="/",className:l}){let c={sm:{logoSize:"sm",titleSize:"text-lg",subtitleSize:"text-[10px]",gap:"ml-2"},md:{logoSize:"md",titleSize:"text-2xl",subtitleSize:"text-xs",gap:"ml-3"},lg:{logoSize:"lg",titleSize:"text-3xl",subtitleSize:"text-sm",gap:"ml-4"}}[e],d=(0,t.jsxs)("div",{className:(0,a.cn)("flex items-center",l),children:[(0,t.jsx)(r.Logo,{size:c.logoSize,showText:!1}),(0,t.jsxs)("div",{className:c.gap,children:[(0,t.jsx)("div",{className:(0,a.cn)(c.titleSize,i),children:"LankaConnect"}),(0,t.jsx)("div",{className:(0,a.cn)(c.subtitleSize,n,"-mt-1"),children:"Sri Lankan Community Hub"})]})]});return o?(0,t.jsx)(s.default,{href:o,className:"hover:opacity-90 transition-opacity",children:d}):d}e.s(["OfficialLogo",()=>i])},3318,e=>{"use strict";var t=e.i(48831);let s=new class{basePath="/events";async getEvents(e={}){let s=new URLSearchParams;void 0!==e.status&&s.append("status",String(e.status)),void 0!==e.category&&s.append("category",String(e.category)),e.startDateFrom&&s.append("startDateFrom",e.startDateFrom),e.startDateTo&&s.append("startDateTo",e.startDateTo),void 0!==e.isFreeOnly&&s.append("isFreeOnly",String(e.isFreeOnly)),e.city&&s.append("city",e.city),e.state&&s.append("state",e.state),e.userId&&s.append("userId",e.userId),void 0!==e.latitude&&s.append("latitude",String(e.latitude)),void 0!==e.longitude&&s.append("longitude",String(e.longitude)),e.metroAreaIds&&e.metroAreaIds.length>0&&e.metroAreaIds.forEach(e=>s.append("metroAreaIds",e));let r=s.toString(),a=r?`${this.basePath}?${r}`:this.basePath;return await t.apiClient.get(a)}async getEventById(e){return await t.apiClient.get(`${this.basePath}/${e}`)}async searchEvents(e){let s=new URLSearchParams({searchTerm:e.searchTerm,page:String(e.page??1),pageSize:String(e.pageSize??20)});return void 0!==e.category&&s.append("category",String(e.category)),void 0!==e.isFreeOnly&&s.append("isFreeOnly",String(e.isFreeOnly)),e.startDateFrom&&s.append("startDateFrom",e.startDateFrom),await t.apiClient.get(`${this.basePath}/search?${s.toString()}`)}async getNearbyEvents(e){let s=new URLSearchParams({latitude:String(e.latitude),longitude:String(e.longitude),radiusKm:String(e.radiusKm)});return void 0!==e.category&&s.append("category",String(e.category)),void 0!==e.isFreeOnly&&s.append("isFreeOnly",String(e.isFreeOnly)),e.startDateFrom&&s.append("startDateFrom",e.startDateFrom),await t.apiClient.get(`${this.basePath}/nearby?${s.toString()}`)}async getFeaturedEvents(e,s,r){let a=new URLSearchParams;e&&a.append("userId",e),void 0!==s&&a.append("latitude",String(s)),void 0!==r&&a.append("longitude",String(r));let i=a.toString(),n=i?`${this.basePath}/featured?${i}`:`${this.basePath}/featured`;return await t.apiClient.get(n)}async createEvent(e){return await t.apiClient.post(this.basePath,e)}async updateEvent(e,s){await t.apiClient.put(`${this.basePath}/${e}`,s)}async deleteEvent(e){await t.apiClient.delete(`${this.basePath}/${e}`)}async submitForApproval(e){await t.apiClient.post(`${this.basePath}/${e}/submit`)}async publishEvent(e){await t.apiClient.post(`${this.basePath}/${e}/publish`)}async cancelEvent(e,s){await t.apiClient.post(`${this.basePath}/${e}/cancel`,{reason:s})}async postponeEvent(e,s){await t.apiClient.post(`${this.basePath}/${e}/postpone`,{reason:s})}async rsvpToEvent(e,s,r=1){await t.apiClient.post(`${this.basePath}/${e}/rsvp`,{userId:s,quantity:r})}async cancelRsvp(e){await t.apiClient.delete(`${this.basePath}/${e}/rsvp`)}async updateRsvp(e,s,r){await t.apiClient.put(`${this.basePath}/${e}/rsvp`,{userId:s,newQuantity:r})}async registerAnonymous(e,s){await t.apiClient.post(`${this.basePath}/${e}/register-anonymous`,s)}async getUserRsvps(){return await t.apiClient.get(`${this.basePath}/my-rsvps`)}async getUpcomingEvents(){return await t.apiClient.get(`${this.basePath}/upcoming`)}async getUserCreatedEvents(){return await t.apiClient.get(`${this.basePath}/my-events`)}async addToWaitingList(e){await t.apiClient.post(`${this.basePath}/${e}/waiting-list`)}async removeFromWaitingList(e){await t.apiClient.delete(`${this.basePath}/${e}/waiting-list`)}async getWaitingList(e){return await t.apiClient.get(`${this.basePath}/${e}/waiting-list`)}async getEventSignUpLists(e){return await t.apiClient.get(`${this.basePath}/${e}/signups`)}async addSignUpList(e,s){await t.apiClient.post(`${this.basePath}/${e}/signups`,s)}async removeSignUpList(e,s){await t.apiClient.delete(`${this.basePath}/${e}/signups/${s}`)}async commitToSignUp(e,s,r){await t.apiClient.post(`${this.basePath}/${e}/signups/${s}/commit`,r)}async cancelCommitment(e,s,r){await t.apiClient.delete(`${this.basePath}/${e}/signups/${s}/commit`,{data:r})}async addSignUpListWithCategories(e,s){await t.apiClient.post(`${this.basePath}/${e}/signups/categories`,s)}async addSignUpItem(e,s,r){return await t.apiClient.post(`${this.basePath}/${e}/signups/${s}/items`,r)}async removeSignUpItem(e,s,r){await t.apiClient.delete(`${this.basePath}/${e}/signups/${s}/items/${r}`)}async commitToSignUpItem(e,s,r,a){await t.apiClient.post(`${this.basePath}/${e}/signups/${s}/items/${r}/commit`,a)}async getEventIcs(e){let t=await fetch(`/api/proxy${this.basePath}/${e}/ics`);if(!t.ok)throw Error("Failed to download ICS file");return await t.blob()}async recordEventShare(e,s){await t.apiClient.post(`${this.basePath}/${e}/share`,{platform:s})}async uploadEventImage(e,t){let s=new FormData;s.append("image",t);let r=await fetch(`/api/proxy${this.basePath}/${e}/images`,{method:"POST",body:s,credentials:"include"});if(!r.ok)throw Error((await r.json().catch(()=>({message:"Upload failed"}))).message||`Upload failed with status ${r.status}`);return await r.json()}async deleteEventImage(e,s){await t.apiClient.delete(`${this.basePath}/${e}/images/${s}`)}async replaceEventImage(e,t,s){let r=new FormData;r.append("image",s);let a=await fetch(`/api/proxy${this.basePath}/${e}/images/${t}`,{method:"PUT",body:r,credentials:"include"});if(!a.ok)throw Error((await a.json().catch(()=>({message:"Replace failed"}))).message||`Replace failed with status ${a.status}`);return await a.json()}async reorderEventImages(e,s){await t.apiClient.put(`${this.basePath}/${e}/images/reorder`,{newOrders:s})}async uploadEventVideo(e,t,s){let r=new FormData;r.append("video",t),r.append("thumbnail",s);let a=await fetch(`/api/proxy${this.basePath}/${e}/videos`,{method:"POST",body:r,credentials:"include"});if(!a.ok)throw Error((await a.json().catch(()=>({message:"Video upload failed"}))).message||`Video upload failed with status ${a.status}`);return await a.json()}async deleteEventVideo(e,s){await t.apiClient.delete(`${this.basePath}/${e}/videos/${s}`)}};e.s(["eventsRepository",0,s])},66027,e=>{"use strict";let t;var s=e.i(75555),r=e.i(40143),a=e.i(86491),i=e.i(15823),n=e.i(93803),o=e.i(19273),l=e.i(80166),c=class extends i.Subscribable{constructor(e,t){super(),this.options=t,this.#e=e,this.#t=null,this.#s=(0,n.pendingThenable)(),this.bindMethods(),this.setOptions(t)}#e;#r=void 0;#a=void 0;#i=void 0;#n;#o;#s;#t;#l;#c;#d;#u;#h;#p;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#r.addObserver(this),d(this.#r,this.options)?this.#y():this.updateResult(),this.#f())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return u(this.#r,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return u(this.#r,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#g(),this.#x(),this.#r.removeObserver(this)}setOptions(e){let t=this.options,s=this.#r;if(this.options=this.#e.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof(0,o.resolveEnabled)(this.options.enabled,this.#r))throw Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#v(),this.#r.setOptions(this.options),t._defaulted&&!(0,o.shallowEqualObjects)(this.options,t)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#r,observer:this});let r=this.hasListeners();r&&h(this.#r,s,this.options,t)&&this.#y(),this.updateResult(),r&&(this.#r!==s||(0,o.resolveEnabled)(this.options.enabled,this.#r)!==(0,o.resolveEnabled)(t.enabled,this.#r)||(0,o.resolveStaleTime)(this.options.staleTime,this.#r)!==(0,o.resolveStaleTime)(t.staleTime,this.#r))&&this.#b();let a=this.#S();r&&(this.#r!==s||(0,o.resolveEnabled)(this.options.enabled,this.#r)!==(0,o.resolveEnabled)(t.enabled,this.#r)||a!==this.#p)&&this.#C(a)}getOptimisticResult(e){var t,s;let r=this.#e.getQueryCache().build(this.#e,e),a=this.createResult(r,e);return t=this,s=a,(0,o.shallowEqualObjects)(t.getCurrentResult(),s)||(this.#i=a,this.#o=this.options,this.#n=this.#r.state),a}getCurrentResult(){return this.#i}trackResult(e,t){return new Proxy(e,{get:(e,s)=>(this.trackProp(s),t?.(s),"promise"===s&&(this.trackProp("data"),this.options.experimental_prefetchInRender||"pending"!==this.#s.status||this.#s.reject(Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,s))})}trackProp(e){this.#m.add(e)}getCurrentQuery(){return this.#r}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){let t=this.#e.defaultQueryOptions(e),s=this.#e.getQueryCache().build(this.#e,t);return s.fetch().then(()=>this.createResult(s,t))}fetch(e){return this.#y({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#y(e){this.#v();let t=this.#r.fetch(this.options,e);return e?.throwOnError||(t=t.catch(o.noop)),t}#b(){this.#g();let e=(0,o.resolveStaleTime)(this.options.staleTime,this.#r);if(o.isServer||this.#i.isStale||!(0,o.isValidTimeout)(e))return;let t=(0,o.timeUntilStale)(this.#i.dataUpdatedAt,e);this.#u=l.timeoutManager.setTimeout(()=>{this.#i.isStale||this.updateResult()},t+1)}#S(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#r):this.options.refetchInterval)??!1}#C(e){this.#x(),this.#p=e,!o.isServer&&!1!==(0,o.resolveEnabled)(this.options.enabled,this.#r)&&(0,o.isValidTimeout)(this.#p)&&0!==this.#p&&(this.#h=l.timeoutManager.setInterval(()=>{(this.options.refetchIntervalInBackground||s.focusManager.isFocused())&&this.#y()},this.#p))}#f(){this.#b(),this.#C(this.#S())}#g(){this.#u&&(l.timeoutManager.clearTimeout(this.#u),this.#u=void 0)}#x(){this.#h&&(l.timeoutManager.clearInterval(this.#h),this.#h=void 0)}createResult(e,t){let s,r=this.#r,i=this.options,l=this.#i,c=this.#n,u=this.#o,m=e!==r?e.state:this.#a,{state:y}=e,f={...y},g=!1;if(t._optimisticResults){let s=this.hasListeners(),n=!s&&d(e,t),o=s&&h(e,r,t,i);(n||o)&&(f={...f,...(0,a.fetchState)(y.data,e.options)}),"isRestoring"===t._optimisticResults&&(f.fetchStatus="idle")}let{error:x,errorUpdatedAt:v,status:b}=f;s=f.data;let S=!1;if(void 0!==t.placeholderData&&void 0===s&&"pending"===b){let e;l?.isPlaceholderData&&t.placeholderData===u?.placeholderData?(e=l.data,S=!0):e="function"==typeof t.placeholderData?t.placeholderData(this.#d?.state.data,this.#d):t.placeholderData,void 0!==e&&(b="success",s=(0,o.replaceData)(l?.data,e,t),g=!0)}if(t.select&&void 0!==s&&!S)if(l&&s===c?.data&&t.select===this.#l)s=this.#c;else try{this.#l=t.select,s=t.select(s),s=(0,o.replaceData)(l?.data,s,t),this.#c=s,this.#t=null}catch(e){this.#t=e}this.#t&&(x=this.#t,s=this.#c,v=Date.now(),b="error");let C="fetching"===f.fetchStatus,j="pending"===b,w="error"===b,P=j&&C,N=void 0!==s,R={status:b,fetchStatus:f.fetchStatus,isPending:j,isSuccess:"success"===b,isError:w,isInitialLoading:P,isLoading:P,data:s,dataUpdatedAt:f.dataUpdatedAt,error:x,errorUpdatedAt:v,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>m.dataUpdateCount||f.errorUpdateCount>m.errorUpdateCount,isFetching:C,isRefetching:C&&!j,isLoadingError:w&&!N,isPaused:"paused"===f.fetchStatus,isPlaceholderData:g,isRefetchError:w&&N,isStale:p(e,t),refetch:this.refetch,promise:this.#s,isEnabled:!1!==(0,o.resolveEnabled)(t.enabled,e)};if(this.options.experimental_prefetchInRender){let t=e=>{"error"===R.status?e.reject(R.error):void 0!==R.data&&e.resolve(R.data)},s=()=>{t(this.#s=R.promise=(0,n.pendingThenable)())},a=this.#s;switch(a.status){case"pending":e.queryHash===r.queryHash&&t(a);break;case"fulfilled":("error"===R.status||R.data!==a.value)&&s();break;case"rejected":("error"!==R.status||R.error!==a.reason)&&s()}}return R}updateResult(){let e=this.#i,t=this.createResult(this.#r,this.options);if(this.#n=this.#r.state,this.#o=this.options,void 0!==this.#n.data&&(this.#d=this.#r),(0,o.shallowEqualObjects)(t,e))return;this.#i=t;let s=()=>{if(!e)return!0;let{notifyOnChangeProps:t}=this.options,s="function"==typeof t?t():t;if("all"===s||!s&&!this.#m.size)return!0;let r=new Set(s??this.#m);return this.options.throwOnError&&r.add("error"),Object.keys(this.#i).some(t=>this.#i[t]!==e[t]&&r.has(t))};this.#j({listeners:s()})}#v(){let e=this.#e.getQueryCache().build(this.#e,this.options);if(e===this.#r)return;let t=this.#r;this.#r=e,this.#a=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#f()}#j(e){r.notifyManager.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(this.#i)}),this.#e.getQueryCache().notify({query:this.#r,type:"observerResultsUpdated"})})}};function d(e,t){return!1!==(0,o.resolveEnabled)(t.enabled,e)&&void 0===e.state.data&&("error"!==e.state.status||!1!==t.retryOnMount)||void 0!==e.state.data&&u(e,t,t.refetchOnMount)}function u(e,t,s){if(!1!==(0,o.resolveEnabled)(t.enabled,e)&&"static"!==(0,o.resolveStaleTime)(t.staleTime,e)){let r="function"==typeof s?s(e):s;return"always"===r||!1!==r&&p(e,t)}return!1}function h(e,t,s,r){return(e!==t||!1===(0,o.resolveEnabled)(r.enabled,e))&&(!s.suspense||"error"!==e.state.status)&&p(e,s)}function p(e,t){return!1!==(0,o.resolveEnabled)(t.enabled,e)&&e.isStaleByTime((0,o.resolveStaleTime)(t.staleTime,e))}e.i(47167);var m=e.i(71645),y=e.i(12598);e.i(43476);var f=m.createContext((t=!1,{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t})),g=m.createContext(!1);g.Provider;var x=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function v(e,t){return function(e,t,s){let a=m.useContext(g),i=m.useContext(f),n=(0,y.useQueryClient)(s),l=n.defaultQueryOptions(e);if(n.getDefaultOptions().queries?._experimental_beforeQuery?.(l),l._optimisticResults=a?"isRestoring":"optimistic",l.suspense){let e=e=>"static"===e?e:Math.max(e??1e3,1e3),t=l.staleTime;l.staleTime="function"==typeof t?(...s)=>e(t(...s)):e(t),"number"==typeof l.gcTime&&(l.gcTime=Math.max(l.gcTime,1e3))}(l.suspense||l.throwOnError||l.experimental_prefetchInRender)&&!i.isReset()&&(l.retryOnMount=!1),m.useEffect(()=>{i.clearReset()},[i]);let c=!n.getQueryCache().get(l.queryHash),[d]=m.useState(()=>new t(n,l)),u=d.getOptimisticResult(l),h=!a&&!1!==e.subscribed;if(m.useSyncExternalStore(m.useCallback(e=>{let t=h?d.subscribe(r.notifyManager.batchCalls(e)):o.noop;return d.updateResult(),t},[d,h]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),m.useEffect(()=>{d.setOptions(l)},[l,d]),l?.suspense&&u.isPending)throw x(l,d,i);if((({result:e,errorResetBoundary:t,throwOnError:s,query:r,suspense:a})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(a&&void 0===e.data||(0,o.shouldThrowError)(s,[e.error,r])))({result:u,errorResetBoundary:i,throwOnError:l.throwOnError,query:n.getQueryCache().get(l.queryHash),suspense:l.suspense}))throw u.error;if(n.getDefaultOptions().queries?._experimental_afterQuery?.(l,u),l.experimental_prefetchInRender&&!o.isServer&&u.isLoading&&u.isFetching&&!a){let e=c?x(l,d,i):n.getQueryCache().get(l.queryHash)?.promise;e?.catch(o.noop).finally(()=>{d.updateResult()})}return l.notifyOnChangeProps?u:d.trackResult(u)}(e,c,t)}e.s(["useQuery",()=>v],66027)},54616,e=>{"use strict";var t=e.i(71645),s=e.i(14272),r=e.i(40143),a=e.i(15823),i=e.i(19273),n=class extends a.Subscribable{#e;#i=void 0;#w;#P;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#N()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,i.shallowEqualObjects)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#w,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,i.hashKey)(t.mutationKey)!==(0,i.hashKey)(this.options.mutationKey)?this.reset():this.#w?.state.status==="pending"&&this.#w.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#w?.removeObserver(this)}onMutationUpdate(e){this.#N(),this.#j(e)}getCurrentResult(){return this.#i}reset(){this.#w?.removeObserver(this),this.#w=void 0,this.#N(),this.#j()}mutate(e,t){return this.#P=t,this.#w?.removeObserver(this),this.#w=this.#e.getMutationCache().build(this.#e,this.options),this.#w.addObserver(this),this.#w.execute(e)}#N(){let e=this.#w?.state??(0,s.getDefaultState)();this.#i={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#j(e){r.notifyManager.batch(()=>{if(this.#P&&this.hasListeners()){let t=this.#i.variables,s=this.#i.context,r={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#P.onSuccess?.(e.data,t,s,r),this.#P.onSettled?.(e.data,null,t,s,r)):e?.type==="error"&&(this.#P.onError?.(e.error,t,s,r),this.#P.onSettled?.(void 0,e.error,t,s,r))}this.listeners.forEach(e=>{e(this.#i)})})}},o=e.i(12598);function l(e,s){let a=(0,o.useQueryClient)(s),[l]=t.useState(()=>new n(a,e));t.useEffect(()=>{l.setOptions(e)},[l,e]);let c=t.useSyncExternalStore(t.useCallback(e=>l.subscribe(r.notifyManager.batchCalls(e)),[l]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),d=t.useCallback((e,t)=>{l.mutate(e,t).catch(i.noop)},[l]);if(c.error&&(0,i.shouldThrowError)(l.options.throwOnError,[c.error]))throw c.error;return{...c,mutate:d,mutateAsync:c.mutate}}e.s(["useMutation",()=>l],54616)},14863,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(18566),a=e.i(88129);function i({children:e}){let i=(0,r.useRouter)(),{isAuthenticated:n,isLoading:o}=(0,a.useAuthStore)(),[l,c]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{c(!0)},[]),(0,s.useEffect)(()=>{!l||o||n||i.push("/login")},[n,o,l,i]),!l||o)?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",style:{background:"#f7fafc"},children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 mx-auto mb-4",style:{borderColor:"#FF7900"}}),(0,t.jsx)("p",{style:{color:"#8B1538",fontSize:"0.9rem"},children:"Loading..."})]})}):n?(0,t.jsx)(t.Fragment,{children:e}):null}e.s(["ProtectedRoute",()=>i])},69074,31278,e=>{"use strict";var t=e.i(75254);let s=(0,t.default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);e.s(["Upload",()=>s],69074);let r=(0,t.default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>r],31278)},34866,e=>{"use strict";var t=e.i(68834),s=e.i(79473);e.i(47167);var r=e.i(48831);let a=new class{basePath="/users";async getProfile(e){return await r.apiClient.get(`${this.basePath}/${e}`)}async uploadProfilePhoto(e,t){let s=new FormData;s.append("image",t);let a=`/api/proxy${this.basePath}/${e}/profile-photo`,i=r.apiClient.authToken,n=await fetch(a,{method:"POST",body:s,credentials:"include",headers:{...i?{Authorization:`Bearer ${i}`}:{}}});if(!n.ok){let e=await n.text(),t=`Upload failed with status ${n.status}`;try{let s=JSON.parse(e);t=s.message||s.error||t}catch{}throw Error(t)}return await n.json()}async deleteProfilePhoto(e){return await r.apiClient.delete(`${this.basePath}/${e}/profile-photo`)}async updateLocation(e,t){return await r.apiClient.put(`${this.basePath}/${e}/location`,t)}async updateCulturalInterests(e,t){return await r.apiClient.put(`${this.basePath}/${e}/cultural-interests`,t),await this.getProfile(e)}async updateLanguages(e,t){return await r.apiClient.put(`${this.basePath}/${e}/languages`,t)}async updateBasicInfo(e,t){return await r.apiClient.put(`${this.basePath}/${e}`,t)}async updatePreferredMetroAreas(e,t){return await r.apiClient.put(`${this.basePath}/${e}/preferred-metro-areas`,t),await this.getProfile(e)}async getPreferredMetroAreas(e){return await r.apiClient.get(`${this.basePath}/${e}/preferred-metro-areas`)}},i={photo:"idle",basicInfo:"idle",location:"idle",culturalInterests:"idle",languages:"idle",preferredMetroAreas:"idle"},n=(0,t.create)()((0,s.devtools)((e,t)=>({profile:null,originalProfile:null,isLoading:!1,error:null,sectionStates:{...i},setProfile:t=>{e({profile:t,originalProfile:JSON.parse(JSON.stringify(t)),error:null})},loadProfile:async s=>{e({isLoading:!0,error:null});try{let e=await a.getProfile(s);t().setProfile(e)}catch(t){e({error:t instanceof Error?t.message:"Failed to load profile",profile:null,originalProfile:null})}finally{e({isLoading:!1})}},clearProfile:()=>{e({profile:null,originalProfile:null,isLoading:!1,error:null,sectionStates:{...i}})},uploadPhoto:async(t,s)=>{e(e=>({sectionStates:{...e.sectionStates,photo:"saving"},error:null}));try{let r=await a.uploadProfilePhoto(t,s);e(e=>({profile:e.profile?{...e.profile,profilePhotoUrl:r.profilePhotoUrl}:null,originalProfile:e.originalProfile?{...e.originalProfile,profilePhotoUrl:r.profilePhotoUrl}:null,sectionStates:{...e.sectionStates,photo:"success"}})),setTimeout(()=>{e(e=>({sectionStates:{...e.sectionStates,photo:"idle"}}))},2e3)}catch(s){let t=s instanceof Error?s.message:"Failed to upload photo";e(e=>({error:t,sectionStates:{...e.sectionStates,photo:"error"}}))}},deletePhoto:async t=>{e(e=>({sectionStates:{...e.sectionStates,photo:"saving"},error:null}));try{await a.deleteProfilePhoto(t),e(e=>({profile:e.profile?{...e.profile,profilePhotoUrl:null}:null,originalProfile:e.originalProfile?{...e.originalProfile,profilePhotoUrl:null}:null,sectionStates:{...e.sectionStates,photo:"success"}})),setTimeout(()=>{e(e=>({sectionStates:{...e.sectionStates,photo:"idle"}}))},2e3)}catch(s){let t=s instanceof Error?s.message:"Failed to delete photo";e(e=>({error:t,sectionStates:{...e.sectionStates,photo:"error"}}))}},updateBasicInfo:async(s,r)=>{e(e=>({sectionStates:{...e.sectionStates,basicInfo:"saving"},error:null}));try{let i=await a.updateBasicInfo(s,r);t().setProfile(i),e(e=>({sectionStates:{...e.sectionStates,basicInfo:"success"}})),setTimeout(()=>{e(e=>({sectionStates:{...e.sectionStates,basicInfo:"idle"}}))},2e3)}catch(s){let t=s instanceof Error?s.message:"Failed to update basic info";e(e=>({error:t,sectionStates:{...e.sectionStates,basicInfo:"error"}}))}},updateLocation:async(s,r)=>{e(e=>({sectionStates:{...e.sectionStates,location:"saving"},error:null}));try{let i=await a.updateLocation(s,r);t().setProfile(i),e(e=>({sectionStates:{...e.sectionStates,location:"success"}})),setTimeout(()=>{e(e=>({sectionStates:{...e.sectionStates,location:"idle"}}))},2e3)}catch(s){let t=s instanceof Error?s.message:"Failed to update location";e(e=>({error:t,sectionStates:{...e.sectionStates,location:"error"}}))}},updateCulturalInterests:async(s,r)=>{e(e=>({sectionStates:{...e.sectionStates,culturalInterests:"saving"},error:null}));try{let i=await a.updateCulturalInterests(s,r);t().setProfile(i),e(e=>({sectionStates:{...e.sectionStates,culturalInterests:"success"}})),setTimeout(()=>{e(e=>({sectionStates:{...e.sectionStates,culturalInterests:"idle"}}))},2e3)}catch(s){let t=s instanceof Error?s.message:"Failed to update cultural interests";e(e=>({error:t,sectionStates:{...e.sectionStates,culturalInterests:"error"}}))}},updateLanguages:async(s,r)=>{e(e=>({sectionStates:{...e.sectionStates,languages:"saving"},error:null}));try{let i=await a.updateLanguages(s,r);t().setProfile(i),e(e=>({sectionStates:{...e.sectionStates,languages:"success"}})),setTimeout(()=>{e(e=>({sectionStates:{...e.sectionStates,languages:"idle"}}))},2e3)}catch(s){let t=s instanceof Error?s.message:"Failed to update languages";e(e=>({error:t,sectionStates:{...e.sectionStates,languages:"error"}}))}},updatePreferredMetroAreas:async(s,r)=>{if(r.MetroAreaIds.length>20)return void e(e=>({error:"Cannot select more than 20 metro areas",sectionStates:{...e.sectionStates,preferredMetroAreas:"error"}}));e(e=>({sectionStates:{...e.sectionStates,preferredMetroAreas:"saving"},error:null}));try{let i=await a.updatePreferredMetroAreas(s,r);t().setProfile(i),e(e=>({sectionStates:{...e.sectionStates,preferredMetroAreas:"success"}})),setTimeout(()=>{e(e=>({sectionStates:{...e.sectionStates,preferredMetroAreas:"idle"}}))},2e3)}catch(s){let t=s instanceof Error?s.message:"Failed to update preferred metro areas";e(e=>({error:t,sectionStates:{...e.sectionStates,preferredMetroAreas:"error"}}))}},markSectionDirty:t=>{e(e=>({sectionStates:{...e.sectionStates,[t]:"dirty"}}))},markSectionClean:t=>{e(e=>({sectionStates:{...e.sectionStates,[t]:"idle"}}))},resetSectionState:t=>{e(e=>({sectionStates:{...e.sectionStates,[t]:"idle"}}))},isSectionDirty:e=>"dirty"===t().sectionStates[e]}),{name:"ProfileStore"}));e.s(["useProfileStore",0,n],34866)},60572,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(14863),a=e.i(88129),i=e.i(34866),n=e.i(57688),o=e.i(69074),l=e.i(37727),c=e.i(31278),d=e.i(44212),u=e.i(57022);let h=["image/jpeg","image/jpg","image/png","image/webp"],p=5,m=({currentPhotoUrl:e,onUpload:r,onDelete:a,maxSizeMB:i=p,acceptedFormats:m=h,isLoading:y=!1,error:f})=>{let g=(0,s.useRef)(null),[x,v]=(0,s.useState)(!1),[b,S]=(0,s.useState)(""),C=()=>m.map(e=>e.replace("image/","").toUpperCase()).join(", "),j=(0,s.useCallback)(async e=>{e&&(((S(""),m.includes(e.type))?e.size/1048576>i&&(S(`File size exceeds ${i}MB`),1):(S(`Only ${C()} images are allowed`),1))||await r(e))},[r,i,m]),w=()=>{g.current?.click()},P=async()=>{y||await a()},N=f||b;return(0,t.jsxs)("div",{className:"space-y-4",children:[e&&(0,t.jsxs)("div",{className:"relative flex flex-col items-center space-y-4",children:[(0,t.jsx)("div",{className:"relative h-32 w-32 overflow-hidden rounded-full border-4 border-border",children:(0,t.jsx)(n.default,{src:e,alt:"Current profile photo",fill:!0,className:"object-cover",sizes:"128px"})}),(0,t.jsxs)(d.Button,{type:"button",variant:"destructive",size:"sm",onClick:P,disabled:y,"aria-label":"Delete photo",children:[(0,t.jsx)(l.X,{className:"mr-2 h-4 w-4"}),"Delete Photo"]})]}),!e&&(0,t.jsxs)("div",{className:(0,u.cn)("relative flex flex-col items-center justify-center rounded-lg border-2 border-dashed p-8 transition-colors",x&&"border-primary bg-primary/5",!x&&"border-border hover:border-primary/50",y&&"pointer-events-none opacity-50"),onDragOver:e=>{e.preventDefault(),e.stopPropagation(),v(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),v(!1)},onDrop:e=>{e.preventDefault(),e.stopPropagation(),v(!1);let t=e.dataTransfer.files?.[0];t&&j(t)},onClick:w,role:"button",tabIndex:0,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&w()},children:[(0,t.jsx)("input",{ref:g,type:"file",accept:m.join(","),onChange:e=>{let t=e.target.files?.[0];t&&j(t),g.current&&(g.current.value="")},className:"hidden",disabled:y,"aria-label":"Upload profile photo"}),y?(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-2",role:"status","aria-live":"polite",children:[(0,t.jsx)(c.Loader2,{className:"h-12 w-12 animate-spin text-primary"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Uploading..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.Upload,{className:"mb-4 h-12 w-12 text-muted-foreground"}),(0,t.jsx)("p",{className:"mb-2 text-sm font-medium text-foreground",children:"Upload Photo"}),(0,t.jsx)("p",{className:"mb-1 text-xs text-muted-foreground",children:"Drag and drop or click to select"}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[C()," (Max ",i,"MB)"]})]})]}),N&&(0,t.jsx)("div",{className:"rounded-md bg-destructive/10 p-3",children:(0,t.jsx)("p",{className:"text-sm text-destructive",children:N})})]})};var y=e.i(21065);function f(){let{user:e,isAuthenticated:s}=(0,a.useAuthStore)(),{profile:r,error:n,sectionStates:o,uploadPhoto:l,deletePhoto:c}=(0,i.useProfileStore)();if(!s||!e)return null;let d=r?.profilePhotoUrl||null,u="saving"===o.photo,h="error"===o.photo?n:null,p=async t=>{await l(e.userId,t)},f=async()=>{await c(e.userId)};return(0,t.jsx)("section",{role:"region","aria-labelledby":"profile-photo-heading",children:(0,t.jsxs)(y.Card,{children:[(0,t.jsxs)(y.CardHeader,{children:[(0,t.jsx)(y.CardTitle,{id:"profile-photo-heading",style:{color:"#8B1538"},children:"Profile Photo"}),(0,t.jsx)(y.CardDescription,{children:"Upload a photo to personalize your profile and help others recognize you"})]}),(0,t.jsx)(y.CardContent,{children:(0,t.jsx)(m,{currentPhotoUrl:d,onUpload:p,onDelete:f,isLoading:u,error:h||void 0,maxSizeMB:5,acceptedFormats:["image/jpeg","image/jpg","image/png","image/webp"]})})]})})}var g=e.i(75244);let x=[{code:"SL_CUISINE",name:"Sri Lankan Cuisine"},{code:"BUDDHIST_FEST",name:"Buddhist Festivals & Traditions"},{code:"HINDU_FEST",name:"Hindu Festivals & Traditions"},{code:"ISLAMIC_FEST",name:"Islamic Festivals & Traditions"},{code:"CHRISTIAN_FEST",name:"Christian Festivals & Traditions"},{code:"TRAD_DANCE",name:"Traditional Dance (Kandyan, Sabaragamuwa, Low Country)"},{code:"CRICKET",name:"Cricket & Sports"},{code:"AYURVEDA",name:"Ayurvedic Medicine & Wellness"},{code:"SINHALA_MUSIC",name:"Sinhala Music & Arts"},{code:"TAMIL_MUSIC",name:"Tamil Music & Arts"},{code:"VESAK",name:"Vesak & Poson Celebrations"},{code:"SINHALA_NY",name:"Sinhala & Tamil New Year (Aluth Avurudda)"},{code:"TEA_CULTURE",name:"Ceylon Tea Culture"},{code:"TRAD_ARTS",name:"Traditional Arts & Crafts (Masks, Batik, Pottery)"},{code:"SL_WEDDINGS",name:"Sri Lankan Wedding Traditions"},{code:"TEMPLE_ARCH",name:"Temple Architecture & Heritage Sites"},{code:"SL_LITERATURE",name:"Sinhala/Tamil Literature & Poetry"},{code:"TRAD_GAMES",name:"Traditional Games (Elle, Ankeliya)"},{code:"SL_FASHION",name:"Traditional Dress & Fashion (Saree, Sarong)"},{code:"DIASPORA_NET",name:"Diaspora Community & Networking"}],v=100,b=100,S=20,C=100,j=10,w={min:0,max:20};var P=e.i(43531),N=e.i(46897);function R(){let{user:e,isAuthenticated:r}=(0,a.useAuthStore)(),{profile:n,error:o,sectionStates:l,updateLocation:c}=(0,i.useProfileStore)(),[u,h]=(0,s.useState)(!1),[p,m]=(0,s.useState)({city:"",state:"",zipCode:"",country:""}),[f,x]=(0,s.useState)({});if(!r||!e)return null;let j=n?.location,w="saving"===l.location,R="success"===l.location,E="error"===l.location,I=async()=>{let t;if(t={},p.city.trim()?p.city.length>v&&(t.city=`City cannot exceed ${v} characters`):t.city="City is required",p.state.trim()?p.state.length>b&&(t.state=`State cannot exceed ${b} characters`):t.state="State is required",p.zipCode.trim()?p.zipCode.length>S&&(t.zipCode=`Zip code cannot exceed ${S} characters`):t.zipCode="Zip code is required",p.country.trim()?p.country.length>C&&(t.country=`Country cannot exceed ${C} characters`):t.country="Country is required",x(t),0===Object.keys(t).length)try{await c(e.userId,{city:p.city.trim(),state:p.state.trim(),zipCode:p.zipCode.trim(),country:p.country.trim()}),h(!1)}catch(e){}},$=(e,t)=>{m(s=>({...s,[e]:t})),f[e]&&x(t=>{let s={...t};return delete s[e],s})};return(0,t.jsx)("section",{role:"region","aria-labelledby":"location-heading",children:(0,t.jsxs)(y.Card,{children:[(0,t.jsxs)(y.CardHeader,{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(N.MapPin,{className:"h-5 w-5",style:{color:"#FF7900"}}),(0,t.jsx)(y.CardTitle,{id:"location-heading",style:{color:"#8B1538"},children:"Location"})]}),!u&&(0,t.jsx)(d.Button,{onClick:()=>{m({city:j?.city||"",state:j?.state||"",zipCode:j?.zipCode||"",country:j?.country||""}),x({}),h(!0)},variant:"outline",size:"sm",disabled:w,style:{borderColor:"#FF7900",color:"#8B1538"},children:"Edit"})]}),(0,t.jsx)(y.CardDescription,{children:"Help others in the community find you by sharing your location"})]}),(0,t.jsx)(y.CardContent,{children:u?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"city",className:"block text-sm font-medium mb-1",children:"City *"}),(0,t.jsx)(g.Input,{id:"city",type:"text",value:p.city,onChange:e=>$("city",e.target.value),placeholder:"e.g., Toronto",disabled:w,error:!!f.city,"aria-label":"City","aria-invalid":!!f.city,"aria-describedby":f.city?"city-error":void 0,maxLength:v}),f.city&&(0,t.jsx)("p",{id:"city-error",className:"text-sm text-destructive mt-1",role:"alert",children:f.city})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"state",className:"block text-sm font-medium mb-1",children:"State/Province *"}),(0,t.jsx)(g.Input,{id:"state",type:"text",value:p.state,onChange:e=>$("state",e.target.value),placeholder:"e.g., Ontario",disabled:w,error:!!f.state,"aria-label":"State/Province","aria-invalid":!!f.state,"aria-describedby":f.state?"state-error":void 0,maxLength:b}),f.state&&(0,t.jsx)("p",{id:"state-error",className:"text-sm text-destructive mt-1",role:"alert",children:f.state})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"zipCode",className:"block text-sm font-medium mb-1",children:"Zip/Postal Code *"}),(0,t.jsx)(g.Input,{id:"zipCode",type:"text",value:p.zipCode,onChange:e=>$("zipCode",e.target.value),placeholder:"e.g., M5H 2N2",disabled:w,error:!!f.zipCode,"aria-label":"Zip/Postal Code","aria-invalid":!!f.zipCode,"aria-describedby":f.zipCode?"zipCode-error":void 0,maxLength:S}),f.zipCode&&(0,t.jsx)("p",{id:"zipCode-error",className:"text-sm text-destructive mt-1",role:"alert",children:f.zipCode})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"country",className:"block text-sm font-medium mb-1",children:"Country *"}),(0,t.jsx)(g.Input,{id:"country",type:"text",value:p.country,onChange:e=>$("country",e.target.value),placeholder:"e.g., Canada",disabled:w,error:!!f.country,"aria-label":"Country","aria-invalid":!!f.country,"aria-describedby":f.country?"country-error":void 0,maxLength:C}),f.country&&(0,t.jsx)("p",{id:"country-error",className:"text-sm text-destructive mt-1",role:"alert",children:f.country})]}),E&&o&&(0,t.jsx)("p",{className:"text-sm text-destructive",role:"alert",children:o}),(0,t.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,t.jsx)(d.Button,{onClick:I,disabled:w,className:"flex-1 text-white",style:{background:"#FF7900"},children:w?"Saving...":"Save Location"}),(0,t.jsx)(d.Button,{onClick:()=>{h(!1),x({})},variant:"outline",disabled:w,className:"flex-1",style:{borderColor:"#8B1538",color:"#8B1538"},children:"Cancel"})]})]}):(0,t.jsxs)("div",{className:"space-y-2",children:[j?(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsxs)("p",{className:"font-medium text-foreground",children:[j.city,", ",j.state," ",j.zipCode]}),(0,t.jsx)("p",{className:"text-muted-foreground",children:j.country})]}):(0,t.jsx)("p",{className:"text-sm text-muted-foreground italic",children:"Not set - Click Edit to add your location"}),R&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",style:{color:"#006400"},children:[(0,t.jsx)(P.Check,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Location saved successfully!"})]}),E&&o&&(0,t.jsx)("p",{className:"text-sm text-destructive",role:"alert",children:o})]})})]})})}let E=(0,e.i(75254).default)("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]);function I(){let{user:e,isAuthenticated:r}=(0,a.useAuthStore)(),{profile:n,error:o,sectionStates:l,updateCulturalInterests:c}=(0,i.useProfileStore)(),[u,h]=(0,s.useState)(!1),[p,m]=(0,s.useState)([]),[f,g]=(0,s.useState)("");if(!r||!e)return null;let v=n?.culturalInterests||[],b="saving"===l.culturalInterests,S="success"===l.culturalInterests,C="error"===l.culturalInterests,w=async()=>{if(p.length>j)return void g(`Maximum ${j} interests allowed`);try{await c(e.userId,{InterestCodes:p}),h(!1)}catch(e){}};return(0,t.jsx)("section",{role:"region","aria-labelledby":"cultural-interests-heading",children:(0,t.jsxs)(y.Card,{children:[(0,t.jsxs)(y.CardHeader,{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(E,{className:"h-5 w-5",style:{color:"#FF7900"}}),(0,t.jsx)(y.CardTitle,{id:"cultural-interests-heading",style:{color:"#8B1538"},children:"Cultural Interests"})]}),!u&&(0,t.jsx)(d.Button,{onClick:()=>{m([...v]),g(""),h(!0)},variant:"outline",size:"sm",disabled:b,style:{borderColor:"#FF7900",color:"#8B1538"},children:"Edit"})]}),(0,t.jsxs)(y.CardDescription,{children:["Share your cultural interests to connect with others (select 0-",j,")"]})]}),(0,t.jsx)(y.CardContent,{children:u?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:x.map(e=>{let s=p.includes(e.code);return(0,t.jsxs)("label",{className:`flex items-start gap-3 p-3 rounded-lg border cursor-pointer transition-colors ${b?"opacity-50 cursor-not-allowed":""}`,style:{background:s?"#FFE8CC":"white",borderColor:s?"#FF7900":"#e2e8f0"},children:[(0,t.jsx)("input",{type:"checkbox",checked:s,onChange:()=>{var t;return t=e.code,void m(e=>e.includes(t)?e.filter(e=>e!==t):e.length>=j?(g(`You can select up to ${j} interests`),e):(g(""),[...e,t]))},disabled:b,className:"mt-1 h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary","aria-label":e.name}),(0,t.jsx)("span",{className:"text-sm flex-1",children:e.name})]},e.code)})}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[p.length," of ",j," selected"]}),f&&(0,t.jsx)("p",{className:"text-sm text-destructive",role:"alert",children:f}),C&&o&&(0,t.jsx)("p",{className:"text-sm text-destructive",role:"alert",children:o}),(0,t.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,t.jsx)(d.Button,{onClick:w,disabled:b,className:"flex-1 text-white",style:{background:"#FF7900"},children:b?"Saving...":"Save Interests"}),(0,t.jsx)(d.Button,{onClick:()=>{h(!1),g("")},variant:"outline",disabled:b,className:"flex-1",style:{borderColor:"#8B1538",color:"#8B1538"},children:"Cancel"})]})]}):(0,t.jsxs)("div",{className:"space-y-2",children:[v.length>0?(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:v.map(e=>{let s=x.find(t=>t.code===e);return s?(0,t.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium",style:{background:"#FFE8CC",color:"#8B1538"},children:s.name},e):null})}):(0,t.jsx)("p",{className:"text-sm text-muted-foreground italic",children:"No interests selected - Click Edit to add your cultural interests"}),S&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",style:{color:"#006400"},children:[(0,t.jsx)(P.Check,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Cultural interests saved successfully!"})]}),C&&o&&(0,t.jsx)("p",{className:"text-sm text-destructive",role:"alert",children:o})]})})]})})}var $=e.i(71547),F=e.i(74736),T=e.i(24877),k=e.i(12598),M=e.i(97353);function O(){let{user:e}=(0,a.useAuthStore)(),{profile:r,updatePreferredMetroAreas:n,sectionStates:o,error:l,isLoading:c}=(0,i.useProfileStore)(),u=(0,k.useQueryClient)(),{metroAreas:h,metroAreasByState:p,stateLevelMetros:m,isLoading:f,error:g}=(0,F.useMetroAreas)(),[x,v]=(0,s.useState)(!1),[b,S]=(0,s.useState)([]),[C,j]=(0,s.useState)(""),R=o.preferredMetroAreas,E=c||"saving"===R,I=r?.preferredMetroAreas||[],{max:O}=w,A=(0,s.useMemo)(()=>{let e=[];return T.US_STATES.forEach(t=>{let s=p.get(t.code)||[];if(0===s.length)return;let r=s.find(e=>e.isStateLevelArea),a=s.filter(e=>!e.isStateLevelArea),i=[];r&&i.push({id:r.id,label:r.name,checked:b.includes(r.id)}),a.forEach(e=>{i.push({id:e.id,label:e.name,checked:b.includes(e.id)})}),e.push({id:t.code,label:t.name,checked:!1,children:i})}),e},[p,m,b]);if(!e)return null;if(f)return(0,t.jsxs)(y.Card,{role:"region","aria-label":"Preferred Metro Areas",children:[(0,t.jsxs)(y.CardHeader,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(N.MapPin,{className:"h-5 w-5",style:{color:"#FF7900"}}),(0,t.jsx)(y.CardTitle,{style:{color:"#8B1538"},children:"Preferred Metro Areas"})]}),(0,t.jsx)(y.CardDescription,{children:"Loading metro areas..."})]}),(0,t.jsx)(y.CardContent,{children:(0,t.jsx)("div",{className:"flex items-center justify-center p-4",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2",style:{borderColor:"#FF7900"}})})})]});if(g)return(0,t.jsxs)(y.Card,{role:"region","aria-label":"Preferred Metro Areas",children:[(0,t.jsx)(y.CardHeader,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(N.MapPin,{className:"h-5 w-5",style:{color:"#FF7900"}}),(0,t.jsx)(y.CardTitle,{style:{color:"#8B1538"},children:"Preferred Metro Areas"})]})}),(0,t.jsx)(y.CardContent,{children:(0,t.jsxs)("p",{className:"text-sm text-destructive",role:"alert",children:["Failed to load metro areas: ",g]})})]});let D=async()=>{if(e?.userId){console.log("=== DEBUG: Attempting to save metro areas ==="),console.log("Selected IDs:",b),console.log("Selected Count:",b.length),b.forEach(e=>{let t=L(e);console.log(`  - ${e}: ${t?`${t.name}, ${t.state}`:"NOT FOUND IN LOCAL DATA"}`)});try{await n(e.userId,{MetroAreaIds:b}),console.log("✅ Save successful"),u.invalidateQueries({queryKey:M.eventKeys.featured(e.userId)}),console.log("✅ Featured events cache invalidated"),v(!1),j("")}catch(e){console.error("❌ Save failed:",e)}}},L=e=>h.find(t=>t.id===e);return(0,t.jsxs)(y.Card,{role:"region","aria-label":"Preferred Metro Areas",children:[(0,t.jsxs)(y.CardHeader,{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(N.MapPin,{className:"h-5 w-5",style:{color:"#FF7900"}}),(0,t.jsx)(y.CardTitle,{style:{color:"#8B1538"},children:"Preferred Metro Areas"})]}),!x&&(0,t.jsx)(d.Button,{variant:"outline",size:"sm",onClick:()=>{v(!0),S([...I]),j("")},disabled:E,style:{borderColor:"#FF7900",color:"#8B1538"},children:"Edit"})]}),(0,t.jsxs)(y.CardDescription,{children:["Select up to ",O," metro areas for personalized event and content filtering. You can opt out by leaving this empty."]})]}),(0,t.jsx)(y.CardContent,{children:x?(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Select metro areas by expanding states and checking your preferred locations"}),(0,t.jsx)($.TreeDropdown,{nodes:A,selectedIds:b,onSelectionChange:e=>{e.length>O?j(`You cannot select more than ${O} metro areas`):(j(""),S(e))},placeholder:`Select up to ${O} metro areas`,maxSelections:O,disabled:E,className:"w-full"}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t",style:{borderColor:"#e2e8f0"},children:[(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[b.length," of ",O," selected"]}),C&&(0,t.jsx)("p",{className:"text-sm text-destructive",role:"alert",children:C})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,t.jsx)(d.Button,{onClick:D,disabled:E||!!C,className:"flex-1 text-white",style:{background:"#FF7900"},children:E?"Saving...":"Save Changes"}),(0,t.jsx)(d.Button,{onClick:()=>{v(!1),S([]),j("")},variant:"outline",disabled:E,className:"flex-1",style:{borderColor:"#8B1538",color:"#8B1538"},children:"Cancel"})]})]}):(0,t.jsxs)("div",{className:"space-y-2",children:[I.length>0?(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:I.map(e=>{let s,r=L(e);return r?(0,t.jsxs)("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium",style:{background:"#FFE8CC",color:"#8B1538"},children:[r.name,(s=L(e),!s?.isStateLevelArea&&`, ${r.state}`)]},e):null})}):(0,t.jsx)("p",{className:"text-sm text-muted-foreground italic",children:"No metro areas selected - Click Edit to add your preferred locations"}),"success"===R&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",style:{color:"#006400"},children:[(0,t.jsx)(P.Check,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Preferred metro areas saved successfully!"})]}),"error"===R&&l&&(0,t.jsx)("p",{className:"text-sm text-destructive",role:"alert",children:l})]})})]})}var A=e.i(74063),D=e.i(18566),L=e.i(42490),Q=e.i(71689),U=e.i(79574);function z(){let e=(0,D.useRouter)(),{user:n,clearAuth:o,isAuthenticated:l,isLoading:c}=(0,a.useAuthStore)(),{loadProfile:u,profile:h,isLoading:p}=(0,i.useProfileStore)();(0,s.useEffect)(()=>{l&&n?.userId&&!h&&!p&&u(n.userId)},[l,n?.userId,h,p,u]);let m=async()=>{try{await L.authRepository.logout()}catch(e){}finally{o(),e.push("/login")}};return(0,t.jsx)(r.ProtectedRoute,{children:(0,t.jsxs)("div",{className:"min-h-screen",style:{background:"#f7fafc"},children:[(0,t.jsx)("header",{className:"bg-white border-b sticky top-0 z-40",style:{background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",boxShadow:"0 2px 20px rgba(0,0,0,0.1)"},children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(A.OfficialLogo,{size:"md"}),(0,t.jsx)("div",{className:"h-6 w-px bg-gray-300"}),(0,t.jsx)("h1",{className:"text-2xl font-bold",style:{color:"#8B1538"},children:"My Profile"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)(d.Button,{onClick:()=>{e.push("/dashboard")},variant:"outline",size:"sm",style:{borderColor:"#FF7900",color:"#8B1538"},children:[(0,t.jsx)(Q.ArrowLeft,{className:"w-4 h-4 mr-2"}),"Dashboard"]}),(0,t.jsx)(d.Button,{onClick:m,variant:"outline",size:"sm",style:{borderColor:"#8B1538",color:"#8B1538"},children:"Logout"})]})]})})}),(0,t.jsx)("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"rounded-xl overflow-hidden",style:{background:"white",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.05)"},children:(0,t.jsx)("div",{className:"p-6",style:{background:"linear-gradient(135deg, #FF7900 0%, #8B1538 50%, #006400 100%)",color:"white"},children:(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"w-16 h-16 rounded-full flex items-center justify-center text-white font-bold text-xl",style:{background:"rgba(255, 255, 255, 0.2)"},children:(n?.fullName||"U").split(" ").map(e=>e[0]).join("").toUpperCase()}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-2xl font-semibold mb-1",children:["Welcome, ",n?.fullName,"!"]}),(0,t.jsx)("p",{className:"text-white/90",children:"Manage your profile information to help others in the Sri Lankan community connect with you."})]})]})})}),(0,t.jsx)(f,{}),(0,t.jsx)(R,{}),(0,t.jsx)(I,{}),(0,t.jsx)(O,{}),p&&(0,t.jsx)("div",{className:"bg-white rounded-xl shadow p-6 text-center",children:(0,t.jsxs)("div",{className:"flex items-center justify-center gap-3",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2",style:{borderColor:"#FF7900"}}),(0,t.jsx)("p",{style:{color:"#8B1538"},children:"Loading profile..."})]})})]})}),(0,t.jsx)(U.default,{})]})})}e.s(["default",()=>z],60572)}]);