module.exports=[53033,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(210),f=a.i(41675),g=a.i(24987),h=a.i(60246),i=a.i(90166),j=a.i(41710),k=a.i(92e3),l=a.i(50388),m=a.i(93003),n=a.i(50253),o=a.i(42043),p=a.i(63535),q=a.i(74934),r=a.i(55100),s=a.i(13858),t=a.i(72988),u=a.i(23482);function v({eventId:a,spotsLeft:d,isFree:e,ticketPrice:f,hasDualPricing:g,adultPrice:h,childPrice:i,childAgeLimit:k,hasGroupPricing:l,groupPricingTiers:m,isProcessing:n,onSubmit:p,error:q}){let{user:r}=(0,t.useAuthStore)(),{profile:v,loadProfile:w}=(0,u.useProfileStore)(),[x,y]=(0,c.useState)(1),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)([{name:"",age:""}]),[H,I]=(0,c.useState)({address:!1,email:!1,phoneNumber:!1,attendees:[]});(0,c.useEffect)(()=>{r?.userId&&!v&&w(r.userId)},[r?.userId,v,w]),(0,c.useEffect)(()=>{r&&v&&(C(v.email),E(v.phoneNumber||""),v.location&&A([v.location.city,v.location.state,v.location.zipCode].filter(Boolean).join(", ")),G([{name:`${v.firstName} ${v.lastName}`.trim(),age:""}]))},[r,v]),(0,c.useEffect)(()=>{G(Array.from({length:x},(a,b)=>F[b]||{name:"",age:""})),I(a=>({...a,attendees:Array(x).fill(!1)}))},[x]);let J=(a,b,c)=>{let d=[...F];d[a]={...d[a],[b]:"age"===b?""===c?"":Number(c):c},G(d)},K=a=>{let b=[...H.attendees];b[a]=!0,I(a=>({...a,attendees:b}))},L=()=>{if(!l||!m||0===m.length)return null;for(let a of[...m].sort((a,b)=>a.minAttendees-b.minAttendees))if(x>=a.minAttendees&&(!a.maxAttendees||x<=a.maxAttendees))return a;return null},M={address:H.address&&!z.trim()?"Address is required":"",email:!H.email||B.trim()&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(B)?"":"Valid email is required",phoneNumber:!H.phoneNumber||D.trim()&&/^\+?[\d\s\-()]+$/.test(D)?"":"Valid phone number is required",attendees:F.map((a,b)=>H.attendees[b]?{name:a.name.trim()?"":"Name is required",age:!a.age||a.age<1||a.age>120?"Valid age is required (1-120)":""}:{name:"",age:""})},N=z.trim()&&B.trim()&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(B)&&D.trim()&&/^\+?[\d\s\-()]+$/.test(D)&&F.every(a=>a.name.trim()&&a.age&&a.age>=1&&a.age<=120),O=async a=>{if(a.preventDefault(),I({address:!0,email:!0,phoneNumber:!0,attendees:Array(x).fill(!0)}),!N)return;let b=F.map(a=>({name:a.name.trim(),age:Number(a.age)}));if(r){let a={userId:r.userId,quantity:b.length,attendees:b,email:B.trim()||void 0,phoneNumber:D.trim()||void 0,address:z.trim()||void 0};await p(a)}else{let a={attendees:b,address:z.trim(),email:B.trim(),phoneNumber:D.trim()};await p(a)}},P=(()=>{if(e)return 0;if(l&&m&&m.length>0){let a=L();return a?a.pricePerPerson*x:0}return g&&h&&i&&k?F.reduce((a,b)=>""===b.age||0===b.age?a:a+(Number(b.age)<k?i:h),0):f?f*x:0})(),Q=l?L():null;return(0,b.jsxs)("form",{onSubmit:O,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2 text-neutral-700",children:"Number of Attendees"}),(0,b.jsx)(s.Input,{type:"number",min:"1",max:Math.min(10,d),value:x,onChange:a=>y(parseInt(a.target.value)||1),disabled:n,className:"w-full"}),(0,b.jsx)("p",{className:"text-xs text-neutral-500 mt-1",children:"You'll provide name and age for each attendee below"})]}),(0,b.jsxs)("div",{className:"border-t pt-4",children:[(0,b.jsx)("h4",{className:"text-sm font-semibold mb-3 text-neutral-700",children:"Attendee Information"}),!r&&(0,b.jsx)("p",{className:"text-xs text-neutral-500 mb-4",children:"Please provide name and age for each attendee"}),r&&v&&(0,b.jsx)("p",{className:"text-xs text-neutral-500 mb-4",children:"First attendee pre-populated from your profile. You can edit if needed."}),(0,b.jsx)("div",{className:"space-y-4",children:F.map((a,c)=>(0,b.jsxs)("div",{className:"p-4 bg-neutral-50 rounded-lg border border-neutral-200",children:[(0,b.jsxs)("h5",{className:"text-sm font-medium mb-3 text-neutral-700",children:["Attendee ",c+1]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium mb-2 text-neutral-700",children:["Full Name ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(s.Input,{type:"text",value:a.name,onChange:a=>J(c,"name",a.target.value),onBlur:()=>K(c),error:!!M.attendees[c]?.name,disabled:n,placeholder:"Enter full name",className:"w-full"}),M.attendees[c]?.name&&(0,b.jsx)("p",{className:"text-xs text-red-600 mt-1",children:M.attendees[c].name})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium mb-2 text-neutral-700",children:["Age ",(0,b.jsx)("span",{className:"text-red-500",children:"*"}),g&&k&&(0,b.jsxs)("span",{className:"text-xs text-neutral-500 ml-2",children:["(Under ",k," = child price)"]})]}),(0,b.jsx)(s.Input,{type:"number",min:"1",max:"120",value:a.age,onChange:a=>J(c,"age",a.target.value?parseInt(a.target.value):""),onBlur:()=>K(c),error:!!M.attendees[c]?.age,disabled:n,placeholder:"Age",className:"w-full"}),M.attendees[c]?.age&&(0,b.jsx)("p",{className:"text-xs text-red-600 mt-1",children:M.attendees[c].age})]})]})]},c))})]}),!r&&(0,b.jsxs)("div",{className:"border-t pt-4",children:[(0,b.jsx)("h4",{className:"text-sm font-semibold mb-3 text-neutral-700",children:"Contact Information"}),(0,b.jsx)("p",{className:"text-xs text-neutral-500 mb-4",children:"We'll use this information to send you event updates and confirmations."}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsxs)("label",{className:"block text-sm font-medium mb-2 text-neutral-700",children:["Address ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(s.Input,{type:"text",value:z,onChange:a=>A(a.target.value),onBlur:()=>I({...H,address:!0}),error:!!M.address,disabled:n,placeholder:"Enter your address",className:"w-full"}),M.address&&(0,b.jsx)("p",{className:"text-xs text-red-600 mt-1",children:M.address})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsxs)("label",{className:"block text-sm font-medium mb-2 text-neutral-700",children:["Email ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(s.Input,{type:"email",value:B,onChange:a=>C(a.target.value),onBlur:()=>I({...H,email:!0}),error:!!M.email,disabled:n,placeholder:"your.email@example.com",className:"w-full"}),M.email&&(0,b.jsx)("p",{className:"text-xs text-red-600 mt-1",children:M.email})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium mb-2 text-neutral-700",children:["Phone Number ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(s.Input,{type:"tel",value:D,onChange:a=>E(a.target.value),onBlur:()=>I({...H,phoneNumber:!0}),error:!!M.phoneNumber,disabled:n,placeholder:"+1-123-456-7890",className:"w-full"}),M.phoneNumber&&(0,b.jsx)("p",{className:"text-xs text-red-600 mt-1",children:M.phoneNumber})]})]}),r&&v&&(0,b.jsxs)("div",{className:"border-t pt-4",children:[(0,b.jsx)("h4",{className:"text-sm font-semibold mb-3 text-neutral-700",children:"Contact Information"}),(0,b.jsx)("p",{className:"text-xs text-neutral-500 mb-4",children:"Please verify and update your contact details for this event registration."}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsxs)("label",{className:"block text-sm font-medium mb-2 text-neutral-700",children:["Email ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(s.Input,{type:"email",value:B,onChange:a=>C(a.target.value),onBlur:()=>I({...H,email:!0}),error:!!M.email,disabled:n,placeholder:"your.email@example.com",className:"w-full"}),M.email&&(0,b.jsx)("p",{className:"text-xs text-red-600 mt-1",children:M.email})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsxs)("label",{className:"block text-sm font-medium mb-2 text-neutral-700",children:["Phone Number ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(s.Input,{type:"tel",value:D,onChange:a=>E(a.target.value),onBlur:()=>I({...H,phoneNumber:!0}),error:!!M.phoneNumber,disabled:n,placeholder:"+1-123-456-7890",className:"w-full"}),M.phoneNumber&&(0,b.jsx)("p",{className:"text-xs text-red-600 mt-1",children:M.phoneNumber})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium mb-2 text-neutral-700",children:["Address ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(s.Input,{type:"text",value:z,onChange:a=>A(a.target.value),onBlur:()=>I({...H,address:!0}),error:!!M.address,disabled:n,placeholder:"Enter your address",className:"w-full"}),M.address&&(0,b.jsx)("p",{className:"text-xs text-red-600 mt-1",children:M.address})]}),(0,b.jsx)("p",{className:"text-xs text-neutral-500 mt-3",children:"Pre-filled from your profile. Please verify and update if needed."})]}),!e&&P>0&&(0,b.jsxs)("div",{className:"p-4 bg-neutral-50 rounded-lg border-t-2 border-orange-500",children:[l&&Q&&(0,b.jsxs)("div",{className:"mb-3 space-y-2 text-sm",children:[(0,b.jsx)("h5",{className:"font-medium text-neutral-700",children:"Group Pricing Applied:"}),(0,b.jsxs)("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg border border-orange-200",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-medium text-orange-600",children:Q.tierRange}),(0,b.jsx)("span",{className:"text-neutral-600 ml-2",children:"attendees"})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("div",{className:"text-sm font-medium text-neutral-700",children:["$",Q.pricePerPerson.toFixed(2)," per person"]}),(0,b.jsxs)("div",{className:"text-xs text-neutral-500",children:[x," Ã— $",Q.pricePerPerson.toFixed(2)]})]})]})]}),g&&h&&i&&k&&(0,b.jsxs)("div",{className:"mb-3 space-y-2 text-sm",children:[(0,b.jsx)("h5",{className:"font-medium text-neutral-700",children:"Price Breakdown:"}),F.map((a,c)=>{if(!a.age)return null;let d=Number(a.age),e=d<k?i:h,f=d<k?"Child":"Adult";return(0,b.jsxs)("div",{className:"flex justify-between text-xs text-neutral-600",children:[(0,b.jsxs)("span",{children:[a.name||`Attendee ${c+1}`," (",f,", Age ",d,")"]}),(0,b.jsxs)("span",{children:["$",e.toFixed(2)]})]},c)})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center border-t pt-3",children:[(0,b.jsx)("span",{className:"text-base font-medium text-neutral-700",children:"Total"}),(0,b.jsxs)("span",{className:"text-xl font-bold",style:{color:"#8B1538"},children:["$",P.toFixed(2)]})]})]}),q&&(0,b.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,b.jsx)("p",{className:"text-sm text-red-600",children:q})}),(0,b.jsx)(o.Button,{type:"submit",disabled:n||!N,className:"w-full text-lg py-6",style:{background:"#FF7900"},children:n?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j.Clock,{className:"h-5 w-5 mr-2 animate-spin"}),"Processing..."]}):e?"Register for Free":"Continue to Payment"}),!r&&(0,b.jsxs)("p",{className:"text-sm text-center text-neutral-500",children:["Have an account? ",(0,b.jsx)("a",{href:"/login",className:"text-orange-600 hover:underline",children:"Sign in"})," to register faster"]})]})}var w=a.i(33508),x=a.i(25015);let y=(0,a.i(70106).default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);var z=a.i(50522),A=a.i(26371);function B({images:a=[],videos:d=[],className:e=""}){let[f,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)(0),[j,k]=(0,c.useState)("image"),l=a.length,m=d.length;return 0===l+m?null:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:`space-y-6 ${e}`,children:[l>0&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"text-lg font-semibold text-neutral-900 dark:text-neutral-100 mb-3",children:["Photos (",l,")"]}),(0,b.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:[...a].sort((a,b)=>a.displayOrder-b.displayOrder).map((a,c)=>(0,b.jsxs)("button",{onClick:()=>{i(c),k("image"),g(!0)},className:"relative aspect-square rounded-lg overflow-hidden bg-neutral-100 dark:bg-neutral-800 hover:opacity-90 transition-opacity group",children:[(0,b.jsx)("img",{src:a.imageUrl,alt:`Event photo ${a.displayOrder}`,className:"w-full h-full object-cover"}),(0,b.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors"}),(0,b.jsx)("div",{className:"absolute top-2 left-2 bg-black/50 text-white text-xs px-2 py-1 rounded",children:a.displayOrder})]},a.id))})]}),m>0&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"text-lg font-semibold text-neutral-900 dark:text-neutral-100 mb-3",children:["Videos (",m,")"]}),(0,b.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[...d].sort((a,b)=>a.displayOrder-b.displayOrder).map((a,c)=>(0,b.jsxs)("button",{onClick:()=>{i(c),k("video"),g(!0)},className:"relative aspect-video rounded-lg overflow-hidden bg-neutral-100 dark:bg-neutral-800 hover:opacity-90 transition-opacity group",children:[(0,b.jsx)("img",{src:a.thumbnailUrl,alt:`Video ${a.displayOrder}`,className:"w-full h-full object-cover"}),(0,b.jsx)("div",{className:"absolute inset-0 bg-black/30 group-hover:bg-black/40 transition-colors flex items-center justify-center",children:(0,b.jsx)("div",{className:"bg-white/90 rounded-full p-4",children:(0,b.jsx)(x.Play,{className:"h-8 w-8 text-neutral-900",fill:"currentColor"})})}),(0,b.jsx)("div",{className:"absolute top-2 left-2 bg-black/50 text-white text-xs px-2 py-1 rounded",children:a.displayOrder})]},a.id))})]})]}),(0,b.jsx)(A.Dialog,{open:f,onOpenChange:g,children:(0,b.jsx)(A.DialogContent,{className:"max-w-7xl w-full h-[90vh] p-0 bg-black/95",children:(0,b.jsxs)("div",{className:"relative w-full h-full flex items-center justify-center",children:[(0,b.jsx)("button",{onClick:()=>g(!1),className:"absolute top-4 right-4 z-50 p-2 rounded-full bg-white/10 hover:bg-white/20 transition-colors","aria-label":"Close lightbox",children:(0,b.jsx)(w.X,{className:"h-6 w-6 text-white"})}),("image"===j&&l>1||"video"===j&&m>1)&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:()=>{"image"===j?i(a=>0===a?l-1:a-1):i(a=>0===a?m-1:a-1)},className:"absolute left-4 z-50 p-3 rounded-full bg-white/10 hover:bg-white/20 transition-colors","aria-label":"Previous media",children:(0,b.jsx)(y,{className:"h-6 w-6 text-white"})}),(0,b.jsx)("button",{onClick:()=>{"image"===j?i(a=>a===l-1?0:a+1):i(a=>a===m-1?0:a+1)},className:"absolute right-4 z-50 p-3 rounded-full bg-white/10 hover:bg-white/20 transition-colors","aria-label":"Next media",children:(0,b.jsx)(z.ChevronRight,{className:"h-6 w-6 text-white"})})]}),(0,b.jsxs)("div",{className:"w-full h-full flex items-center justify-center p-12",children:["image"===j&&a[h]&&(0,b.jsx)("img",{src:a[h].imageUrl,alt:`Event photo ${a[h].displayOrder}`,className:"max-w-full max-h-full object-contain"}),"video"===j&&d[h]&&(0,b.jsx)("video",{src:d[h].videoUrl,controls:!0,autoPlay:!0,className:"max-w-full max-h-full",poster:d[h].thumbnailUrl,children:"Your browser does not support the video tag."})]}),(0,b.jsxs)("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-white/10 text-white text-sm px-4 py-2 rounded-full",children:[h+1," / ","image"===j?l:m]})]})})})]})}var C=a.i(15618),D=a.i(81560),E=a.i(46842);function F({open:a,onOpenChange:d,registration:e,eventId:f,isFreeEvent:g,spotsLeft:h,onSave:i,isSubmitting:j=!1}){let[l,m]=(0,c.useState)([]),[n,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)({}),[w,x]=(0,c.useState)(null),y=e?.paymentStatus===1,z=e?.attendees?.length||e?.quantity||1,B=g?Math.min(10,z+h):z;if((0,c.useEffect)(()=>{if(a&&e){if(e.attendees&&e.attendees.length>0)m([...e.attendees]);else{let a=[],b=e.quantity||1;for(let c=0;c<b;c++)a.push({name:"",age:0});m(a)}p(e.contactEmail||""),r(e.contactPhone||""),t(e.contactAddress||""),v({}),x(null)}},[a,e]),(0,c.useEffect)(()=>{a||(m([]),p(""),r(""),t(""),v({}),x(null))},[a]),!e)return null;let F=(a,b,c)=>{let d=[...l];"name"===b?d[a]={...d[a],name:c}:"age"===b&&(d[a]={...d[a],age:c}),m(d);let e=`attendee_${a}_${b}`;if(u[e]){let a={...u};delete a[e],v(a)}},G=async a=>{let b;if(a.preventDefault(),x(null),b={},0===l.length&&(b.attendees="At least one attendee is required"),l.forEach((a,c)=>{a.name&&a.name.trim()?a.name.length>100&&(b[`attendee_${c}_name`]="Name cannot exceed 100 characters"):b[`attendee_${c}_name`]="Name is required",(a.age<0||a.age>120)&&(b[`attendee_${c}_age`]="Age must be between 0 and 120")}),y&&l.length!==z&&(b.attendees=`Cannot change attendee count on a paid registration. Original count: ${z}`),n.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)||(b.email="Invalid email format"):b.email="Email is required",q.trim()?q.length>30&&(b.phoneNumber="Phone number cannot exceed 30 characters"):b.phoneNumber="Phone number is required",s&&s.length>500&&(b.address="Address cannot exceed 500 characters"),v(b),0===Object.keys(b).length)try{await i({attendees:l.map(a=>({name:a.name.trim(),age:a.age})),email:n.trim(),phoneNumber:q.trim(),address:s.trim()||void 0}),d(!1)}catch(a){console.error("Failed to update registration:",a),x(a?.response?.data?.detail||a?.response?.data?.message||a?.message||"Failed to update registration. Please try again.")}};return(0,b.jsx)(A.Dialog,{open:a,onOpenChange:d,children:(0,b.jsx)(A.DialogContent,{className:"max-w-lg max-h-[90vh] overflow-y-auto",children:(0,b.jsxs)("form",{onSubmit:G,children:[(0,b.jsxs)(A.DialogHeader,{children:[(0,b.jsx)(A.DialogTitle,{children:"Edit Registration"}),(0,b.jsxs)(A.DialogDescription,{children:["Update your registration details for this event.",y&&(0,b.jsx)("span",{className:"block mt-1 text-amber-600 dark:text-amber-400 font-medium",children:"Note: Attendee count cannot be changed for paid registrations."})]})]}),(0,b.jsxs)("div",{className:"space-y-6 my-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsxs)("h3",{className:"text-sm font-semibold text-neutral-900 dark:text-neutral-100",children:["Attendees (",l.length,")"]}),!y&&l.length<B&&(0,b.jsxs)(o.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{l.length<B&&m([...l,{name:"",age:0}])},className:"flex items-center gap-1",children:[(0,b.jsx)(C.Plus,{className:"h-4 w-4"}),"Add Attendee"]})]}),u.attendees&&(0,b.jsx)("p",{className:"mb-2 text-xs text-red-600",children:u.attendees}),(0,b.jsx)("div",{className:"space-y-3",children:l.map((a,c)=>(0,b.jsxs)("div",{className:"p-3 bg-neutral-50 dark:bg-neutral-800 rounded-md border border-neutral-200 dark:border-neutral-700",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(E.User,{className:"h-4 w-4 text-neutral-500"}),(0,b.jsxs)("span",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300",children:["Attendee ",c+1]})]}),!y&&l.length>1&&(0,b.jsx)("button",{type:"button",onClick:()=>{l.length>1&&m(l.filter((a,b)=>b!==c))},className:"text-red-500 hover:text-red-700 p-1",title:"Remove attendee",children:(0,b.jsx)(D.Trash2,{className:"h-4 w-4"})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{className:"col-span-2 sm:col-span-1",children:[(0,b.jsx)("label",{htmlFor:`attendee-name-${c}`,className:"block text-xs font-medium text-neutral-600 dark:text-neutral-400 mb-1",children:"Name *"}),(0,b.jsx)("input",{id:`attendee-name-${c}`,type:"text",value:a.name,onChange:a=>F(c,"name",a.target.value),className:`w-full px-3 py-2 text-sm border rounded-md ${u[`attendee_${c}_name`]?"border-red-500 focus:ring-red-500":"border-neutral-300 dark:border-neutral-600 focus:ring-blue-500"} focus:outline-none focus:ring-2`,placeholder:"Full name"}),u[`attendee_${c}_name`]&&(0,b.jsx)("p",{className:"mt-1 text-xs text-red-600",children:u[`attendee_${c}_name`]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:`attendee-age-${c}`,className:"block text-xs font-medium text-neutral-600 dark:text-neutral-400 mb-1",children:"Age *"}),(0,b.jsx)("input",{id:`attendee-age-${c}`,type:"number",min:"0",max:"120",value:a.age||"",onChange:a=>F(c,"age",parseInt(a.target.value)||0),className:`w-full px-3 py-2 text-sm border rounded-md ${u[`attendee_${c}_age`]?"border-red-500 focus:ring-red-500":"border-neutral-300 dark:border-neutral-600 focus:ring-blue-500"} focus:outline-none focus:ring-2`,placeholder:"Age"}),u[`attendee_${c}_age`]&&(0,b.jsx)("p",{className:"mt-1 text-xs text-red-600",children:u[`attendee_${c}_age`]})]})]})]},c))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-neutral-900 dark:text-neutral-100 mb-3",children:"Contact Information"}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1",children:"Email *"}),(0,b.jsx)("input",{id:"email",type:"email",value:n,onChange:a=>{if(p(a.target.value),u.email){let a={...u};delete a.email,v(a)}},className:`w-full px-3 py-2 border rounded-md ${u.email?"border-red-500 focus:ring-red-500":"border-neutral-300 dark:border-neutral-600 focus:ring-blue-500"} focus:outline-none focus:ring-2`,placeholder:"your.email@example.com"}),u.email&&(0,b.jsx)("p",{className:"mt-1 text-xs text-red-600",children:u.email})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1",children:"Phone Number *"}),(0,b.jsx)("input",{id:"phone",type:"tel",value:q,onChange:a=>{if(r(a.target.value),u.phoneNumber){let a={...u};delete a.phoneNumber,v(a)}},className:`w-full px-3 py-2 border rounded-md ${u.phoneNumber?"border-red-500 focus:ring-red-500":"border-neutral-300 dark:border-neutral-600 focus:ring-blue-500"} focus:outline-none focus:ring-2`,placeholder:"+1 (555) 123-4567"}),u.phoneNumber&&(0,b.jsx)("p",{className:"mt-1 text-xs text-red-600",children:u.phoneNumber})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"address",className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1",children:"Address (Optional)"}),(0,b.jsx)("textarea",{id:"address",value:s,onChange:a=>{if(t(a.target.value),u.address){let a={...u};delete a.address,v(a)}},rows:2,className:`w-full px-3 py-2 border rounded-md ${u.address?"border-red-500 focus:ring-red-500":"border-neutral-300 dark:border-neutral-600 focus:ring-blue-500"} focus:outline-none focus:ring-2`,placeholder:"123 Main St, City, State ZIP"}),u.address&&(0,b.jsx)("p",{className:"mt-1 text-xs text-red-600",children:u.address})]})]})]}),w&&(0,b.jsxs)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md flex items-start gap-2",children:[(0,b.jsx)(k.AlertCircle,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-red-800",children:"Update Failed"}),(0,b.jsx)("p",{className:"text-sm text-red-700",children:w})]})]})]}),(0,b.jsx)(A.DialogFooter,{children:(0,b.jsxs)("div",{className:"flex gap-2 w-full",children:[(0,b.jsx)(o.Button,{type:"button",variant:"outline",onClick:()=>d(!1),disabled:j,className:"flex-1",children:"Cancel"}),(0,b.jsx)(o.Button,{type:"submit",disabled:j,className:"flex-1",children:j?"Saving...":"Save Changes"})]})})]})})})}var G=a.i(69212),H=a.i(29312);function I({params:a}){let{id:s}=(0,c.use)(a),u=(0,d.useRouter)(),w=(0,d.useSearchParams)(),{user:x,isHydrated:y}=(0,t.useAuthStore)(),z=w.get("from"),[A,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(null),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(!1),[O,P]=(0,c.useState)(null),[Q,R]=(0,c.useState)(!1),[S,T]=(0,c.useState)(!1),[U,V]=(0,c.useState)(!1),[W,X]=(0,c.useState)(!1),{data:Y,isLoading:Z,error:$}=(0,q.useEventById)(s),{data:_,isLoading:aa}=(0,q.useUserRsvpForEvent)(x?.userId&&y?s:void 0),{data:ab,isLoading:ac}=(0,q.useUserRegistrationDetails)(x?.userId&&y?s:void 0,!!_),ad=!!_&&ab?.status!==G.RegistrationStatus.Cancelled,ae=(0,q.useRsvpToEvent)(),af=(0,q.useUpdateRegistrationDetails)(),ag={[G.EventCategory.Religious]:"Religious",[G.EventCategory.Cultural]:"Cultural",[G.EventCategory.Community]:"Community",[G.EventCategory.Educational]:"Educational",[G.EventCategory.Social]:"Social",[G.EventCategory.Business]:"Business",[G.EventCategory.Charity]:"Charity",[G.EventCategory.Entertainment]:"Entertainment"},ah=async a=>{if(Y)try{if(C(!0),E(null),"userId"in a){let b=`/events/payment/success?eventId=${s}`,c=`/events/payment/cancel?eventId=${s}`,d=await ae.mutateAsync({eventId:s,userId:a.userId,quantity:a.attendees?.length||a.quantity||1,attendees:a.attendees,email:a.email,phoneNumber:a.phoneNumber,address:a.address,successUrl:b,cancelUrl:c});if(d){window.location.href=d;return}setTimeout(()=>{window.location.reload()},500)}else await H.eventsRepository.registerAnonymous(s,a),setTimeout(()=>{window.location.reload()},500);C(!1)}catch(a){console.error("Registration failed:",a),a?.response?.status===401||a?.message?.includes("Token refresh failed")?(E("Your session has expired. Please log out and log back in to continue."),setTimeout(()=>{u.push("/login?redirect="+encodeURIComponent(`/events/${s}`))},3e3)):E(a instanceof Error?a.message:"Failed to register. Please try again."),C(!1)}},ai=async()=>{if(!x?.userId)return void u.push("/login?redirect="+encodeURIComponent(`/events/${s}`));try{J(!0),E(null),await H.eventsRepository.addToWaitingList(s),J(!1)}catch(a){console.error("Failed to join waitlist:",a),E(a instanceof Error?a.message:"Failed to join waitlist. Please try again."),J(!1)}},aj=async()=>{if(Y&&Y.organizerId===x?.userId)try{L(!0),E(null),await H.eventsRepository.publishEvent(s),L(!1),window.location.reload()}catch(a){console.error("Failed to publish event:",a),E(a instanceof Error?a.message:"Failed to publish event. Please try again."),L(!1)}},ak=async a=>{try{V(!0),await af.mutateAsync({eventId:s,attendees:a.attendees,email:a.email,phoneNumber:a.phoneNumber,address:a.address}),V(!1)}catch(a){throw V(!1),a}};if(Z)return(0,b.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-neutral-50 to-white",children:[(0,b.jsx)(l.Header,{}),(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:(0,b.jsx)(n.Card,{className:"animate-pulse",children:(0,b.jsxs)(n.CardContent,{className:"p-12",children:[(0,b.jsx)("div",{className:"h-8 bg-neutral-200 rounded w-3/4 mb-4"}),(0,b.jsx)("div",{className:"h-4 bg-neutral-200 rounded w-1/2 mb-8"}),(0,b.jsx)("div",{className:"h-64 bg-neutral-200 rounded mb-8"}),(0,b.jsx)("div",{className:"h-32 bg-neutral-200 rounded"})]})})}),(0,b.jsx)(m.default,{})]});if($||!Y)return(0,b.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-neutral-50 to-white",children:[(0,b.jsx)(l.Header,{}),(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:(0,b.jsx)(n.Card,{children:(0,b.jsxs)(n.CardContent,{className:"p-12 text-center",children:[(0,b.jsx)(k.AlertCircle,{className:"h-16 w-16 mx-auto mb-4 text-destructive"}),(0,b.jsx)("h3",{className:"text-xl font-semibold text-neutral-900 mb-2",children:"Event Not Found"}),(0,b.jsx)("p",{className:"text-neutral-500 mb-6",children:"The event you're looking for doesn't exist or has been removed."}),(0,b.jsx)(o.Button,{onClick:()=>u.push("dashboard"===z?"/dashboard":"/events"),children:"dashboard"===z?"Back to Dashboard":"Back to Events"})]})})}),(0,b.jsx)(m.default,{})]});let al=new Date(Y.startDate),am=new Date(Y.endDate),an=al.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}),ao=al.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),ap=am.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),aq=Y.currentRegistrations>=Y.capacity,ar=Y.capacity-Y.currentRegistrations;return(0,b.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-neutral-50 to-white",children:[(0,b.jsx)(l.Header,{}),(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,b.jsxs)(o.Button,{variant:"outline",onClick:()=>u.push("dashboard"===z?"/dashboard":"/events"),className:"flex items-center gap-2",children:[(0,b.jsx)(e.ArrowLeft,{className:"h-4 w-4"}),"dashboard"===z?"Back to Dashboard":"Back to Events"]}),Y&&x&&Y.organizerId===x.userId&&(0,b.jsx)("div",{className:"flex items-center gap-3",children:Y.status===G.EventStatus.Draft&&(0,b.jsx)(o.Button,{onClick:aj,disabled:K,className:"flex items-center gap-2",style:{background:"#10B981"},children:K?"Publishing...":"Publish Event"})})]})}),(0,b.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-12",children:[(0,b.jsxs)(n.Card,{className:"overflow-hidden",children:[Y.images&&Y.images.length>0&&(0,b.jsxs)("div",{className:"relative h-96 bg-gradient-to-br from-orange-500 to-rose-500",children:[(0,b.jsx)("img",{src:(Y.images.find(a=>a.isPrimary)||Y.images[0]).imageUrl,alt:Y.title,className:"w-full h-full object-cover"}),(0,b.jsx)("div",{className:"absolute top-4 right-4",children:(0,b.jsx)(p.Badge,{variant:"default",className:"text-white shadow-lg text-base px-4 py-2",style:{background:"#8B1538"},children:ag[Y.category]})})]}),(0,b.jsxs)(n.CardContent,{className:"p-8",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("h1",{className:"text-4xl font-bold text-neutral-900 mb-4",children:Y.title}),(0,b.jsx)("p",{className:"text-lg text-neutral-600 leading-relaxed whitespace-pre-wrap",children:Y.description})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"p-3 rounded-lg",style:{background:"#FFF4ED"},children:(0,b.jsx)(f.Calendar,{className:"h-6 w-6",style:{color:"#FF7900"}})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-neutral-500",children:"Date & Time"}),(0,b.jsx)("p",{className:"text-base font-semibold text-neutral-900",children:an}),(0,b.jsxs)("p",{className:"text-sm text-neutral-600",children:[ao," - ",ap]})]})]}),Y.city&&Y.state&&(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"p-3 rounded-lg",style:{background:"#FFF4ED"},children:(0,b.jsx)(g.MapPin,{className:"h-6 w-6",style:{color:"#FF7900"}})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-neutral-500",children:"Location"}),(0,b.jsxs)("p",{className:"text-base font-semibold text-neutral-900",children:[Y.city,", ",Y.state]}),Y.address&&(0,b.jsx)("p",{className:"text-sm text-neutral-600",children:Y.address})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"p-3 rounded-lg",style:{background:"#FFF4ED"},children:(0,b.jsx)(h.Users,{className:"h-6 w-6",style:{color:"#FF7900"}})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-neutral-500",children:"Capacity"}),(0,b.jsxs)("p",{className:"text-base font-semibold text-neutral-900",children:[Y.currentRegistrations," / ",Y.capacity," registered"]}),aq?(0,b.jsx)(p.Badge,{className:"mt-1 bg-red-600 text-white",children:"Event Full"}):(0,b.jsxs)("p",{className:"text-sm text-neutral-600",children:[ar," ",1===ar?"spot":"spots"," remaining"]})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"p-3 rounded-lg",style:{background:"#FFF4ED"},children:(0,b.jsx)(i.DollarSign,{className:"h-6 w-6",style:{color:"#FF7900"}})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-neutral-500",children:"Pricing"}),Y.isFree?(0,b.jsx)("p",{className:"text-base font-semibold",style:{color:"#8B1538"},children:"Free Event"}):Y.hasGroupPricing&&Y.groupPricingTiers&&Y.groupPricingTiers.length>0?(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-neutral-600 mb-1",children:"Group Tiered Pricing"}),Y.groupPricingTiers.map((a,c)=>(0,b.jsxs)("p",{className:"text-base font-semibold",style:{color:"#8B1538"},children:[a.maxAttendees?a.minAttendees===a.maxAttendees?`${a.minAttendees} ${1===a.minAttendees?"person":"persons"}`:`${a.minAttendees}-${a.maxAttendees} persons`:`${a.minAttendees}+ persons`,": $",a.pricePerPerson.toFixed(2)]},c))]}):Y.hasDualPricing?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("p",{className:"text-base font-semibold",style:{color:"#8B1538"},children:["Adult: $",Y.adultPriceAmount?.toFixed(2)]}),(0,b.jsxs)("p",{className:"text-base font-semibold",style:{color:"#8B1538"},children:["Child (under ",Y.childAgeLimit,"): $",Y.childPriceAmount?.toFixed(2)]}),(0,b.jsx)("p",{className:"text-sm text-neutral-600",children:1===Y.adultPriceCurrency?"USD":"LKR"})]}):null!=Y.ticketPriceAmount?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("p",{className:"text-base font-semibold",style:{color:"#8B1538"},children:["$",Y.ticketPriceAmount.toFixed(2)," per person"]}),(0,b.jsx)("p",{className:"text-sm text-neutral-600",children:1===Y.ticketPriceCurrency?"USD":"LKR"})]}):(0,b.jsx)("p",{className:"text-base font-semibold",style:{color:"#8B1538"},children:"Paid Event"})]})]})]}),(Y.images&&Y.images.length>0||Y.videos&&Y.videos.length>0)&&(0,b.jsx)("div",{className:"mb-8",children:(0,b.jsx)(B,{images:Y.images,videos:Y.videos})}),(0,b.jsxs)(n.Card,{className:"border-2",style:{borderColor:"#FF7900"},children:[(0,b.jsxs)(n.CardHeader,{children:[(0,b.jsx)(n.CardTitle,{children:ad?"Your Registration":ab?.status===G.RegistrationStatus.Cancelled?"Registration Cancelled":"Register for this Event"}),(0,b.jsx)(n.CardDescription,{children:ad?"You are already registered for this event!":ab?.status===G.RegistrationStatus.Cancelled?"Your registration for this event has been cancelled. You can register again if you wish.":aq?"This event is currently full. Join the waitlist to be notified when spots become available.":"Reserve your spot now!"})]}),(0,b.jsx)(n.CardContent,{children:ab?.status===G.RegistrationStatus.Cancelled?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"p-4 bg-gray-50 dark:bg-gray-900/20 border border-gray-200 dark:border-gray-800 rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,b.jsx)("svg",{className:"h-5 w-5 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Registration Cancelled"})]}),(0,b.jsxs)("p",{className:"text-sm text-gray-800 dark:text-gray-200 mb-3",children:["Your registration for this event was cancelled",ab.updatedAt?` on ${new Date(ab.updatedAt).toLocaleDateString()}`:"","."]}),(0,b.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:"You can register again using the form below."})]}),aq?(0,b.jsx)("div",{className:"p-4 bg-orange-50 border border-orange-200 rounded-lg",children:(0,b.jsx)("p",{className:"text-sm text-orange-800",children:"This event is currently full. The waitlist feature is coming soon."})}):(0,b.jsx)(v,{eventId:s,spotsLeft:ar,isFree:Y.isFree,ticketPrice:Y.ticketPriceAmount??void 0,hasDualPricing:Y.hasDualPricing,adultPrice:Y.adultPriceAmount??void 0,childPrice:Y.childPriceAmount??void 0,childAgeLimit:Y.childAgeLimit??void 0,isProcessing:A,onSubmit:ah,error:D})]}):ad?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,b.jsx)("svg",{className:"h-5 w-5 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-green-900 dark:text-green-100",children:"You're Registered!"})]}),(0,b.jsx)("p",{className:"text-sm text-green-800 dark:text-green-200 mb-3",children:"You have successfully registered for this event. We look forward to seeing you there!"}),(0,b.jsxs)("div",{className:"mt-3 pt-3 border-t border-green-200 dark:border-green-700",children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-green-900 dark:text-green-100 mb-3",children:"Registration Details:"}),ac?(0,b.jsx)("p",{className:"text-sm text-green-800 dark:text-green-200",children:"Loading registration details..."}):ab?(0,b.jsxs)("div",{className:"space-y-4",children:[(ab.contactEmail||ab.contactPhone||ab.contactAddress)&&(0,b.jsxs)("div",{className:"bg-green-100 dark:bg-green-900/30 rounded p-3",children:[(0,b.jsx)("p",{className:"text-xs font-semibold text-green-900 dark:text-green-200 mb-2",children:"CONTACT INFORMATION"}),(0,b.jsxs)("div",{className:"space-y-1 text-xs text-green-800 dark:text-green-300",children:[ab.contactEmail&&(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"font-medium",children:"Email:"})," ",ab.contactEmail]}),ab.contactPhone&&(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"font-medium",children:"Phone:"})," ",ab.contactPhone]}),ab.contactAddress&&(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"font-medium",children:"Address:"})," ",ab.contactAddress]})]})]}),ab.attendees&&ab.attendees.length>0?(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-sm font-semibold text-green-900 dark:text-green-100 mb-2",children:["Attendees (",ab.attendees.length,"):"]}),(0,b.jsx)("div",{className:"space-y-2",children:ab.attendees.map((a,c)=>(0,b.jsx)("div",{className:"bg-green-100 dark:bg-green-900/30 rounded p-2.5 text-xs",children:(0,b.jsx)("div",{className:"flex justify-between items-start",children:(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"font-medium text-green-900 dark:text-green-100",children:[c+1,". ",a.name]}),(0,b.jsxs)("p",{className:"text-green-700 dark:text-green-300 mt-0.5",children:["Age: ",a.age]})]})})},c))})]}):(0,b.jsx)("div",{className:"text-sm text-green-800 dark:text-green-200",children:(0,b.jsxs)("p",{children:["Number of attendees: ",ab.quantity||_?.currentRegistrations||1]})})]}):(0,b.jsx)("div",{className:"text-sm text-green-800 dark:text-green-200",children:(0,b.jsxs)("p",{children:["Number of attendees: ",_?.currentRegistrations||1]})})]})]}),O&&(0,b.jsx)("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)(k.AlertCircle,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h4",{className:"text-sm font-semibold text-red-900 mb-1",children:"Failed to Cancel Registration"}),(0,b.jsx)("p",{className:"text-sm text-red-700",children:O}),(0,b.jsx)("p",{className:"text-xs text-red-600 mt-2",children:"Please try again or contact support if the problem persists."})]})]})}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)(o.Button,{variant:"outline",className:"flex-1",onClick:()=>T(!0),children:"Edit Registration"}),M?(0,b.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,b.jsx)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,b.jsxs)("label",{className:"flex items-start gap-3 cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",checked:W,onChange:a=>X(a.target.checked),className:"mt-1 h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Also delete my sign-up commitments"}),(0,b.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:W?"Your sign-up items will be removed and available for others to claim.":"Your sign-up commitments will be kept even after cancellation (default)."})]})]})}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(o.Button,{variant:"outline",className:"flex-1",onClick:()=>{console.log("[CancelRsvp] User cancelled the cancellation"),N(!1),P(null),R(!1),X(!1)},children:"Keep Registration"}),(0,b.jsx)(o.Button,{variant:"outline",className:"flex-1",disabled:Q,style:{borderColor:"#EF4444",color:"#FFFFFF",backgroundColor:"#EF4444",opacity:Q?.6:1},onClick:async()=>{try{console.log("[CancelRsvp] User confirmed cancellation, DeleteSignUpCommitments:",W),R(!0),P(null),await H.eventsRepository.cancelRsvp(s,W),console.log("[CancelRsvp] Successfully cancelled registration - reloading page"),window.location.reload()}catch(a){console.error("[CancelRsvp] Failed to cancel registration:",a),console.error("[CancelRsvp] Error details:",{message:a?.message,response:a?.response,status:a?.response?.status,data:a?.response?.data,detail:a?.response?.data?.detail}),P(a?.response?.data?.detail||a?.response?.data?.message||a?.message||"Unknown error"),R(!1)}},children:Q?"Cancelling...":"Confirm Cancel"})]})]}):(0,b.jsx)(o.Button,{variant:"outline",className:"flex-1",style:{borderColor:"#EF4444",color:"#EF4444"},onClick:()=>{console.log("[CancelRsvp] User clicked Cancel Registration button"),N(!0)},children:"Cancel Registration"})]})]}):aq?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(o.Button,{onClick:ai,disabled:I,className:"w-full text-lg py-6",variant:"outline",style:{borderColor:"#FF7900",color:"#FF7900"},children:I?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j.Clock,{className:"h-5 w-5 mr-2 animate-spin"}),"Joining..."]}):"Join Waitlist"}),!x?.userId&&(0,b.jsx)("p",{className:"text-sm text-center text-neutral-500",children:"You'll be redirected to login before joining the waitlist"})]}),D&&(0,b.jsx)("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,b.jsx)("p",{className:"text-sm text-red-600",children:D})})]}):(0,b.jsx)(v,{eventId:s,spotsLeft:ar,isFree:Y.isFree,ticketPrice:Y.ticketPriceAmount??void 0,hasDualPricing:Y.hasDualPricing,adultPrice:Y.adultPriceAmount??void 0,childPrice:Y.childPriceAmount??void 0,childAgeLimit:Y.childAgeLimit??void 0,isProcessing:A,onSubmit:ah,error:D})})]})]})]}),y&&(0,b.jsx)("div",{className:"mt-8",children:(0,b.jsx)(r.SignUpManagementSection,{eventId:s,userId:x?.userId,isOrganizer:!1})})]}),(0,b.jsx)(m.default,{}),(0,b.jsx)(F,{open:S,onOpenChange:T,registration:ab||null,eventId:s,isFreeEvent:Y?.isFree??!0,spotsLeft:ar,onSave:ak,isSubmitting:U})]})}a.s(["default",()=>I],53033)}];

//# sourceMappingURL=src_app_events_%5Bid%5D_page_tsx_4d745fbe._.js.map