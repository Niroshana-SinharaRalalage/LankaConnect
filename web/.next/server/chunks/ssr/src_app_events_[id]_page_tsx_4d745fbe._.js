module.exports=[53033,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(210),f=a.i(41675),g=a.i(24987),h=a.i(60246),i=a.i(90166),j=a.i(41710);let k=(0,a.i(70106).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var l=a.i(50388),m=a.i(93003),n=a.i(50253),o=a.i(42043),p=a.i(63535),q=a.i(74934),r=a.i(11760),s=a.i(69212);function t({eventId:a,userId:d,isOrganizer:e=!1}){let[f,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)(null),[j,k]=(0,c.useState)(""),[l,m]=(0,c.useState)(1),{data:p,isLoading:q,error:t}=(0,r.useEventSignUps)(a),u=(0,r.useCommitToSignUp)(),v=(0,r.useCancelCommitment)(),w=async b=>{if(!d)return void alert("Please log in to commit to items");if(!j.trim())return void alert("Please enter an item description");try{await u.mutateAsync({eventId:a,signupId:b,userId:d,itemDescription:j.trim(),quantity:l}),k(""),m(1),g(!1),i(null)}catch(a){console.error("Failed to commit:",a),alert("Failed to commit. Please try again.")}},x=async b=>{if(d&&confirm("Are you sure you want to cancel your commitment?"))try{await v.mutateAsync({eventId:a,signupId:b,userId:d})}catch(a){console.error("Failed to cancel commitment:",a),alert("Failed to cancel commitment. Please try again.")}};return q?(0,b.jsx)("div",{className:"py-8",children:(0,b.jsx)("p",{className:"text-center text-muted-foreground",children:"Loading sign-up lists..."})}):t?(0,b.jsx)("div",{className:"py-8",children:(0,b.jsx)("p",{className:"text-center text-destructive",children:"Failed to load sign-up lists. Please try again."})}):p&&0!==p.length?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold",children:"Sign-Up Lists"}),p.map(a=>{let c=a.commitments.find(a=>a.userId===d);return(0,b.jsxs)(n.Card,{children:[(0,b.jsxs)(n.CardHeader,{children:[(0,b.jsx)(n.CardTitle,{children:a.category}),(0,b.jsx)(n.CardDescription,{children:a.description}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Type: ",a.signUpType===s.SignUpType.Predefined?"Predefined Items":"Open"]})]}),(0,b.jsxs)(n.CardContent,{children:[a.signUpType===s.SignUpType.Predefined&&a.predefinedItems.length>0&&(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("h4",{className:"font-semibold mb-2",children:"Suggested Items:"}),(0,b.jsx)("ul",{className:"list-disc list-inside text-sm text-muted-foreground",children:a.predefinedItems.map((a,c)=>(0,b.jsx)("li",{children:a},c))})]}),a.commitments.length>0?(0,b.jsxs)("div",{children:[(0,b.jsxs)("h4",{className:"font-semibold mb-2",children:["Commitments (",a.commitmentCount,"):"]}),(0,b.jsx)("div",{className:"space-y-2",children:a.commitments.map(c=>(0,b.jsxs)("div",{className:"flex justify-between items-center p-2 bg-muted rounded-md",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:c.itemDescription}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Quantity: ",c.quantity]})]}),c.userId===d&&(0,b.jsx)(o.Button,{variant:"destructive",size:"sm",onClick:()=>x(a.id),disabled:v.isPending,children:v.isPending?"Canceling...":"Cancel"})]},c.id))})]}):(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No commitments yet. Be the first!"})]}),(0,b.jsxs)(n.CardFooter,{children:[!c&&d&&(0,b.jsx)("div",{className:"w-full space-y-3",children:h===a.id?(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Item Description *"}),(0,b.jsx)("input",{type:"text",value:j,onChange:a=>k(a.target.value),placeholder:"What will you bring?",className:"w-full px-3 py-2 border rounded-md"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Quantity"}),(0,b.jsx)("input",{type:"number",min:"1",value:l,onChange:a=>m(parseInt(a.target.value)||1),className:"w-full px-3 py-2 border rounded-md"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(o.Button,{onClick:()=>w(a.id),disabled:u.isPending||!j.trim(),children:u.isPending?"Committing...":"Confirm"}),(0,b.jsx)(o.Button,{variant:"outline",onClick:()=>{i(null),k(""),m(1)},children:"Cancel"})]})]}):(0,b.jsx)(o.Button,{onClick:()=>i(a.id),children:"I can bring something"})}),!d&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Please log in to commit to items"})]})]},a.id)})]}):(0,b.jsx)("div",{className:"py-8",children:(0,b.jsx)(n.Card,{children:(0,b.jsxs)(n.CardHeader,{children:[(0,b.jsx)(n.CardTitle,{children:"Sign-Up Lists"}),(0,b.jsxs)(n.CardDescription,{children:["No sign-up lists for this event yet.",e&&" Create one to let attendees volunteer to bring items!"]})]})})})}var u=a.i(72988),v=a.i(29312);function w({params:a}){let{id:r}=(0,c.use)(a),w=(0,d.useRouter)(),{user:x}=(0,u.useAuthStore)(),[y,z]=(0,c.useState)(1),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)(!1),{data:G,isLoading:H,error:I}=(0,q.useEventById)(r),J=(0,q.useRsvpToEvent)(),K={[s.EventCategory.Religious]:"Religious",[s.EventCategory.Cultural]:"Cultural",[s.EventCategory.Community]:"Community",[s.EventCategory.Educational]:"Educational",[s.EventCategory.Social]:"Social",[s.EventCategory.Business]:"Business",[s.EventCategory.Charity]:"Charity",[s.EventCategory.Entertainment]:"Entertainment"},L=async()=>{if(!x?.userId)return void w.push("/login?redirect="+encodeURIComponent(`/events/${r}`));if(G)try{B(!0),D(null),!G.isFree&&G.ticketPriceAmount&&window.location.origin,await J.mutateAsync({eventId:r,userId:x.userId,quantity:y}),B(!1)}catch(a){console.error("RSVP failed:",a),D(a instanceof Error?a.message:"Failed to register. Please try again."),B(!1)}},M=async()=>{if(!x?.userId)return void w.push("/login?redirect="+encodeURIComponent(`/events/${r}`));try{F(!0),D(null),await v.eventsRepository.addToWaitingList(r),F(!1),alert("Successfully joined waitlist! You will be notified when a spot becomes available.")}catch(a){console.error("Failed to join waitlist:",a),D(a instanceof Error?a.message:"Failed to join waitlist. Please try again."),F(!1)}};if(H)return(0,b.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-neutral-50 to-white",children:[(0,b.jsx)(l.Header,{}),(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:(0,b.jsx)(n.Card,{className:"animate-pulse",children:(0,b.jsxs)(n.CardContent,{className:"p-12",children:[(0,b.jsx)("div",{className:"h-8 bg-neutral-200 rounded w-3/4 mb-4"}),(0,b.jsx)("div",{className:"h-4 bg-neutral-200 rounded w-1/2 mb-8"}),(0,b.jsx)("div",{className:"h-64 bg-neutral-200 rounded mb-8"}),(0,b.jsx)("div",{className:"h-32 bg-neutral-200 rounded"})]})})}),(0,b.jsx)(m.default,{})]});if(I||!G)return(0,b.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-neutral-50 to-white",children:[(0,b.jsx)(l.Header,{}),(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:(0,b.jsx)(n.Card,{children:(0,b.jsxs)(n.CardContent,{className:"p-12 text-center",children:[(0,b.jsx)(k,{className:"h-16 w-16 mx-auto mb-4 text-destructive"}),(0,b.jsx)("h3",{className:"text-xl font-semibold text-neutral-900 mb-2",children:"Event Not Found"}),(0,b.jsx)("p",{className:"text-neutral-500 mb-6",children:"The event you're looking for doesn't exist or has been removed."}),(0,b.jsx)(o.Button,{onClick:()=>w.push("/events"),children:"Back to Events"})]})})}),(0,b.jsx)(m.default,{})]});let N=new Date(G.startDate),O=new Date(G.endDate),P=N.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}),Q=N.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),R=O.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),S=G.currentRegistrations>=G.capacity,T=G.capacity-G.currentRegistrations;return(0,b.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-neutral-50 to-white",children:[(0,b.jsx)(l.Header,{}),(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,b.jsxs)(o.Button,{variant:"outline",onClick:()=>w.push("/events"),className:"flex items-center gap-2",children:[(0,b.jsx)(e.ArrowLeft,{className:"h-4 w-4"}),"Back to Events"]})}),(0,b.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-12",children:[(0,b.jsxs)(n.Card,{className:"overflow-hidden",children:[G.images&&G.images.length>0&&(0,b.jsxs)("div",{className:"relative h-96 bg-gradient-to-br from-orange-500 to-rose-500",children:[(0,b.jsx)("img",{src:G.images[0].imageUrl,alt:G.title,className:"w-full h-full object-cover"}),(0,b.jsx)("div",{className:"absolute top-4 right-4",children:(0,b.jsx)(p.Badge,{variant:"default",className:"text-white shadow-lg text-base px-4 py-2",style:{background:"#8B1538"},children:K[G.category]})})]}),(0,b.jsxs)(n.CardContent,{className:"p-8",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("h1",{className:"text-4xl font-bold text-neutral-900 mb-4",children:G.title}),(0,b.jsx)("p",{className:"text-lg text-neutral-600 leading-relaxed whitespace-pre-wrap",children:G.description})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"p-3 rounded-lg",style:{background:"#FFF4ED"},children:(0,b.jsx)(f.Calendar,{className:"h-6 w-6",style:{color:"#FF7900"}})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-neutral-500",children:"Date & Time"}),(0,b.jsx)("p",{className:"text-base font-semibold text-neutral-900",children:P}),(0,b.jsxs)("p",{className:"text-sm text-neutral-600",children:[Q," - ",R]})]})]}),G.city&&G.state&&(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"p-3 rounded-lg",style:{background:"#FFF4ED"},children:(0,b.jsx)(g.MapPin,{className:"h-6 w-6",style:{color:"#FF7900"}})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-neutral-500",children:"Location"}),(0,b.jsxs)("p",{className:"text-base font-semibold text-neutral-900",children:[G.city,", ",G.state]}),G.address&&(0,b.jsx)("p",{className:"text-sm text-neutral-600",children:G.address})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"p-3 rounded-lg",style:{background:"#FFF4ED"},children:(0,b.jsx)(h.Users,{className:"h-6 w-6",style:{color:"#FF7900"}})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-neutral-500",children:"Capacity"}),(0,b.jsxs)("p",{className:"text-base font-semibold text-neutral-900",children:[G.currentRegistrations," / ",G.capacity," registered"]}),S?(0,b.jsx)(p.Badge,{className:"mt-1 bg-red-600 text-white",children:"Event Full"}):(0,b.jsxs)("p",{className:"text-sm text-neutral-600",children:[T," ",1===T?"spot":"spots"," remaining"]})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"p-3 rounded-lg",style:{background:"#FFF4ED"},children:(0,b.jsx)(i.DollarSign,{className:"h-6 w-6",style:{color:"#FF7900"}})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-neutral-500",children:"Pricing"}),(0,b.jsx)("p",{className:"text-base font-semibold",style:{color:"#8B1538"},children:G.isFree?"Free Event":`$${G.ticketPriceAmount?.toFixed(2)} per person`}),!G.isFree&&(0,b.jsx)("p",{className:"text-sm text-neutral-600",children:1===G.ticketPriceCurrency?"USD":"LKR"})]})]})]}),(0,b.jsxs)(n.Card,{className:"border-2",style:{borderColor:"#FF7900"},children:[(0,b.jsxs)(n.CardHeader,{children:[(0,b.jsx)(n.CardTitle,{children:"Register for this Event"}),(0,b.jsx)(n.CardDescription,{children:S?"This event is currently full. Join the waitlist to be notified when spots become available.":"Reserve your spot now!"})]}),(0,b.jsxs)(n.CardContent,{children:[C&&(0,b.jsx)("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,b.jsx)("p",{className:"text-sm text-red-600",children:C})}),!S&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Number of Attendees"}),(0,b.jsx)("input",{type:"number",min:"1",max:Math.min(10,T),value:y,onChange:a=>z(parseInt(a.target.value)||1),className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",disabled:A})]}),!G.isFree&&G.ticketPriceAmount&&(0,b.jsx)("div",{className:"p-4 bg-neutral-50 rounded-lg",children:(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-base font-medium",children:"Total"}),(0,b.jsxs)("span",{className:"text-xl font-bold",style:{color:"#8B1538"},children:["$",(G.ticketPriceAmount*y).toFixed(2)]})]})}),(0,b.jsx)(o.Button,{onClick:L,disabled:A||J.isPending,className:"w-full text-lg py-6",style:{background:"#FF7900"},children:A||J.isPending?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j.Clock,{className:"h-5 w-5 mr-2 animate-spin"}),"Processing..."]}):G.isFree?"Register for Free":"Continue to Payment"}),!x?.userId&&(0,b.jsx)("p",{className:"text-sm text-center text-neutral-500",children:"You'll be redirected to login before registration"})]}),S&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(o.Button,{onClick:M,disabled:E,className:"w-full text-lg py-6",variant:"outline",style:{borderColor:"#FF7900",color:"#FF7900"},children:E?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j.Clock,{className:"h-5 w-5 mr-2 animate-spin"}),"Joining..."]}):"Join Waitlist"}),!x?.userId&&(0,b.jsx)("p",{className:"text-sm text-center text-neutral-500",children:"You'll be redirected to login before joining the waitlist"})]})]})]})]})]}),(0,b.jsx)("div",{className:"mt-8",children:(0,b.jsx)(t,{eventId:r,userId:x?.userId,isOrganizer:G.organizerId===x?.userId})})]}),(0,b.jsx)(m.default,{})]})}a.s(["default",()=>w],53033)}];

//# sourceMappingURL=src_app_events_%5Bid%5D_page_tsx_4d745fbe._.js.map