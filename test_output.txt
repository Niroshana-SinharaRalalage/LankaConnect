Build started 1/24/2026 8:36:16 AM.
     1>Project "C:\Work\LankaConnect\LankaConnect.sln" on node 1 (VSTest target(s)).
     1>ValidateSolutionConfiguration:
         Building solution configuration "Debug|Any CPU".
Test run for C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\bin\Debug\net8.0\LankaConnect.IntegrationTests.dll (.NETCoreApp,Version=v8.0)
Test run for C:\Work\LankaConnect\tests\LankaConnect.Application.Tests\bin\Debug\net8.0\LankaConnect.Application.Tests.dll (.NETCoreApp,Version=v8.0)
VSTest version 17.11.1 (x64)

VSTest version 17.11.1 (x64)

Starting test execution, please wait...
Starting test execution, please wait...
A total of 1 test files matched the specified pattern.
A total of 1 test files matched the specified pattern.
[xUnit.net 00:00:00.00] xUnit.net VSTest Adapter v2.5.3.1+6b60a9e56a (64-bit .NET 8.0.23)
[xUnit.net 00:00:00.01] xUnit.net VSTest Adapter v2.5.3.1+6b60a9e56a (64-bit .NET 8.0.23)
[xUnit.net 00:00:00.28]   Discovering: LankaConnect.IntegrationTests
[xUnit.net 00:00:00.27]   Discovering: LankaConnect.Application.Tests
[xUnit.net 00:00:00.46]   Discovered:  LankaConnect.IntegrationTests
[xUnit.net 00:00:00.47]   Starting:    LankaConnect.IntegrationTests
[xUnit.net 00:00:00.83]   Discovered:  LankaConnect.Application.Tests
[xUnit.net 00:00:00.84]   Starting:    LankaConnect.Application.Tests
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.UpdateDetails_EnablingNewCategory_ShouldSucceed [18 ms]
  Passed LankaConnect.Application.Tests.Common.Models.ConfigurationImportResultTests.ConfigurationImportResult_Should_Exist_And_Be_Instantiable [18 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.FromCode_Should_Return_Success_For_Valid_ISO_Code [19 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.UpdateDetails_WithWhitespaceInCategoryAndDescription_ShouldTrim [< 1 ms]
  Passed LankaConnect.Application.Tests.Common.Models.ConfigurationImportResultTests.ConfigurationImportResult_Should_Have_Required_Properties [1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.LanguageCode_Should_Support_At_Least_15_Languages [2 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.FromCode_Should_Return_Failure_For_Invalid_Code [2 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.UpdateDetails_DisablingCategoryWithItems_ShouldFail [5 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.UpdateDetails_WithEmptyDescription_ShouldFail [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.LanguageCode_Should_Support_Inequality_For_Different_Codes [3 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.LanguageCode_Should_Map_Code_To_Correct_Name(code: "en", expectedNamePart: "English") [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.LanguageCode_Should_Map_Code_To_Correct_Name(code: "hi", expectedNamePart: "Hindi") [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.LanguageCode_Should_Map_Code_To_Correct_Name(code: "si", expectedNamePart: "Sinhala") [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.LanguageCode_Should_Map_Code_To_Correct_Name(code: "ta", expectedNamePart: "Tamil") [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.LanguageCode_All_Should_Include_Sri_Lankan_Primary_Languages [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.CreateSignUpList_WithPredefinedItems_ShouldSucceed [5 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.UpdateDetails_WithValidData_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.AddMultipleSignUpLists_ToEvent_ShouldSucceed [8 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.UpdateDetails_DisablingSuggestedCategoryWithItems_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.CancelCommitment_ShouldRaiseDomainEvent [8 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.GetUserCommitment_WhenExists_ShouldReturnCommitment [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.RemoveSignUpList_FromEvent_ShouldSucceed [6 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.RemoveSignUpList_WithCommitments_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.UpdateDetails_ShouldRaiseSignUpListUpdatedEvent [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.UserCommitsToPredefinedSignUp_WithValidItem_ShouldSucceed [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.UserCancelsCommitment_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.AddSignUpList_ToEvent_ShouldSucceed [2 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.AddCommitment_ShouldRaiseDomainEvent [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.CreateSignUpList_WithValidData_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.UpdateDetails_WithNoCategoryFlags_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.HasUserCommitted_WhenCommitted_ShouldReturnTrue [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.UpdateDetails_DisablingSuggestedCategoryWithItems_AnotherScenario_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.UserCommitsTwice_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.UserCancelsNonExistentCommitment_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.CreateSignUpList_WithEmptyCategory_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.GetUserCommitment_WhenNotExists_ShouldReturnNull [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.UserCommitsToOpenSignUp_WithValidData_ShouldSucceed [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.UpdateDetails_WithEmptyCategory_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.CreateSignUpList_WithEmptyPredefinedItems_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.SignUpManagementTests.UserCommitsToPredefinedSignUp_WithInvalidItem_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Communications.ValueObjects.VerificationTokenTests.IsValid_WithCorrectToken_ReturnsTrue [2 ms]
  Passed LankaConnect.Application.Tests.Communications.ValueObjects.VerificationTokenTests.Create_WithInvalidValidityHours_ReturnsFailure(validityHours: 0) [< 1 ms]
  Passed LankaConnect.Application.Tests.Communications.ValueObjects.VerificationTokenTests.Create_WithInvalidValidityHours_ReturnsFailure(validityHours: -1) [< 1 ms]
  Passed LankaConnect.Application.Tests.Communications.ValueObjects.VerificationTokenTests.Create_WithInvalidValidityHours_ReturnsFailure(validityHours: 169) [< 1 ms]
  Passed LankaConnect.Application.Tests.Communications.ValueObjects.VerificationTokenTests.FromExisting_WithInvalidToken_ReturnsFailure(tokenValue: "   ") [< 1 ms]
  Passed LankaConnect.Application.Tests.Communications.ValueObjects.VerificationTokenTests.FromExisting_WithInvalidToken_ReturnsFailure(tokenValue: null) [< 1 ms]
  Passed LankaConnect.Application.Tests.Communications.ValueObjects.VerificationTokenTests.FromExisting_WithInvalidToken_ReturnsFailure(tokenValue: "") [< 1 ms]
  Passed LankaConnect.Application.Tests.Communications.ValueObjects.VerificationTokenTests.Equality_WithSameTokenValue_ReturnsTrue [1 ms]
  Passed LankaConnect.Application.Tests.Communications.ValueObjects.VerificationTokenTests.IsExpired_WithPastExpiration_ReturnsTrue [113 ms]
  Passed LankaConnect.Application.Tests.Communications.ValueObjects.VerificationTokenTests.Create_GeneratesSecureRandomToken [1 ms]
  Passed LankaConnect.Application.Tests.Communications.ValueObjects.VerificationTokenTests.FromExisting_WithValidData_ReturnsSuccess [1 ms]
  Passed LankaConnect.Application.Tests.Communications.ValueObjects.VerificationTokenTests.IsValid_WithNullOrEmptyToken_ReturnsFalse(tokenToVerify: null) [< 1 ms]
  Passed LankaConnect.Application.Tests.Communications.ValueObjects.VerificationTokenTests.IsValid_WithNullOrEmptyToken_ReturnsFalse(tokenToVerify: "") [< 1 ms]
  Passed LankaConnect.Application.Tests.Communications.ValueObjects.VerificationTokenTests.Equality_WithDifferentTokenValues_ReturnsFalse [< 1 ms]
  Passed LankaConnect.Application.Tests.Communications.ValueObjects.VerificationTokenTests.FromExisting_WithExpiredDate_ReturnsFailure [< 1 ms]
  Passed LankaConnect.Application.Tests.Communications.ValueObjects.VerificationTokenTests.Create_WithCustomValidityHours_ReturnsSuccess [1 ms]
  Passed LankaConnect.Application.Tests.Communications.ValueObjects.VerificationTokenTests.Create_WithDefaultValidityHours_ReturnsSuccess [< 1 ms]
  Passed LankaConnect.Application.Tests.Communications.ValueObjects.VerificationTokenTests.IsValid_WithIncorrectToken_ReturnsFalse [< 1 ms]
  Passed LankaConnect.Application.Tests.Communications.ValueObjects.VerificationTokenTests.IsExpired_WithFutureExpiration_ReturnsFalse [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.LanguageCode_Should_Support_South_Asian_Languages [173 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.LanguageCode_Should_Have_Code_And_Name [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.FromCode_Should_Be_Case_Insensitive [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.LanguageCode_All_Should_Be_Ordered_Logically [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.LanguageCode_Should_Include_Tamil [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.FromCode_Should_Return_Failure_For_Null_Code [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.LanguageCode_Should_Include_Sinhala [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.FromCode_Should_Return_Failure_For_Empty_Code [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.LanguageCode_ToString_Should_Return_Name [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.LanguageCode_Should_Support_Equality_By_Code [3 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.ExternalLoginTests.TwoExternalLoginsWithSameValues_ShouldBeEqual [218 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.LanguageCode_Should_Provide_All_Supported_Languages [1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.LanguageCode_All_Should_Have_Unique_Codes [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.LanguageCode_Should_Be_Immutable [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.LanguageCode_Should_Include_English [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguageCodeTests.LanguageCode_Should_Have_Native_Name [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.ExternalLoginTests.TwoExternalLoginsWithDifferentExternalIds_ShouldNotBeEqual [2 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.ExternalLoginTests.Create_WithInvalidProviderEmail_ShouldReturnFailure(invalidEmail: "") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.ExternalLoginTests.Create_WithInvalidProviderEmail_ShouldReturnFailure(invalidEmail: "   ") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.ExternalLoginTests.Create_WithInvalidProviderEmail_ShouldReturnFailure(invalidEmail: null) [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.Enums.ProficiencyLevelTests.ProficiencyLevel_Should_Cast_From_Integer(value: 4, expected: Native) [2 ms]
  Passed LankaConnect.Domain.Tests.Users.Enums.ProficiencyLevelTests.ProficiencyLevel_Should_Cast_From_Integer(value: 2, expected: Intermediate) [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.Enums.ProficiencyLevelTests.ProficiencyLevel_Should_Cast_From_Integer(value: 1, expected: Basic) [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.ExternalLoginTests.Create_ShouldTrimWhitespace [1 ms]
  Passed LankaConnect.Domain.Tests.Users.Enums.ProficiencyLevelTests.ProficiencyLevel_Should_Cast_From_Integer(value: 3, expected: Advanced) [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.Enums.ProficiencyLevelTests.ProficiencyLevel_Should_Have_Correct_Integer_Value(level: Basic, expectedValue: 1) [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.Enums.ProficiencyLevelTests.ProficiencyLevel_Should_Have_Correct_Integer_Value(level: Intermediate, expectedValue: 2) [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.Enums.ProficiencyLevelTests.ProficiencyLevel_Should_Have_Correct_Integer_Value(level: Advanced, expectedValue: 3) [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.Enums.ProficiencyLevelTests.ProficiencyLevel_Should_Have_Correct_Integer_Value(level: Native, expectedValue: 4) [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.Enums.ProficiencyLevelTests.ProficiencyLevel_Should_Support_IsDefined [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.Enums.ProficiencyLevelTests.ProficiencyLevel_Equality_Should_Work [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.ExternalLoginTests.GetHashCode_ForSameExternalLogins_ShouldBeSame [4 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.ExternalLoginTests.ExternalLogin_ShouldBeImmutable [4 ms]
  Passed LankaConnect.Domain.Tests.Users.Enums.ProficiencyLevelTests.ProficiencyLevel_Basic_Should_Be_Lowest [5 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.ExternalLoginTests.Create_WithInvalidExternalProviderId_ShouldReturnFailure(invalidId: null) [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.ExternalLoginTests.Create_WithInvalidExternalProviderId_ShouldReturnFailure(invalidId: "") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.ExternalLoginTests.Create_WithInvalidExternalProviderId_ShouldReturnFailure(invalidId: "   ") [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.Enums.ProficiencyLevelTests.ProficiencyLevel_Should_Be_Ordered_By_Proficiency [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.ExternalLoginTests.TwoExternalLoginsWithDifferentProviders_ShouldNotBeEqual [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.Enums.ProficiencyLevelTests.ProficiencyLevel_Should_Include_Advanced [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.Enums.ProficiencyLevelTests.ProficiencyLevel_Should_Include_Native [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.ExternalLoginTests.GetHashCode_ForDifferentExternalLogins_ShouldBeDifferent [2 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.ExternalLoginTests.ToString_ShouldReturnMeaningfulString [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.ExternalLoginTests.Create_WithValidParameters_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventAddVideoTests.AddVideo_ShouldAssignSequentialDisplayOrders [5 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventAddVideoTests.AddVideo_WithEmptyVideoUrl_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventAddVideoTests.AddVideo_WithEmptyBlobName_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventAddVideoTests.AddVideo_WithValidVideo_ShouldSucceed [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventAddVideoTests.AddVideo_WithNullDuration_ShouldSucceed [1 ms]
  Passed LankaConnect.Domain.Tests.Users.Enums.ProficiencyLevelTests.ProficiencyLevel_Values_Should_Be_Sequential [14 ms]
  Passed LankaConnect.Domain.Tests.Users.Enums.ProficiencyLevelTests.ProficiencyLevel_Should_Include_Intermediate [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.Enums.ProficiencyLevelTests.ProficiencyLevel_ToString_Should_Return_Name [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.Enums.ProficiencyLevelTests.ProficiencyLevel_Should_Include_Basic [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventAddVideoTests.AddVideo_ShouldRaiseDomainEvent [4 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventAddVideoTests.AddVideo_WhenMaxVideosReached_ShouldFail [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.Enums.ProficiencyLevelTests.ProficiencyLevel_Should_Not_Have_Zero_Value [3 ms]
  Passed LankaConnect.Domain.Tests.Users.Enums.ProficiencyLevelTests.ProficiencyLevel_Should_Have_Four_Levels [1 ms]
  Passed LankaConnect.Domain.Tests.Users.Enums.ProficiencyLevelTests.ProficiencyLevel_Native_Should_Be_Highest [2 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.Constructor_InvalidRotation_ThrowsValidationException(invalidRotation: -10) [148 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.Constructor_InvalidRotation_ThrowsValidationException(invalidRotation: 400) [1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.Constructor_InvalidRotation_ThrowsValidationException(invalidRotation: -1) [1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.Constructor_InvalidRotation_ThrowsValidationException(invalidRotation: 361) [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.DefaultDetail_ReturnsCorrectDefaults [4 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.DefaultFeatured_ReturnsCorrectDefaults [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.Constructor_InvalidSizeHeight_ThrowsValidationException(invalidHeight: 0.04) [3 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.Constructor_InvalidSizeHeight_ThrowsValidationException(invalidHeight: -0.1) [1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.Constructor_InvalidSizeHeight_ThrowsValidationException(invalidHeight: 1.1) [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.Constructor_InvalidSizeHeight_ThrowsValidationException(invalidHeight: 0) [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.Constructor_InvalidPositionX_ThrowsDomainException(invalidPositionX: -1) [1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.Constructor_InvalidPositionX_ThrowsDomainException(invalidPositionX: 1.1) [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.Constructor_InvalidPositionX_ThrowsDomainException(invalidPositionX: -0.1) [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.Constructor_InvalidPositionX_ThrowsDomainException(invalidPositionX: 2) [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.Constructor_InvalidSizeWidth_ThrowsValidationException(invalidWidth: 0.04) [1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.Constructor_InvalidSizeWidth_ThrowsValidationException(invalidWidth: 0) [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.Constructor_InvalidSizeWidth_ThrowsValidationException(invalidWidth: 1.1) [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.Constructor_InvalidSizeWidth_ThrowsValidationException(invalidWidth: -0.1) [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.Constructor_InvalidPositionY_ThrowsValidationException(invalidPositionY: 1.1) [1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.Constructor_InvalidPositionY_ThrowsValidationException(invalidPositionY: -1) [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.Constructor_InvalidPositionY_ThrowsValidationException(invalidPositionY: 2) [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.Constructor_InvalidPositionY_ThrowsValidationException(invalidPositionY: -0.1) [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.ValueObjectEquality_SameValues_AreEqual [1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.ValueObjectEquality_DifferentValues_AreNotEqual [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.DefaultListing_ReturnsCorrectDefaults [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.Constructor_ValidValues_CreatesInstance [1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeLocationConfigTests.Constructor_BoundaryValues_AcceptsValidBoundaries [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_VeryLongName_ShouldSucceed [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_WithValidDataAllFields_ShouldSucceed [186 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_ValidEmailFormats_ShouldSucceed(validEmail: "test123@subdomain.example.com") [6 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_ValidEmailFormats_ShouldSucceed(validEmail: "user.name@example.com") [5 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_ValidEmailFormats_ShouldSucceed(validEmail: "user+tag@example.co.uk") [5 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_ValidEmailFormats_ShouldSucceed(validEmail: "DoNotReply@7689582e-73cc-4552-b2ff-8afd9d1a6814.az"···) [6 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_ValidEmailFormats_ShouldSucceed(validEmail: "test@example.com") [7 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_VariousInvalidEmails_ShouldFail(invalidEmail: "notanemail") [6 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_VariousInvalidEmails_ShouldFail(invalidEmail: "test@") [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_VariousInvalidEmails_ShouldFail(invalidEmail: "@example.com") [7 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_VariousInvalidEmails_ShouldFail(invalidEmail: "test@.com") [7 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_VariousInvalidEmails_ShouldFail(invalidEmail: "test @example.com") [10 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.HasOrganizerContact_WhenPublishedButNameIsNull_ShouldReturnFalse [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.HasOrganizerContact_WhenNeverSet_ShouldReturnFalse [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_CanUpdateExistingContact_ShouldSucceed [17 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_EmailCaseInsensitive_ShouldNormalize [7 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.NewEvent_OrganizerContactFieldsDefaultToNull_ShouldBeNull [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_PublishWithEmptyName_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_CanSwitchContactMethod_ShouldSucceed [6 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_PublishFalse_ShouldClearAllFields [21 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_PublishWithEmptyEmailAndPhone_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_InternationalPhoneNumber_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_PublishWithoutEmailAndPhone_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.HasOrganizerContact_WhenNotPublished_ShouldReturnFalse [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_TrimsWhitespace_ShouldSucceed [9 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_PublishWithoutName_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_WithEmailOnly_ShouldSucceed [10 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_InvalidEmailFormat_ShouldFail [9 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.SetOrganizerContactDetails_WithPhoneOnly_ShouldSucceed [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventOrganizerContactDetailsTests.HasOrganizerContact_WhenPublishedWithName_ShouldReturnTrue [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.AddVideoToEventCommandTests.Handle_WithValidVideo_ShouldSucceed [655 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.AddVideoToEventCommandTests.Handle_WithNonExistentEvent_ShouldReturnFailure [7 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.AddVideoToEventCommandTests.Handle_WhenMaxVideosReached_ShouldReturnFailure [18 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.AddVideoToEventCommandTests.Handle_WithEmptyVideo_ShouldReturnFailure [2 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.AddVideoToEventCommandTests.Handle_WhenDomainOperationFails_ShouldRollbackUploads [17 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UpdateCulturalInterestsCommandHandlerTests.Handle_Should_Fail_When_User_Not_Found [995 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateSignUpListCommandHandlerTests.Handle_WhenSignUpListNotFound_ShouldReturnFailure [250 ms]
  Passed LankaConnect.Application.Tests.Communications.Queries.GetEmailStatusQueryHandlerTests.Handle_WithInvalidUserId_ShouldReturnFailure [995 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateEventOrganizerContactCommandHandlerTests.Handle_UnpublishContact_ShouldClearAllDetails [996 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.SendEventNotificationCommandHandlerTests.Handle_UnauthorizedUser_ShouldReturnFailure [733 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateSignUpListCommandHandlerTests.Handle_DisablingCategoryWithItems_ShouldReturnFailure [5 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.SendPasswordResetCommandHandlerTests.Handle_WhenDatabaseThrowsException_ShouldReturnFailure [40 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.SendEventNotificationCommandHandlerTests.Handle_EventNotFound_ShouldReturnFailure [5 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateSignUpListCommandHandlerTests.Handle_WhenEventNotFound_ShouldReturnFailure [6 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateEventOrganizerContactCommandHandlerTests.Handle_PublishWithoutName_ShouldReturnFailure [11 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UpdateCulturalInterestsCommandHandlerTests.Handle_Should_Accept_Dynamic_EventCategory_Codes [16 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.SendEventNotificationCommandHandlerTests.Handle_DraftEvent_ShouldReturnFailure [9 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateSignUpListCommandHandlerTests.Handle_WithValidCommand_ShouldUpdateSignUpList [7 ms]
  Passed LankaConnect.Application.Tests.Communications.Queries.GetEmailStatusQueryHandlerTests.Handle_WithoutUserId_ShouldReturnResults [19 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UpdateCulturalInterestsCommandHandlerTests.Handle_Should_Accept_More_Than_10_Interests [4 ms]
  Passed LankaConnect.Application.Tests.Communications.Queries.GetEmailStatusQueryHandlerTests.Handle_WithInvalidDateRange_ShouldReturnFailure [1 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateSignUpListCommandHandlerTests.Handle_WithEmptyCategory_ShouldReturnFailure [4 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.SendPasswordResetCommandHandlerTests.Handle_WithForceResend_ShouldBypassRateLimiting [17 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UpdateCulturalInterestsCommandHandlerTests.Handle_Should_Update_Cultural_Interests_Successfully [7 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateEventOrganizerContactCommandHandlerTests.Handle_ValidRequest_WithAllContactDetails_ShouldSucceed [15 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.SendPasswordResetCommandHandlerTests.Handle_WithInvalidEmail_ShouldReturnFailure [3 ms]
  Passed LankaConnect.Application.Tests.Analytics.Commands.RecordEventViewCommandHandlerTests.Handle_WithValidAnonymousView_ShouldRecordViewWithoutUserId [1 s]
  Passed LankaConnect.Application.Tests.Users.Commands.UpdateCulturalInterestsCommandHandlerTests.Handle_Should_Clear_Interests_When_Empty_List [3 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateSignUpListCommandHandlerTests.Handle_EnablingNewCategory_ShouldSucceed [5 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.SendPasswordResetCommandHandlerTests.Handle_WhenRecentlySent_ShouldReturnWasRecentlySentFlag [5 ms]
  Passed LankaConnect.Application.Tests.Communications.Queries.GetEmailStatusQueryHandlerTests.Handle_WithCancellationToken_ShouldRespectCancellation [13 ms]
  Passed LankaConnect.Application.Tests.Analytics.Commands.RecordEventViewCommandHandlerTests.Handle_WithNullIpAddress_ShouldReturnFailure [6 ms]
  Passed LankaConnect.Application.Tests.Analytics.Commands.RecordEventViewCommandHandlerTests.Handle_WithEmptyEventId_ShouldReturnFailure [3 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.SendPasswordResetCommandHandlerTests.Handle_WithLockedAccount_ShouldReturnFailure [5 ms]
  Passed LankaConnect.Application.Tests.Businesses.Queries.SearchBusinessesQueryHandlerTests.Handle_WithValidPageSize_ShouldRespectPagination [999 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.SendPasswordResetCommandHandlerTests.Handle_ShouldSetTokenWithOneHourExpiry [9 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateEventOrganizerContactCommandHandlerTests.Handle_PublishWithInvalidEmail_ShouldReturnFailure [20 ms]
  Passed LankaConnect.Application.Tests.Businesses.Queries.SearchBusinessesQueryHandlerTests.Handle_WithNullSearchTerm_ShouldSearchAllBusinesses [11 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateEventOrganizerContactCommandHandlerTests.Handle_ValidRequest_WithOnlyPhone_ShouldSucceed [3 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Update_WithInvalidEmails_ShouldFail [23 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Create_WithMixedValidAndInvalidEmails_ShouldFail [22 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.SendEventNotificationCommandHandlerTests.Handle_WithValidCommand_ShouldSucceed [61 ms]
  Passed LankaConnect.Application.Tests.Businesses.Queries.SearchBusinessesQueryHandlerTests.Handle_WithValidQuery_ShouldReturnPaginatedBusinesses [27 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateEventOrganizerContactCommandHandlerTests.Handle_ValidRequest_WithOnlyEmail_ShouldSucceed [28 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.SendPasswordResetCommandHandlerTests.Handle_WithValidEmail_ShouldSendPasswordResetEmail [35 ms]
[xUnit.net 00:00:02.02]     LankaConnect.Application.Tests.Communications.Commands.SendPasswordResetCommandHandlerTests.Handle_WhenSetTokenFails_ShouldReturnFailure [SKIP]
[xUnit.net 00:00:02.02]       TODO: User.SetPasswordResetToken needs stricter validation to properly test failure scenario. Currently accepts all valid tokens.
  Skipped LankaConnect.Application.Tests.Communications.Commands.SendPasswordResetCommandHandlerTests.Handle_WhenSetTokenFails_ShouldReturnFailure [1 ms]
  Passed LankaConnect.Application.Tests.Businesses.Queries.SearchBusinessesQueryHandlerTests.Handle_WithEmptyResults_ShouldReturnEmptyPaginatedList [6 ms]
  Passed LankaConnect.Application.Tests.Analytics.Commands.RecordEventViewCommandHandlerTests.Handle_WithValidAuthenticatedView_ShouldCreateAnalyticsAndRecordView [49 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.SendPasswordResetCommandHandlerTests.Handle_WhenEmailServiceFails_ShouldReturnFailure [7 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Create_WithInvalidEmailFormats_ShouldFail(email: "invalid") [14 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.SendPasswordResetCommandHandlerTests.Handle_WithNonExistentUser_ShouldReturnSuccessWithUserNotFoundFlag [4 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateCulturalInterestsTests.UpdateCulturalInterests_Should_Raise_Domain_Event [1 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.SetPrimaryImageCommandTests.Handle_WhenImageIsAlreadyPrimary_ShouldReturnSuccessWithoutChanges [57 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateCulturalInterestsTests.UpdateCulturalInterests_Should_Allow_Empty_Collection [< 1 ms]
  Passed LankaConnect.Application.Tests.Communications.Queries.GetEmailStatusQueryHandlerTests.Handle_WithValidQuery_ShouldReturnEmailStatus [64 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateCulturalInterestsTests.UpdateCulturalInterests_Should_Not_Raise_Event_When_Clearing_Interests [< 1 ms]
  Passed LankaConnect.Application.Tests.Analytics.Commands.RecordEventViewCommandHandlerTests.Handle_WithDuplicateViewInWindow_ShouldNotCountView [10 ms]
  Passed LankaConnect.Application.Tests.Communications.Queries.GetEmailStatusQueryHandlerTests.Handle_WithPageSizeTooLarge_ShouldReturnFailure [1 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Create_WithInvalidEmailFormats_ShouldFail(email: "@domain.com") [9 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateCulturalInterestsTests.UpdateCulturalInterests_Should_Replace_Existing_Interests [2 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateCulturalInterestsTests.UpdateCulturalInterests_Should_Allow_Exactly_10_Interests [< 1 ms]
  Passed LankaConnect.Application.Tests.Communications.Queries.GetEmailStatusQueryHandlerTests.Handle_WithInvalidPageNumber_ShouldReturnFailure [1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateCulturalInterestsTests.UpdateCulturalInterests_Event_Should_Contain_User_Id_And_Interests [1 ms]
  Passed LankaConnect.Application.Tests.Communications.Queries.GetEmailStatusQueryHandlerTests.Handle_WithInvalidPageSize_ShouldReturnFailure [1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateCulturalInterestsTests.UpdateCulturalInterests_Should_Accept_More_Than_10_Interests [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateCulturalInterestsTests.UpdateCulturalInterests_Should_Remove_Duplicates [< 1 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Create_WithInvalidEmailFormats_ShouldFail(email: "user@") [4 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateCulturalInterestsTests.UpdateCulturalInterests_Should_Add_Interests_Successfully [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Queries.GetLinkedProvidersQueryHandlerTests.Handle_ShouldIncludeAllProviderDetails [28 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.SetPrimaryImageCommandTests.Handle_WithValidRequest_ShouldSetImageAsPrimarySuccessfully [8 ms]
  Passed LankaConnect.Application.Tests.Analytics.Commands.RecordEventViewCommandHandlerTests.Handle_WhenRecordingView_ShouldRaiseDomainEvent [8 ms]
  Passed LankaConnect.Application.Tests.Users.Queries.GetLinkedProvidersQueryHandlerTests.Handle_WhenUserNotFound_ShouldReturnFailure [7 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationTests.WithCoordinates_WhenNoCoordinatesExist_ShouldAddCoordinates [10 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.SetPrimaryImageCommandTests.Handle_WithEventWithNoImages_ShouldReturnFailure [8 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationTests.Equality_DifferentCoordinates_ShouldNotBeEqual [2 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.AddServiceCommandHandlerTests.Handle_WithVariousUsRestaurantServices_ShouldAddSuccessfully(serviceName: "Private Dining", description: "Exclusive private dining experience for special oc"···, price: 75) [30 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationTests.Create_WithValidAddressAndCoordinates_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationTests.HasCoordinates_WhenCoordinatesDoNotExist_ShouldReturnFalse [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationTests.HasCoordinates_WhenCoordinatesExist_ShouldReturnTrue [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationTests.Create_WithValidAddress_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationTests.Equality_DifferentAddresses_ShouldNotBeEqual [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationTests.WithCoordinates_WithNullCoordinates_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.AddServiceCommandHandlerTests.Handle_WithVariousUsRestaurantServices_ShouldAddSuccessfully(serviceName: "Lunch Special", description: "Daily lunch special with rice, curry, and beverage", price: 12.99) [4 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.SetPrimaryImageCommandTests.Handle_WithNonExistentImage_ShouldReturnFailure [7 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationTests.ToString_WithoutCoordinates_ShouldShowAddressOnly [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationTests.Create_WithNullAddress_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationTests.EventLocation_ShouldBeImmutable [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationTests.Equality_SameAddressAndCoordinates_ShouldBeEqual [< 1 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.AddServiceCommandHandlerTests.Handle_WithVariousUsRestaurantServices_ShouldAddSuccessfully(serviceName: "Takeout Service", description: "Quick takeout for busy professionals", price: 15.5) [2 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationTests.WithCoordinates_WhenCoordinatesAlreadyExist_ShouldUpdateCoordinates [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationTests.Equality_OneWithCoordinatesOneWithout_ShouldNotBeEqual [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Queries.GetLinkedProvidersQueryHandlerTests.Handle_WhenUserHasLinkedProviders_ShouldReturnAllProviders [12 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationTests.ToString_WithCoordinates_ShouldIncludeAddressAndCoordinates [< 1 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.AddServiceCommandHandlerTests.Handle_WithVariousUsRestaurantServices_ShouldAddSuccessfully(serviceName: "Catering Package", description: "Full-service catering for events up to 50 people", price: 450) [2 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Create_WithInvalidEmailFormats_ShouldFail(email: "user domain@test.com") [22 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.SetPrimaryImageCommandTests.Handle_WithSingleImage_ShouldSetItAsPrimary [7 ms]
  Passed LankaConnect.Application.Tests.Users.Queries.GetLinkedProvidersQueryHandlerTests.Handle_WhenUserHasNoLinkedProviders_ShouldReturnEmptyList [5 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Create_WithInvalidEmailFormats_ShouldFail(email: "user@domain") [5 ms]
  Passed LankaConnect.Application.Tests.Analytics.Commands.RecordEventViewCommandHandlerTests.Handle_WithExistingAnalytics_ShouldIncrementViewCount [26 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Create_WithEmptyEmails_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Analytics.Commands.RecordEventViewCommandHandlerTests.Handle_WithEmptyIpAddress_ShouldReturnFailure [4 ms]
  Passed LankaConnect.Application.Tests.Users.Queries.GetLinkedProvidersQueryHandlerTests.Handle_ShouldIncludeProviderDisplayNames [5 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.GetEmailList_ShouldReturnReadOnlyList [6 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Create_WithEmptyName_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateEventOrganizerContactCommandHandlerTests.Handle_UpdateExistingContact_ShouldOverwritePreviousData [59 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.SetPrimaryImageCommandTests.Handle_WhenSettingNewPrimary_ShouldUnmarkPreviousPrimary [13 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.AddServiceCommandHandlerTests.Handle_WithInvalidPrice_ShouldThrowInvalidOperationException(invalidPrice: -0.01) [18 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateEventOrganizerContactCommandHandlerTests.Handle_PublishWithoutContactMethod_ShouldReturnFailure [5 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.AddServiceCommandHandlerTests.Handle_WithInvalidPrice_ShouldThrowInvalidOperationException(invalidPrice: -1) [2 ms]
  Passed LankaConnect.Application.Tests.Events.Services.GeoLocationServiceTests.CalculateDistanceKm_SmallDistance_ReturnsAccurateResult [11 ms]
  Passed LankaConnect.Application.Tests.Events.Services.GeoLocationServiceTests.CalculateDistanceKm_NewYorkToLondon_ReturnsAccurateDistance [< 1 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.AddServiceCommandHandlerTests.Handle_WithInvalidPrice_ShouldThrowInvalidOperationException(invalidPrice: -100) [1 ms]
  Passed LankaConnect.Application.Tests.Events.Services.GeoLocationServiceTests.CalculateDistanceKm_SamePoint_ReturnsZero [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Services.GeoLocationServiceTests.CalculateDistanceKm_NorthToSouth_ReturnsPositiveDistance [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Services.GeoLocationServiceTests.CalculateDistanceKm_IsSymmetric [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Services.GeoLocationServiceTests.CalculateDistanceKm_ValidCoordinates_ReturnsPositiveNonZeroDistance(lat1: 40.712800000000001, lon1: -74.006, lat2: 37.774900000000002, lon2: -122.4194) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Services.GeoLocationServiceTests.CalculateDistanceKm_ValidCoordinates_ReturnsPositiveNonZeroDistance(lat1: 34.052199999999999, lon1: -118.2437, lat2: 34.053199999999997, lon2: -118.2437) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Services.GeoLocationServiceTests.CalculateDistanceKm_ValidCoordinates_ReturnsPositiveNonZeroDistance(lat1: 0, lon1: 0, lat2: 0, lon2: 1) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Services.GeoLocationServiceTests.CalculateDistanceKm_ValidCoordinates_ReturnsPositiveNonZeroDistance(lat1: 6.9271000000000003, lon1: 79.861199999999997, lat2: 7.2906000000000004, lon2: 80.633700000000005) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.SetPrimaryImageCommandTests.Handle_WithNonExistentEvent_ShouldReturnFailure [10 ms]
  Passed LankaConnect.Application.Tests.Events.Services.GeoLocationServiceTests.CalculateDistanceKm_EquatorPoints_CalculatesCorrectly [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Services.GeoLocationServiceTests.CalculateDistanceKm_ColombToKandy_ReturnsAccurateDistance [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Services.GeoLocationServiceTests.CalculateDistanceKm_CrossingDateLine_CalculatesCorrectly [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Services.GeoLocationServiceTests.CalculateDistanceKm_PolarRegions_HandlesHighLatitudes [< 1 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.AddServiceCommandHandlerTests.Handle_WithInactiveService_ShouldAddInactiveService [5 ms]
  Passed LankaConnect.Application.Tests.Events.Services.GeoLocationServiceTests.CalculateDistanceKm_LosAngelesToSanFrancisco_ReturnsAccurateDistance [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateEventOrganizerContactCommandHandlerTests.Handle_EventNotFound_ShouldReturnFailure [12 ms]
  Passed LankaConnect.Application.Tests.Users.Queries.GetLinkedProvidersQueryHandlerTests.Handle_WithMultipleProviders_ShouldOrderByProvider [22 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.AttendeeDetailsTests.Create_WithInvalidAgeCategory_ShouldFail(invalidCategory: 0) [1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.AttendeeDetailsTests.Create_WithInvalidAgeCategory_ShouldFail(invalidCategory: 99) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.AttendeeDetailsTests.Create_ShouldTrimWhitespaceFromName [< 1 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.AddServiceCommandHandlerTests.Handle_WithInvalidServiceName_ShouldReturnFailureResult(invalidName: "   ") [7 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.AttendeeDetailsTests.ValueObjectEquality_WithSameValues_ShouldBeEqual(name: "Jane Smith", ageCategory: Child) [2 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.AttendeeDetailsTests.ValueObjectEquality_WithSameValues_ShouldBeEqual(name: "John Doe", ageCategory: Adult) [< 1 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.AddServiceCommandHandlerTests.Handle_WithInvalidServiceName_ShouldReturnFailureResult(invalidName: "") [2 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventWaitingListTests.RemoveFromWaitingList_WhenUserNotOnWaitingList_ShouldFail [11 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.AttendeeDetailsTests.Create_WithInvalidName_ShouldFail(invalidName: "   ") [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventWaitingListTests.IsAtCapacity_WhenRegistrationsEqualCapacity_ShouldReturnTrue [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.AttendeeDetailsTests.Create_WithInvalidName_ShouldFail(invalidName: null) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.AttendeeDetailsTests.Create_WithInvalidName_ShouldFail(invalidName: "") [< 1 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.AddServiceCommandHandlerTests.Handle_WithInvalidServiceName_ShouldReturnFailureResult(invalidName: null) [2 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventWaitingListTests.AddToWaitingList_WhenUserAlreadyRegistered_ShouldFail [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventWaitingListTests.AddToWaitingList_WhenEventHasCapacity_ShouldFail [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.AttendeeDetailsTests.Create_WithValidAgeCategories_ShouldSucceed(name: "Jane Smith", ageCategory: Child) [5 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.AttendeeDetailsTests.Create_WithValidAgeCategories_ShouldSucceed(name: "Alice Williams", ageCategory: Child) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.AttendeeDetailsTests.Create_WithValidAgeCategories_ShouldSucceed(name: "John Doe", ageCategory: Adult) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.AttendeeDetailsTests.Create_WithValidAgeCategories_ShouldSucceed(name: "Bob Johnson", ageCategory: Adult) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.AttendeeDetailsTests.Create_WithValidNameAndAgeCategory_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.AttendeeDetailsTests.ValueObjectEquality_WithDifferentAgeCategories_ShouldNotBeEqual [< 1 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.AddServiceCommandHandlerTests.Handle_WithUsRestaurantService_ShouldAddServiceWithUsdPricing [6 ms]
  Passed LankaConnect.Domain.Tests.Analytics.EventAnalyticsTests.UpdateUniqueViewers_WithNegativeValue_ShouldFail [17 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.AttendeeDetailsTests.ValueObjectEquality_WithDifferentNames_ShouldNotBeEqual [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.AttendeeDetailsTests.ToString_ShouldReturnFormattedString [3 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.CulturalInterestTests.FromCode_Should_Accept_Any_Case_For_Dynamic_Codes [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.CulturalInterestTests.CulturalInterest_All_Should_Have_Unique_Codes [1 ms]
  Passed LankaConnect.Application.Tests.Users.EventHandlers.MemberVerificationRequestedEventHandlerTests.Handle_ExceptionDuringProcessing_ShouldNotThrow [56 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.CulturalInterestTests.FromCode_Should_Return_Success_For_Valid_Code [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.CulturalInterestTests.CulturalInterest_Should_Support_Equality_By_Code [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.CulturalInterestTests.CulturalInterest_Should_Support_Inequality_For_Different_Codes [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.CulturalInterestTests.FromCode_Should_Return_Failure_For_Null_Code [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.CulturalInterestTests.CulturalInterest_ToString_Should_Return_Name [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.CulturalInterestTests.FromCode_Should_Accept_Dynamic_EventCategory_Codes [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.CulturalInterestTests.CulturalInterest_Should_Include_Christian_Festivals [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.CulturalInterestTests.CulturalInterest_Should_Map_Code_To_Correct_Name(code: "VESAK", expectedNamePart: "Vesak") [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.CulturalInterestTests.CulturalInterest_Should_Map_Code_To_Correct_Name(code: "SL_CUISINE", expectedNamePart: "Sri Lankan Cuisine") [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.CulturalInterestTests.CulturalInterest_Should_Map_Code_To_Correct_Name(code: "CRICKET", expectedNamePart: "Cricket") [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.CulturalInterestTests.CulturalInterest_Should_Include_Hindu_Festivals [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.CulturalInterestTests.CulturalInterest_Should_Have_Code_And_Name [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.CulturalInterestTests.FromCode_Should_Return_Failure_For_Empty_Code [< 1 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Update_WithValidData_ShouldSucceed [34 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.CulturalInterestTests.CulturalInterest_Should_Provide_All_Predefined_Interests [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.CulturalInterestTests.CulturalInterest_Should_Include_Buddhist_Festivals [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.CulturalInterestTests.CulturalInterest_All_Should_Include_Essential_Categories [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.CulturalInterestTests.CulturalInterest_Should_Include_Islamic_Festivals [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.CulturalInterestTests.CulturalInterest_Should_Be_Immutable [< 1 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Deactivate_ShouldSetIsActiveToFalse [6 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Create_WithValidEmailFormats_ShouldSucceed(email: "user_name123@sub.domain.com") [5 ms]
  Passed LankaConnect.Application.Tests.Users.EventHandlers.MemberVerificationRequestedEventHandlerTests.Handle_WithValidEvent_ShouldSendEmailWithUserName [60 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Create_WithValidEmailFormats_ShouldSucceed(email: "test@example.com") [44 ms]
  Passed LankaConnect.Domain.Tests.Analytics.EventAnalyticsTests.RecordView_WithNullIpAddress_ShouldFail [69 ms]
  Passed LankaConnect.Domain.Tests.Analytics.EventAnalyticsTests.UpdateRegistrationCount_ShouldUpdateCount [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.RegistrationUpdateDetailsTests.UpdateDetails_WithMoreThan10Attendees_ShouldFail [56 ms]
  Passed LankaConnect.Domain.Tests.Analytics.EventAnalyticsTests.RecordView_WithEmptyIpAddress_ShouldFail [1 ms]
  Passed LankaConnect.Domain.Tests.Analytics.EventAnalyticsTests.UpdateUniqueViewers_ShouldUpdateCount [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.RegistrationUpdateDetailsTests.UpdateDetails_WithNullAttendeeList_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.EventHandlers.MemberVerificationRequestedEventHandlerTests.Handle_EmailServiceFailure_ShouldNotThrow [5 ms]
  Passed LankaConnect.Domain.Tests.Analytics.EventAnalyticsTests.RecordView_MultipleTimes_ShouldIncrementCount [< 1 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.AddServiceCommandHandlerTests.Handle_WithValidServiceCommand_ShouldAddServiceSuccessfully [74 ms]
  Passed LankaConnect.Domain.Tests.Analytics.EventAnalyticsTests.Create_WithEmptyEventId_ShouldFail [2 ms]
  Passed LankaConnect.Domain.Tests.Analytics.EventAnalyticsTests.ConversionRate_WithNoViews_ShouldBeZero [< 1 ms]
  Passed LankaConnect.Domain.Tests.Analytics.EventAnalyticsTests.ConversionRate_ShouldCalculateCorrectly [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.RegistrationUpdateDetailsTests.UpdateDetails_WithSameAttendeeCount_OnPaidRegistration_ShouldSucceed [5 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.RegistrationUpdateDetailsTests.UpdateDetails_OnPaidRegistration_RemovingAttendees_ShouldFail [1 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Create_WithValidEmailFormats_ShouldSucceed(email: "user+tag@example.co.uk") [10 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.AddServiceCommandHandlerTests.Handle_WithFreeService_ShouldAddSuccessfully [6 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.RegistrationUpdateDetailsTests.UpdateDetails_OnFreeEvent_WithMoreAttendees_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.RegistrationUpdateDetailsTests.UpdateDetails_WithNullContact_ShouldFail [1 ms]
  Passed LankaConnect.Application.Tests.Users.EventHandlers.MemberVerificationRequestedEventHandlerTests.Handle_WithFirstNameOnly_ShouldUseFirstNameAsUserName [10 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.RegistrationUpdateDetailsTests.UpdateDetails_OnRefundedRegistration_ShouldFail [1 ms]
  Passed LankaConnect.Domain.Tests.Analytics.EventAnalyticsTests.UpdateRegistrationCount_WithNegativeValue_ShouldFail [8 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.RegistrationUpdateDetailsTests.UpdateDetails_OnCancelledRegistration_ShouldFail [1 ms]
  Passed LankaConnect.Domain.Tests.Analytics.EventAnalyticsTests.RecordView_ShouldIncrementTotalViews [< 1 ms]
  Passed LankaConnect.Domain.Tests.Analytics.EventAnalyticsTests.ConversionRate_With100PercentConversion_ShouldBe100 [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.RegistrationUpdateDetailsTests.UpdateDetails_OnPaidRegistration_AddingAttendees_ShouldFail [2 ms]
  Passed LankaConnect.Domain.Tests.Analytics.EventAnalyticsTests.RecordView_ShouldRaiseDomainEvent [2 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.RegistrationUpdateDetailsTests.UpdateDetails_With10Attendees_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Domain.Tests.Analytics.EventAnalyticsTests.RecordView_WithNullUserId_ShouldAcceptAnonymousView [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.RegistrationUpdateDetailsTests.UpdateDetails_WithValidAttendeesAndContact_ShouldSucceed [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.RegistrationUpdateDetailsTests.UpdateDetails_ShouldUpdateTimestamp [< 1 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Create_WithValidEmailFormats_ShouldSucceed(email: "user.name@domain.org") [11 ms]
  Passed LankaConnect.Domain.Tests.Analytics.EventAnalyticsTests.Create_ShouldInitializeWithZeroCounts [1 ms]
  Passed LankaConnect.Application.Tests.Users.EventHandlers.MemberVerificationRequestedEventHandlerTests.Handle_WithNoNames_ShouldUseFriendAsUserName [8 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.RegistrationUpdateDetailsTests.UpdateDetails_ShouldUpdateContactEmail [< 1 ms]
  Passed LankaConnect.Domain.Tests.Analytics.EventAnalyticsTests.ConversionRate_WithHalfRegistrations_ShouldBeFiftyPercent [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.RegistrationUpdateDetailsTests.UpdateDetails_WithEmptyAttendeeList_ShouldFail [1 ms]
  Passed LankaConnect.Application.Tests.Common.Models.EngineLifecycleOperationTests.EngineLifecycleOperation_Should_Exist_And_Be_Instantiable [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.RegistrationUpdateDetailsTests.UpdateDetails_OnFreeEvent_WithFewerAttendees_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.RegistrationUpdateDetailsTests.UpdateDetails_OnPendingRegistration_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Common.Models.EngineLifecycleOperationTests.EngineLifecycleOperation_Should_Have_Required_Properties [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.RegistrationUpdateDetailsTests.UpdateDetails_ShouldUpdateContactPhone [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.FederatedProviderTests.ToIdpClaimValue_ShouldReturnCorrectClaimValue(provider: Apple, expectedClaim: "appleid.apple.com") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.FederatedProviderTests.ToIdpClaimValue_ShouldReturnCorrectClaimValue(provider: Facebook, expectedClaim: "facebook.com") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.FederatedProviderTests.ToIdpClaimValue_ShouldReturnCorrectClaimValue(provider: Google, expectedClaim: "google.com") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.FederatedProviderTests.ToIdpClaimValue_ShouldReturnCorrectClaimValue(provider: Microsoft, expectedClaim: "login.microsoftonline.com") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.FederatedProviderTests.FromIdpClaimValue_WithValidClaim_ShouldReturnCorrectProvider(idpClaim: "facebook.com", expectedProvider: Facebook) [1 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Create_WithInvalidEmail_ShouldFail [6 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.FederatedProviderTests.FromIdpClaimValue_WithValidClaim_ShouldReturnCorrectProvider(idpClaim: "appleid.apple.com", expectedProvider: Apple) [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.FederatedProviderTests.FromIdpClaimValue_WithValidClaim_ShouldReturnCorrectProvider(idpClaim: "login.microsoftonline.com", expectedProvider: Microsoft) [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.FederatedProviderTests.FromIdpClaimValue_WithValidClaim_ShouldReturnCorrectProvider(idpClaim: "google.com", expectedProvider: Google) [< 1 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Create_WithOnlyCommasAndWhitespace_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.FederatedProviderTests.ToDisplayName_ShouldReturnCorrectName(provider: Facebook, expectedName: "Facebook") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.FederatedProviderTests.ToDisplayName_ShouldReturnCorrectName(provider: Microsoft, expectedName: "Microsoft") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.FederatedProviderTests.ToDisplayName_ShouldReturnCorrectName(provider: Google, expectedName: "Google") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.FederatedProviderTests.ToDisplayName_ShouldReturnCorrectName(provider: Apple, expectedName: "Apple") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.FederatedProviderTests.FromIdpClaimValue_WithInvalidClaim_ShouldReturnFailure(invalidClaim: null) [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.FederatedProviderTests.FromIdpClaimValue_WithInvalidClaim_ShouldReturnFailure(invalidClaim: "   ") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.FederatedProviderTests.FromIdpClaimValue_WithInvalidClaim_ShouldReturnFailure(invalidClaim: "invalid.provider.com") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.FederatedProviderTests.FromIdpClaimValue_WithInvalidClaim_ShouldReturnFailure(invalidClaim: "") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.FederatedProviderTests.Microsoft_ShouldBeDefaultProvider [< 1 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Create_WithNullDescription_ShouldSucceed [7 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Create_WithWhitespaceName_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.FederatedProviderTests.FederatedProvider_ShouldHave_FourProviders [10 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.FederatedProviderTests.FromIdpClaimValue_ShouldBeCaseInsensitive [< 1 ms]
  Passed LankaConnect.Application.Tests.Common.Models.Performance.PerformanceAlertTests.PerformanceAlert_WithInvalidAlertType_ShouldThrowException(invalidAlertType: null) [20 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithValidEmailFormats_ShouldSucceed(validEmail: "user_name@test-domain.com") [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithValidEmailFormats_ShouldSucceed(validEmail: "test@example.com") [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithValidEmailFormats_ShouldSucceed(validEmail: "user.name@domain.co.uk") [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithValidEmailFormats_ShouldSucceed(validEmail: "test+tag@example.com") [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithValidPhoneFormats_ShouldSucceed(validPhone: "5551234567") [< 1 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.AddServiceCommandHandlerTests.Handle_WithNonExistentBusiness_ShouldThrowBusinessNotFoundException [33 ms]
  Passed LankaConnect.Application.Tests.Common.Models.Performance.PerformanceAlertTests.PerformanceAlert_WithInvalidAlertType_ShouldThrowException(invalidAlertType: "") [1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithValidPhoneFormats_ShouldSucceed(validPhone: "+1 (555) 123-4567") [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithValidPhoneFormats_ShouldSucceed(validPhone: "+1-555-123-4567") [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithValidPhoneFormats_ShouldSucceed(validPhone: "+44 20 1234 5678") [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithValidPhoneFormats_ShouldSucceed(validPhone: "(555) 123-4567") [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithValidPhoneFormats_ShouldSucceed(validPhone: "555-123-4567") [< 1 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Create_ShouldNormalizeEmailsToLowerCase [6 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithInvalidPhoneNumber_ShouldFail(invalidPhone: "   ") [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithInvalidPhoneNumber_ShouldFail(invalidPhone: "") [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithInvalidPhoneNumber_ShouldFail(invalidPhone: null) [< 1 ms]
  Passed LankaConnect.Application.Tests.Common.Models.Performance.PerformanceAlertTests.PerformanceAlert_Creation_ShouldInitializeWithValidProperties [1 ms]
  Passed LankaConnect.Application.Tests.Common.Models.Performance.PerformanceAlertTests.PerformanceAlert_WithCulturalContext_ShouldStoreCulturalInformation [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.ValueObjectEquality_WithDifferentEmails_ShouldNotBeEqual [1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithInvalidEmailFormat_ShouldFail(invalidEmail: "missing@domain") [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithInvalidEmailFormat_ShouldFail(invalidEmail: "notanemail") [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithInvalidEmailFormat_ShouldFail(invalidEmail: "@example.com") [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithInvalidEmailFormat_ShouldFail(invalidEmail: "test @example.com") [< 1 ms]
  Passed LankaConnect.Application.Tests.Common.Models.ScalingPredictionResultTests.ScalingPredictionResult_Should_Have_Required_Properties [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithInvalidEmailFormat_ShouldFail(invalidEmail: "test@") [< 1 ms]
  Passed LankaConnect.Application.Tests.Common.Models.ScalingPredictionResultTests.ScalingPredictionResult_Should_Exist_And_Be_Instantiable [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithInvalidEmail_ShouldFail(invalidEmail: "") [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithInvalidEmail_ShouldFail(invalidEmail: null) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithInvalidEmail_ShouldFail(invalidEmail: "   ") [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.ToString_WithoutAddress_ShouldReturnFormattedStringWithoutAddress [1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.ValueObjectEquality_WithNullAndEmptyAddress_ShouldBeEqual [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithEmptyAddressAfterTrim_ShouldStoreAsNull [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_ShouldTrimWhitespaceFromAllFields [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.ValueObjectEquality_WithSameValues_ShouldBeEqual [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithoutAddress_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.Create_WithAllValidFields_ShouldSucceed [< 1 ms]
[CancelRegistration] EventId: 3a45e82c-2a61-43e7-a557-d2741cd0acc1, UserId: 3c261186-c8a0-449c-a388-1221748e7cc7
[CancelRegistration] Total registrations count: 5
[CancelRegistration] Registration: UserId=3c261186-c8a0-449c-a388-1221748e7cc7, Status=Confirmed, Match=True
[CancelRegistration] Registration: UserId=d6aad837-0def-47de-8b9c-25552a540ea5, Status=Confirmed, Match=False
[CancelRegistration] Registration: UserId=d286829b-a93d-4f17-a2e9-fc2cc6112ba2, Status=Confirmed, Match=False
[CancelRegistration] Registration: UserId=daf40eb8-4d16-4556-b1c6-4675f24d3ca8, Status=Confirmed, Match=False
[CancelRegistration] Registration: UserId=bc536820-92b3-42ab-b98b-a76e1c5305d1, Status=Confirmed, Match=False
[CancelRegistration] Found registration: True
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RegistrationContactTests.ToString_WithAllFields_ShouldReturnFormattedString [< 1 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Create_WithValidData_ShouldSucceed [16 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Create_WithExtraWhitespace_ShouldTrim [6 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Update_WithEmptyName_ShouldFail [5 ms]
  Passed LankaConnect.Application.Tests.Domain.Communications.EmailGroupTests.Create_WithDuplicateEmails_ShouldDeduplicate [5 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventWaitingListTests.CancelRegistration_WhenWaitingListHasUsers_ShouldPromoteNextInLine [176 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventWaitingListTests.PromoteFromWaitingList_WhenNoCapacity_ShouldFail [1 ms]
[CancelRegistration] EventId: 399b7c6e-ee39-48c3-b648-adddc1f42812, UserId: d1bfd789-83a3-4c06-8482-8d589ed10e44
[CancelRegistration] Total registrations count: 5
[CancelRegistration] Registration: UserId=d1bfd789-83a3-4c06-8482-8d589ed10e44, Status=Confirmed, Match=True
[CancelRegistration] Registration: UserId=b54154f1-2864-4ad5-8720-d793517d1eb6, Status=Confirmed, Match=False
[CancelRegistration] Registration: UserId=bf318e66-bba5-487c-91b3-5f96eace6abc, Status=Confirmed, Match=False
[CancelRegistration] Registration: UserId=c0a35366-c45e-4775-959e-afc540b1cbb2, Status=Confirmed, Match=False
[CancelRegistration] Registration: UserId=9fd12368-0fec-4e6a-9a2e-5d25e06819a4, Status=Confirmed, Match=False
[CancelRegistration] Found registration: True
  Passed LankaConnect.Application.Tests.Events.Domain.EventWaitingListTests.AddToWaitingList_WhenEventAtCapacity_ShouldSucceed [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventWaitingListTests.RemoveFromWaitingList_WhenUserOnWaitingList_ShouldSucceed [2 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventWaitingListTests.AddToWaitingList_MultipleUsers_ShouldMaintainCorrectPositions [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventWaitingListTests.RemoveFromWaitingList_ShouldResequencePositions [2 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventWaitingListTests.AddToWaitingList_WhenUserAlreadyOnWaitingList_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Queries.SearchEventsQueryHandlerTests.Handle_NoResults_ReturnsEmptyPagedResult [30 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventWaitingListTests.IsAtCapacity_WhenRegistrationsLessThanCapacity_ShouldReturnFalse [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventWaitingListTests.GetWaitingListPosition_WhenUserOnWaitingList_ShouldReturnPosition [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventWaitingListTests.GetWaitingListPosition_WhenUserNotOnWaitingList_ShouldReturnZero [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventWaitingListTests.PromoteFromWaitingList_WhenUserNotified_ShouldMoveToConfirmed [4 ms]
  Passed LankaConnect.Application.Tests.Events.Queries.SearchEventsQueryHandlerTests.Handle_TotalCountExceedsPageSize_CalculatesCorrectTotalPages [14 ms]
  Passed LankaConnect.Application.Tests.Events.Queries.SearchEventsQueryHandlerTests.Handle_ValidSearchTerm_ReturnsMatchingEvents [11 ms]
  Passed LankaConnect.Application.Tests.Events.Queries.SearchEventsQueryHandlerTests.Handle_WithCategoryFilter_PassesFilterToRepository [12 ms]
  Passed LankaConnect.Application.Tests.Events.Queries.SearchEventsQueryHandlerTests.Handle_WithStartDateFromFilter_PassesFilterToRepository [14 ms]
  Passed LankaConnect.Application.Tests.Events.Queries.SearchEventsQueryHandlerTests.Handle_Page2_CalculatesCorrectOffsetAndLimit [8 ms]
  Passed LankaConnect.Application.Tests.Events.Queries.SearchEventsQueryHandlerTests.Handle_WithIsFreeOnlyFilter_PassesFilterToRepository [12 ms]
  Passed LankaConnect.Application.Tests.Events.Queries.SearchEventsQueryHandlerTests.Handle_MultipleFilters_PassesAllFiltersToRepository [16 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateLocationTests.NewUser_ShouldHaveNullLocation [1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateLocationTests.UpdateLocation_WithValidLocation_ShouldSucceed [3 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateLocationTests.UpdateLocation_WithNullLocation_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateLocationTests.UpdateLocation_WithValidLocation_ShouldRaiseDomainEvent [2 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateLocationTests.UpdateLocation_WithNullLocation_ShouldNotRaiseDomainEvent [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateLocationTests.UpdateLocation_ShouldUpdateExistingLocation [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateLocationTests.UpdateLocation_ShouldMarkEntityAsUpdated [21 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateLocationTests.UpdateLocation_WithInternationalLocation_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateLocationTests.UpdateLocation_MultipleUpdates_ShouldRaiseMultipleEvents [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventVideoTests.Create_WithEmptyBlobName_ShouldThrow [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventVideoTests.Create_WithZeroDisplayOrder_ShouldThrow [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventVideoTests.Create_WithEmptyThumbnailUrl_ShouldThrow [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventVideoTests.Create_WithNullVideoUrl_ShouldThrow [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventVideoTests.Create_WithEmptyFormat_ShouldThrow [13 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventVideoTests.Create_WithNegativeDisplayOrder_ShouldThrow [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventVideoTests.Create_WithEmptyVideoUrl_ShouldThrow [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventVideoTests.Create_WithNegativeFileSize_ShouldThrow [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventVideoTests.Create_WithValidData_ShouldSucceed [3 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventVideoTests.Create_WithNullDuration_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguagePreferenceTests.LanguagePreference_Should_Support_All_ProficiencyLevels [1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguagePreferenceTests.LanguagePreference_Should_Support_Multiple_Languages [1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguagePreferenceTests.LanguagePreference_Should_Work_With_All_Proficiency_Levels(level: Native) [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguagePreferenceTests.LanguagePreference_Should_Work_With_All_Proficiency_Levels(level: Intermediate) [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguagePreferenceTests.LanguagePreference_Should_Work_With_All_Proficiency_Levels(level: Advanced) [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguagePreferenceTests.LanguagePreference_Should_Work_With_All_Proficiency_Levels(level: Basic) [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguagePreferenceTests.LanguagePreference_ToString_Should_Return_Meaningful_String [2 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguagePreferenceTests.LanguagePreference_Equality_Should_Be_Case_Sensitive_For_Language [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguagePreferenceTests.LanguagePreference_Should_Support_Equality_By_Language_And_Proficiency [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguagePreferenceTests.Create_Should_Return_Success_For_Valid_Inputs [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguagePreferenceTests.LanguagePreference_Should_Be_Immutable [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguagePreferenceTests.Create_Should_Return_Failure_For_Null_LanguageCode [< 1 ms]
  Passed LankaConnect.Domain.Tests.Users.ValueObjects.LanguagePreferenceTests.LanguagePreference_Should_Have_LanguageCode_And_ProficiencyLevel [< 1 ms]
  Passed LankaConnect.Application.Tests.Mappings.BusinessMappingProfileTests.Map_BusinessCollectionToBusinessDtoCollection_ShouldMapAll [272 ms]
  Passed LankaConnect.Application.Tests.Mappings.BusinessMappingProfileTests.Map_BusinessToBusinessDto_ShouldPreserveContactInformation [10 ms]
  Passed LankaConnect.Application.Tests.Mappings.BusinessMappingProfileTests.Map_BusinessToBusinessDto_ShouldHandleAllBusinessCategories [13 ms]
  Passed LankaConnect.Application.Tests.Mappings.BusinessMappingProfileTests.Map_BusinessToBusinessDto_ShouldMapAllProperties [22 ms]
  Passed LankaConnect.Application.Tests.Mappings.BusinessMappingProfileTests.Configuration_ShouldBeValid [42 ms]
  Passed LankaConnect.Application.Tests.Mappings.BusinessMappingProfileTests.Map_BusinessToBusinessDto_ShouldBeConsistent [87 ms]
  Passed LankaConnect.Application.Tests.Mappings.BusinessMappingProfileTests.Map_BusinessToBusinessDto_ShouldHandleWebsiteCorrectly [15 ms]
  Passed LankaConnect.Application.Tests.Mappings.BusinessMappingProfileTests.Map_BusinessToBusinessDto_ShouldPreserveCoordinates [13 ms]
  Passed LankaConnect.Application.Tests.Mappings.BusinessMappingProfileTests.Map_BusinessToBusinessDto_ShouldPreserveDateTimeKind [14 ms]
  Passed LankaConnect.Application.Tests.Mappings.BusinessMappingProfileTests.Map_NullBusiness_ShouldReturnNull [12 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UploadProfilePhotoCommandHandlerTests.Handle_WhenImageUploadFails_ShouldReturnFailure [498 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UploadProfilePhotoCommandHandlerTests.Handle_WithNullFile_ShouldReturnFailure [4 ms]
  Passed LankaConnect.Application.Tests.Users.Queries.GetUserByIdQueryHandlerTests.Handle_WithUserWithoutPhoneNumber_ShouldReturnUserDtoWithNullPhone [512 ms]
  Passed LankaConnect.Application.Tests.Mappings.BusinessMappingProfileTests.Map_BusinessToBusinessDto_ShouldPreserveStatus [38 ms]
  Passed LankaConnect.Application.Tests.Users.Queries.GetUserByIdQueryHandlerTests.Handle_WithUserWithCulturalInterests_ShouldReturnInterestCodes [11 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UploadProfilePhotoCommandHandlerTests.Handle_WithValidImageAndExistingUser_ShouldUploadAndUpdateUser [18 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UploadProfilePhotoCommandHandlerTests.Handle_WhenUserHasExistingPhoto_ShouldDeleteOldPhotoFirst [9 ms]
  Passed LankaConnect.Application.Tests.Mappings.BusinessMappingProfileTests.Map_EmptyBusinessCollection_ShouldReturnEmptyCollection [15 ms]
  Passed LankaConnect.Application.Tests.Auth.LoginUserHandlerTests.Handle_WithWrongPassword_ShouldReturnFailureAndRecordFailedAttempt [311 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithInvalidPhoneNumber_ShouldHavePhoneNumberError(phoneNumber: "94771234567") [545 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UploadProfilePhotoCommandHandlerTests.Handle_WithEmptyFile_ShouldReturnFailure [5 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithInvalidPhoneNumber_ShouldHavePhoneNumberError(phoneNumber: "invalid-phone") [1 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithInvalidPhoneNumber_ShouldHavePhoneNumberError(phoneNumber: "++94771234567") [< 1 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithInvalidPhoneNumber_ShouldHavePhoneNumberError(phoneNumber: "123") [14 ms]
  Passed LankaConnect.Application.Tests.Users.Queries.GetUserByIdQueryHandlerTests.Handle_WithUserWithoutEpic1Phase3Fields_ShouldReturnEmptyOrNullValues [34 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithNullPhoneNumber_ShouldNotHaveError [4 ms]
  Passed LankaConnect.Application.Tests.Auth.LoginUserHandlerTests.Handle_WithUnverifiedEmail_ShouldReturnFailure [22 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithInvalidEmailFormat_ShouldHaveEmailFormatError(email: "test") [1 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithInvalidEmailFormat_ShouldHaveEmailFormatError(email: "test@") [< 1 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithInvalidEmailFormat_ShouldHaveEmailFormatError(email: "invalid-email") [< 1 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithInvalidEmailFormat_ShouldHaveEmailFormatError(email: "@test.com") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UploadProfilePhotoCommandHandlerTests.Handle_WhenUserNotFound_ShouldReturnFailure [10 ms]
  Passed LankaConnect.Application.Tests.Auth.LoginUserHandlerTests.Handle_WithInactiveUser_ShouldReturnFailure [3 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateLanguagesTests.UpdateLanguages_Should_Fail_When_Empty [1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateLanguagesTests.UpdateLanguages_Event_Should_Contain_User_Id_And_Languages [1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateLanguagesTests.UpdateLanguages_Should_Fail_When_More_Than_5 [1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateLanguagesTests.UpdateLanguages_Should_Allow_Same_Language_Different_Proficiency [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateLanguagesTests.UpdateLanguages_Should_Allow_Exactly_5 [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateLanguagesTests.UpdateLanguages_Should_Add_Languages_Successfully [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateLanguagesTests.UpdateLanguages_Should_Remove_Duplicate_Languages [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateLanguagesTests.UpdateLanguages_Should_Replace_Existing_Languages [2 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.CreateUserCommandHandlerTests.Handle_WithEmptyLastName_ShouldReturnFailure [509 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithInvalidEmail_ShouldHaveEmailError(email: null) [12 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdateLanguagesTests.UpdateLanguages_Should_Raise_Domain_Event [< 1 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithInvalidEmail_ShouldHaveEmailError(email: "") [< 1 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithInvalidEmail_ShouldHaveEmailError(email: " ") [< 1 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithValidEmails_ShouldNotHaveError(email: "test@example.com") [1 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithValidEmails_ShouldNotHaveError(email: "user+tag@domain.co.uk") [< 1 ms]
  Passed LankaConnect.Application.Tests.Mappings.BusinessMappingProfileTests.Map_MultipleBusinesses_ShouldMaintainOrder [45 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithValidEmails_ShouldNotHaveError(email: "valid.email@subdomain.example.org") [< 1 ms]
  Passed LankaConnect.Application.Tests.Auth.LoginUserHandlerTests.Handle_WithValidCredentials_ShouldReturnSuccessWithTokens [17 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithInvalidLastName_ShouldHaveLastNameError(lastName: "") [2 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithInvalidLastName_ShouldHaveLastNameError(lastName: " ") [< 1 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithInvalidLastName_ShouldHaveLastNameError(lastName: null) [< 1 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithValidCommand_ShouldNotHaveErrors [< 1 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithValidFirstNames_ShouldNotHaveError(firstName: "john") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Queries.GetUserByIdQueryHandlerTests.Handle_WithValidRequest_ShouldCallRepositoryOnce [29 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithValidFirstNames_ShouldNotHaveError(firstName: "John123") [< 1 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithValidFirstNames_ShouldNotHaveError(firstName: "John O'Connor") [< 1 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithValidFirstNames_ShouldNotHaveError(firstName: "John-Paul") [< 1 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithValidFirstNames_ShouldNotHaveError(firstName: "JOHN") [< 1 ms]
  Passed LankaConnect.Application.Tests.Businesses.Queries.GetBusinessQueryHandlerTests.Handle_WithValidRequest_ShouldCallRepositoryOnce [12 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithValidBio_ShouldNotHaveError [1 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithNullBio_ShouldNotHaveError [< 1 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithInvalidFirstName_ShouldHaveFirstNameError(firstName: " ") [1 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithInvalidFirstName_ShouldHaveFirstNameError(firstName: "") [< 1 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithInvalidFirstName_ShouldHaveFirstNameError(firstName: null) [< 1 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithLastNameTooLong_ShouldHaveLastNameLengthError [1 ms]
  Passed LankaConnect.Application.Tests.Mappings.BusinessMappingProfileTests.Map_BusinessToBusinessDto_ShouldPreserveAddressComponents [14 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithEmailTooLong_ShouldHaveEmailLengthError [1 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithEmptyBio_ShouldNotHaveError [< 1 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithBioTooLong_ShouldHaveBioLengthError [< 1 ms]
  Passed LankaConnect.Application.Tests.Auth.LoginUserHandlerTests.Handle_ShouldRecordSuccessfulLogin [15 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithFirstNameTooLong_ShouldHaveFirstNameLengthError [1 ms]
  Passed LankaConnect.Application.Tests.Auth.LoginUserHandlerTests.Handle_WithInvalidEmail_ShouldReturnFailure [1 ms]
  Passed LankaConnect.Application.Tests.Validators.CreateUserCommandValidatorTests.Validate_WithValidPhoneNumber_ShouldNotHavePhoneNumberError [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Queries.GetUserByIdQueryHandlerTests.Handle_WithUserWithProfilePhoto_ShouldReturnProfilePhotoUrl [14 ms]
  Passed LankaConnect.Application.Tests.Auth.LoginUserHandlerTests.Handle_WithLockedAccount_ShouldReturnFailure [3 ms]
  Passed LankaConnect.Application.Tests.Businesses.Queries.GetBusinessQueryHandlerTests.Handle_WhenMapperThrows_ShouldPropagateException [6 ms]
  Passed LankaConnect.Application.Tests.Businesses.Queries.GetBusinessQueryHandlerTests.Handle_WithNonExistentBusiness_ShouldReturnSuccessWithNull [4 ms]
  Passed LankaConnect.Application.Tests.Users.Queries.GetUserByIdQueryHandlerTests.Handle_WithEmptyGuid_ShouldReturnFailure [4 ms]
  Passed LankaConnect.Application.Tests.Auth.LoginUserHandlerTests.Handle_WithTokenGenerationFailure_ShouldReturnFailure [7 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.CreateUserCommandHandlerTests.Handle_WhenUnitOfWorkFails_ShouldPropagateException [34 ms]
  Passed LankaConnect.Application.Tests.Businesses.Queries.GetBusinessQueryHandlerTests.Handle_WithEmptyGuid_ShouldReturnSuccessWithNull [3 ms]
  Passed LankaConnect.Application.Tests.Auth.LoginUserHandlerTests.Handle_WithNonExistentUser_ShouldReturnFailure [3 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.CreateUserCommandHandlerTests.Handle_WithInvalidPhoneNumber_ShouldReturnFailure [5 ms]
  Passed LankaConnect.Application.Tests.Businesses.Queries.GetBusinessQueryHandlerTests.Handle_WithHighRatedUsBusiness_ShouldReturnRatingData [10 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.CreateUserCommandHandlerTests.Handle_WithCancellationRequested_ShouldThrowOperationCancelledException [9 ms]
  Passed LankaConnect.Application.Tests.Businesses.Queries.GetBusinessQueryHandlerTests.Handle_WhenRepositoryThrows_ShouldPropagateException [4 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.CreateUserCommandHandlerTests.Handle_WithEmptyFirstName_ShouldReturnFailure [3 ms]
  Passed LankaConnect.Application.Tests.Auth.LoginUserHandlerTests.Handle_WithRefreshTokenGenerationFailure_ShouldReturnFailure [20 ms]
  Passed LankaConnect.Application.Tests.Auth.LoginUserHandlerTests.Handle_WithUserWithoutPasswordHash_ShouldReturnFailure [3 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.CreateUserCommandHandlerTests.Handle_WhenRepositoryThrows_ShouldPropagateException [12 ms]
  Passed LankaConnect.Application.Tests.Auth.LoginUserHandlerTests.Handle_WithDatabaseException_ShouldRethrowException [5 ms]
  Passed LankaConnect.Application.Tests.Businesses.Queries.GetBusinessQueryHandlerTests.Handle_WithExistingBusiness_ShouldReturnBusinessDto [19 ms]
  Passed LankaConnect.Application.Tests.Events.BackgroundJobs.EventReminderJobTests.ExecuteAsync_WithNoEventsInTimeWindow_ShouldNotSendAnyEmails [49 ms]
  Passed LankaConnect.Application.Tests.Businesses.Queries.GetBusinessQueryHandlerTests.Handle_WithUsBusinessData_ShouldReturnUsFormattedData [7 ms]
  Passed LankaConnect.Application.Tests.Auth.LoginUserHandlerTests.Handle_ShouldAddRefreshTokenToUser [10 ms]
  Passed LankaConnect.Application.Tests.Users.Queries.GetUserByIdQueryHandlerTests.Handle_WithNonExistentUser_ShouldReturnFailure [45 ms]
  Passed LankaConnect.Application.Tests.Businesses.Queries.GetBusinessQueryHandlerTests.Handle_WithCancellationRequested_ShouldThrowOperationCancelledException [3 ms]
  Passed LankaConnect.Application.Tests.Mappings.BusinessMappingProfileTests.Map_BusinessWithSpecialCharacters_ShouldMapCorrectly [64 ms]
  Passed LankaConnect.Application.Tests.Common.Models.ConfigurationImportParametersTests.ConfigurationImportParameters_Should_Exist_And_Be_Instantiable [< 1 ms]
  Passed LankaConnect.Application.Tests.Common.Models.ConfigurationImportParametersTests.ConfigurationImportParameters_Should_Have_Required_Properties [2 ms]
  Passed LankaConnect.Application.Tests.Businesses.Queries.GetBusinessQueryHandlerTests.Handle_WithVerifiedUsBusiness_ShouldReturnVerificationStatus [8 ms]
  Passed LankaConnect.Application.Tests.Businesses.Queries.GetBusinessQueryHandlerTests.Handle_WithUsBusinessCategories_ShouldReturnCategoryData [5 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateSignUpItemCommandHandlerTests.Handle_WhenSignUpListNotFound_ShouldReturnFailure [45 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.CreateUserCommandHandlerTests.Handle_WithValidCommand_ShouldCreateUserAndReturnId [59 ms]
  Passed LankaConnect.Application.Tests.Users.Queries.GetUserByIdQueryHandlerTests.Handle_WhenRepositoryThrows_ShouldPropagateException [53 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.CreateUserCommandHandlerTests.Handle_WhenEmailAlreadyExists_ShouldReturnFailure [9 ms]
  Passed LankaConnect.Application.Tests.Events.BackgroundJobs.EventReminderJobTests.ExecuteAsync_WithAuthenticatedUserRegistration_ShouldSendEmailToUserEmail [65 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UnlinkExternalProviderCommandHandlerTests.Handle_ShouldRaiseDomainEvent [52 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.CreateUserCommandHandlerTests.Handle_WithInvalidEmail_ShouldReturnFailure [7 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateSignUpItemCommandHandlerTests.Handle_WithNullNotes_ShouldClearNotes [21 ms]
  Passed LankaConnect.Application.Tests.Users.Queries.GetUserByIdQueryHandlerTests.Handle_WithUserWithLocation_ShouldReturnLocationDetails [9 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.CreateUserCommandHandlerTests.Handle_WithoutOptionalFields_ShouldCreateUser [6 ms]
  Passed LankaConnect.Application.Tests.Events.BackgroundJobs.EventReminderJobTests.ExecuteAsync_UserNotFound_ShouldSkipRegistrationAndContinue [14 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateSignUpItemCommandHandlerTests.Handle_WhenSignUpItemNotFound_ShouldReturnFailure [7 ms]
  Passed LankaConnect.Application.Tests.Events.Queries.GetNearbyEventsQueryHandlerTests.Handle_WithInvalidCoordinates_ShouldReturnFailure(latitude: 91, longitude: 79.8612) [61 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RevenueBreakdownTests.Create_WithVariousPrices_ShouldCalculateCorrectPayout(price: 100, taxRate: 0.0725, expectedPayout: 88.37) [6 ms]
  Passed LankaConnect.Application.Tests.Users.Queries.GetUserByIdQueryHandlerTests.Handle_WithCancellationRequested_ShouldThrowOperationCancelledException [12 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RevenueBreakdownTests.Create_WithVariousPrices_ShouldCalculateCorrectPayout(price: 25, taxRate: 0.08, expectedPayout: 21.71) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RevenueBreakdownTests.Create_WithVariousPrices_ShouldCalculateCorrectPayout(price: 10, taxRate: 0.07, expectedPayout: 8.59) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Queries.GetNearbyEventsQueryHandlerTests.Handle_WithInvalidCoordinates_ShouldReturnFailure(latitude: 6.9271, longitude: 181) [1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RevenueBreakdownTests.Create_WithVariousPrices_ShouldCalculateCorrectPayout(price: 50, taxRate: 0.065, expectedPayout: 44.35) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Queries.GetNearbyEventsQueryHandlerTests.Handle_WithInvalidCoordinates_ShouldReturnFailure(latitude: 6.9271, longitude: -181) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Queries.GetNearbyEventsQueryHandlerTests.Handle_WithInvalidCoordinates_ShouldReturnFailure(latitude: -91, longitude: 79.8612) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Queries.GetNearbyEventsQueryHandlerTests.Handle_WithInvalidRadius_ShouldReturnFailure(radiusKm: 0) [1 ms]
  Passed LankaConnect.Application.Tests.Events.Queries.GetNearbyEventsQueryHandlerTests.Handle_WithInvalidRadius_ShouldReturnFailure(radiusKm: 1001) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Queries.GetNearbyEventsQueryHandlerTests.Handle_WithInvalidRadius_ShouldReturnFailure(radiusKm: -5) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RevenueBreakdownTests.Create_WithPriceTooLowForFees_ShouldFail [4 ms]
  Passed LankaConnect.Application.Tests.Users.Queries.GetUserByIdQueryHandlerTests.Handle_WithExistingUser_ShouldReturnUserDto [10 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RevenueBreakdownTests.ValueObjectEquality_WithSameValues_ShouldBeEqual [6 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RevenueBreakdownTests.Create_WithVariousRateCombinations_ShouldCalculateCorrectly(platformRate: 0.02, stripeFeeRate: 0.029, stripeFeeFixed: 0.3, expectedPayoutNoTax: 94.8) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.BackgroundJobs.EventReminderJobTests.ExecuteAsync_ExceptionDuringProcessing_ShouldThrowForHangfireRetry [17 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RevenueBreakdownTests.Create_WithVariousRateCombinations_ShouldCalculateCorrectly(platformRate: 0.05, stripeFeeRate: 0.035, stripeFeeFixed: 0.5, expectedPayoutNoTax: 91) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RevenueBreakdownTests.Create_WithVariousRateCombinations_ShouldCalculateCorrectly(platformRate: 0, stripeFeeRate: 0, stripeFeeFixed: 0, expectedPayoutNoTax: 100) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RevenueBreakdownTests.Create_WithZeroPrice_ShouldReturnZeroBreakdown [1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RevenueBreakdownTests.Create_WithTaxRateOver50Percent_ShouldFail [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RevenueBreakdownTests.Create_WithNullGrossAmount_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Queries.GetNearbyEventsQueryHandlerTests.Handle_WhenNoEventsInRadius_ShouldReturnEmptyList [13 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RevenueBreakdownTests.ValueObjectEquality_WithDifferentValues_ShouldNotBeEqual [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RevenueBreakdownTests.Create_ShouldCalculate_TaxInclusivePricing_Correctly [1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RevenueBreakdownTests.Create_WithDifferentCurrencies_ShouldPreserveCurrency [2 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RevenueBreakdownTests.Create_WithCustomCommissionRates_ShouldUseProvidedRates [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RevenueBreakdownTests.Create_WithNegativeTaxRate_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UnlinkExternalProviderCommandHandlerTests.Handle_WhenUserHasOtherProviders_ShouldUnlinkSuccessfully [37 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RevenueBreakdownTests.Create_WithValidInputs_ShouldCalculateBreakdownCorrectly [1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RevenueBreakdownTests.Create_WithVeryLowPrice_ShouldNotProduceNegativePayout [1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.RevenueBreakdownTests.Create_WithZeroTaxRate_ShouldCalculateWithoutTax [1 ms]
  Passed LankaConnect.Application.Tests.Users.UserEntraIntegrationTests.CreateFromExternalProvider_ShouldSetEmailAsVerified [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.UserEntraIntegrationTests.ChangePassword_OnExternalProviderUser_ShouldFail [1 ms]
  Passed LankaConnect.Application.Tests.Users.UserEntraIntegrationTests.CreateFromExternalProvider_WithEmptyExternalProviderId_ShouldFail [1 ms]
  Passed LankaConnect.Application.Tests.Users.UserEntraIntegrationTests.CreateFromExternalProvider_ShouldNotRequirePasswordHash [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.UserEntraIntegrationTests.IsLocalProvider_ShouldReturnFalseForExternalUsers [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.UserEntraIntegrationTests.SetPassword_OnLocalProviderUser_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UnlinkExternalProviderCommandHandlerTests.Handle_ShouldCallUnitOfWorkCommit [9 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateSignUpItemCommandHandlerTests.Handle_ReducingQuantityBelowCommitted_ShouldReturnFailure [40 ms]
  Passed LankaConnect.Application.Tests.Users.UserEntraIntegrationTests.CreateFromExternalProvider_ShouldRaiseUserCreatedFromExternalProviderEvent [6 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UnlinkExternalProviderCommandHandlerTests.Handle_WhenUserNotFound_ShouldReturnFailure [6 ms]
  Passed LankaConnect.Application.Tests.Users.UserEntraIntegrationTests.SetPassword_OnExternalProviderUser_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.UserEntraIntegrationTests.IsLocalProvider_ShouldReturnTrueForLocalUsers [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateSignUpItemCommandHandlerTests.Handle_WithEmptyDescription_ShouldReturnFailure [7 ms]
  Passed LankaConnect.Application.Tests.Users.UserEntraIntegrationTests.CreateFromExternalProvider_WithValidData_ShouldSucceed [2 ms]
  Passed LankaConnect.Application.Tests.Users.Queries.GetUserByIdQueryHandlerTests.Handle_WithUserWithLanguages_ShouldReturnLanguagesWithProficiency [34 ms]
  Passed LankaConnect.Application.Tests.Users.UserEntraIntegrationTests.IsExternalProvider_ShouldReturnTrueForExternalUsers [3 ms]
  Passed LankaConnect.Application.Tests.Users.UserEntraIntegrationTests.CreateFromExternalProvider_WithLocalProvider_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.UserEntraIntegrationTests.CreateFromExternalProvider_WithNullExternalProviderId_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateSignUpItemCommandHandlerTests.Handle_IncreasingQuantityWithCommitments_ShouldSucceed [9 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.UpdateBusinessCommandHandlerTests.Handle_WithEmptyFields_ShouldHandleGracefully [929 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventPassTests.ConfirmPurchase_AlreadyConfirmed_ShouldFail [7 ms]
  Passed LankaConnect.Application.Tests.Users.UserEntraIntegrationTests.CreateFromExternalProvider_WithNullEmail_ShouldFail [2 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventPassTests.CreatePassConfiguration_WithValidData_ShouldSucceed [1 ms]
  Passed LankaConnect.Application.Tests.Users.UserEntraIntegrationTests.Create_LocalUser_ShouldNotHaveExternalProviderId [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.UserEntraIntegrationTests.Create_LocalUser_ShouldDefaultToLocalProvider [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateSignUpItemCommandHandlerTests.Handle_WithInvalidQuantity_ShouldReturnFailure [6 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UnlinkExternalProviderCommandHandlerTests.Handle_WhenProviderNotLinked_ShouldReturnFailure [18 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventPassTests.AddPass_ToEvent_ShouldSucceed [5 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventPassTests.ReservePass_ExceedingAvailableQuantity_ShouldFail [1 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateSignUpItemCommandHandlerTests.Handle_WhenEventNotFound_ShouldReturnFailure [4 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventPassTests.CancelPurchase_FromPendingStatus_ShouldSucceed [2 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventPassTests.CancelPurchase_FromConfirmedStatus_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Queries.GetNearbyEventsQueryHandlerTests.Handle_WithOptionalFilters_ShouldApplyFilters [49 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventPassTests.RemovePass_FromEvent_ShouldSucceed [2 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UnlinkExternalProviderCommandHandlerTests.Handle_WithValidData_ShouldUnlinkProviderAndReturnSuccess [9 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventPassTests.Create_WithNegativeQuantity_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventPassTests.ReservePass_MultipleReservations_ShouldTrackCorrectly [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventPassTests.CancelPassPurchase_ShouldRaisePassCancelledEvent [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventPassTests.RemovePass_WithExistingPurchases_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventPassTests.ConfirmPurchase_FromPendingStatus_ShouldSucceed [2 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.UpdateBusinessCommandHandlerTests.Handle_WithCancellationToken_ShouldPassTokenToRepository [22 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventPassTests.ConfirmPassPurchase_ShouldRaisePassPurchasedEvent [1 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UnlinkExternalProviderCommandHandlerTests.Handle_WhenLastAuthMethod_ShouldReturnFailure [8 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventPassTests.CreatePassPurchase_WithValidData_ShouldSucceed [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventPassTests.Create_WithNullName_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.UpdateBusinessCommandHandlerTests.Handle_WithVariousUsPhoneFormats_ShouldUpdateSuccessfully(phoneNumber: "+1-212-555-1234") [6 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateSignUpItemCommandHandlerTests.Handle_WithValidCommand_ShouldUpdateSignUpItem [19 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.UpdateBusinessCommandHandlerTests.Handle_WithVariousUsPhoneFormats_ShouldUpdateSuccessfully(phoneNumber: "+1-555-123-4567") [2 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UnlinkExternalProviderCommandHandlerTests.Handle_WhenCommitFails_ShouldReturnFailure [7 ms]
  Passed LankaConnect.Application.Tests.Events.Queries.GetNearbyEventsQueryHandlerTests.Handle_WithValidCoordinatesAndRadius_ShouldReturnNearbyEvents [20 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.UpdateBusinessCommandHandlerTests.Handle_WithVariousUsPhoneFormats_ShouldUpdateSuccessfully(phoneNumber: "+1-800-555-0199") [2 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.FindTierForAttendeeCount_OnNonGroupTieredPricing_ShouldFail [2 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.UpdateBusinessCommandHandlerTests.Handle_WhenRepositoryThrowsException_ShouldPropagateException [9 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventPassTests.Create_WithValidData_ShouldSucceed [21 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventPassTests.PassConfiguration_WithZeroMaxPasses_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventPassTests.ReservePass_WithAvailableQuantity_ShouldDecreaseAvailability [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventPassTests.Create_WithZeroQuantity_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventPassTests.CreatePassPurchase_ShouldGenerateUniqueQRCode [< 1 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.UpdateBusinessCommandHandlerTests.Handle_WithUsPhoneNumberUpdate_ShouldUpdateContactInfo [6 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventPassTests.AddMultiplePasses_ToEvent_ShouldTrackAll [1 ms]
  Passed LankaConnect.Application.Tests.Events.BackgroundJobs.EventReminderJobTests.ExecuteAsync_WithAnonymousRegistrationUsingContact_ShouldSendEmailToContactEmail [105 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.UpdateBusinessCommandHandlerTests.Handle_WhenBusinessNotFound_ShouldThrowBusinessNotFoundException [20 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.FindTierForAttendeeCount_WithValidCount_ShouldReturnCorrectTier(attendeeCount: 3, expectedTierIndex: 1) [35 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.FindTierForAttendeeCount_WithValidCount_ShouldReturnCorrectTier(attendeeCount: 2, expectedTierIndex: 0) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.FindTierForAttendeeCount_WithValidCount_ShouldReturnCorrectTier(attendeeCount: 5, expectedTierIndex: 1) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.FindTierForAttendeeCount_WithValidCount_ShouldReturnCorrectTier(attendeeCount: 100, expectedTierIndex: 2) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.FindTierForAttendeeCount_WithValidCount_ShouldReturnCorrectTier(attendeeCount: 1, expectedTierIndex: 0) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.FindTierForAttendeeCount_WithValidCount_ShouldReturnCorrectTier(attendeeCount: 6, expectedTierIndex: 2) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.CalculateGroupPrice_WithValidCount_ShouldReturnCorrectPrice(attendeeCount: 2, expectedAmount: 30) [1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.CalculateGroupPrice_WithValidCount_ShouldReturnCorrectPrice(attendeeCount: 10, expectedAmount: 100) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.CalculateGroupPrice_WithValidCount_ShouldReturnCorrectPrice(attendeeCount: 3, expectedAmount: 36) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.CalculateGroupPrice_WithValidCount_ShouldReturnCorrectPrice(attendeeCount: 5, expectedAmount: 60) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.CalculateGroupPrice_WithValidCount_ShouldReturnCorrectPrice(attendeeCount: 6, expectedAmount: 60) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.CalculateGroupPrice_WithValidCount_ShouldReturnCorrectPrice(attendeeCount: 1, expectedAmount: 15) [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdatePreferredMetroAreasTests.UpdatePreferredMetroAreas_Should_Allow_Exactly_10_Metro_Areas [12 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.CreateGroupTiered_NotStartingAtOne_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.UpdateBusinessCommandHandlerTests.Handle_WithValidUpdateCommand_ShouldUpdateBusinessSuccessfully [6 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.CreateGroupTiered_WithEmptyTiers_ShouldFail [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.CreateGroupTiered_WithNullTiers_ShouldFail [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.CreateGroupTiered_WithGapInTiers_ShouldFail [3 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.FindTierForAttendeeCount_WithInvalidCount_ShouldFail(invalidCount: -1) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.FindTierForAttendeeCount_WithInvalidCount_ShouldFail(invalidCount: 0) [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdatePreferredMetroAreasTests.UpdatePreferredMetroAreas_Event_Should_Contain_User_Id_And_Metro_Area_Ids [6 ms]
  Passed LankaConnect.Application.Tests.Events.BackgroundJobs.EventReminderJobTests.ExecuteAsync_EmailServiceFailure_ShouldContinueWithOtherRegistrations [19 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.ValueObjectEquality_GroupTieredWithDifferentTiers_ShouldNotBeEqual [2 ms]
  Passed LankaConnect.Application.Tests.Auth.Commands.LoginWithEntraCommandHandlerTests.Handle_WithInvalidToken_ShouldReturnFailure [52 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.ToString_ForGroupTiered_ShouldFormatCorrectly [3 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.ValueObjectEquality_GroupTieredWithSameTiers_ShouldBeEqual [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.CreateGroupTiered_WithMixedCurrencies_ShouldFail [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.CalculateGroupPrice_OnNonGroupTieredPricing_ShouldFail [1 ms]
  Passed LankaConnect.Application.Tests.Auth.Commands.LoginWithEntraCommandHandlerTests.Handle_WithValidToken_ShouldAddRefreshTokenWithCorrectExpiry [11 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdatePreferredMetroAreasTests.UpdatePreferredMetroAreas_Should_Replace_Existing_Metro_Areas [14 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdatePreferredMetroAreasTests.UpdatePreferredMetroAreas_Should_Fail_When_More_Than_20_Metro_Areas [1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdatePreferredMetroAreasTests.UpdatePreferredMetroAreas_Should_Add_Metro_Areas_Successfully [3 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.CreateSinglePrice_WithValidPrice_ShouldSucceed [11 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdatePreferredMetroAreasTests.UpdatePreferredMetroAreas_Should_Allow_Empty_Collection [2 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.CreateDualPrice_WithValidPrices_ShouldSucceed [2 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdatePreferredMetroAreasTests.UpdatePreferredMetroAreas_Should_Remove_Duplicates [< 1 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.UploadBusinessImageCommandTests.Handle_WhenBusinessImageCreationFails_ShouldCleanupUploadedImages [103 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.CreateGroupTiered_WithOverlappingTiers_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdatePreferredMetroAreasTests.UpdatePreferredMetroAreas_Should_Not_Raise_Event_When_Clearing_Preferences [1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdatePreferredMetroAreasTests.UpdatePreferredMetroAreas_Should_Raise_Domain_Event [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdatePreferredMetroAreasTests.UpdatePreferredMetroAreas_Should_Allow_Null_Collection [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserUpdatePreferredMetroAreasTests.UpdatePreferredMetroAreas_Should_Allow_Single_Metro_Area [1 ms]
  Passed LankaConnect.Application.Tests.Auth.Commands.LoginWithEntraCommandHandlerTests.Handle_WhenEntraDisabled_ShouldReturnFailure [21 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.UploadBusinessImageCommandTests.Handle_WithNonExistentBusiness_ShouldReturnFailure [11 ms]
  Passed LankaConnect.Application.Tests.Auth.Commands.LoginWithEntraCommandHandlerTests.Handle_WithIpAddress_ShouldStoreIpInRefreshToken [10 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.UploadBusinessImageCommandTests.Handle_WhenAddingImageToBusinessFails_ShouldCleanupUploadedImages [16 ms]
  Passed LankaConnect.Application.Tests.Auth.Commands.LoginWithEntraCommandHandlerTests.Handle_WithValidToken_ExistingUser_ShouldReturnSuccessWithTokens [10 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.UploadBusinessImageCommandTests.Handle_WhenImageServiceFails_ShouldReturnFailure [10 ms]
  Passed LankaConnect.Application.Tests.Auth.Commands.LoginWithEntraCommandHandlerTests.Handle_WithValidToken_NewUser_ShouldAutoProvisionAndReturnSuccess [11 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UpdateLanguagesCommandHandlerTests.Handle_Should_Update_Languages_Successfully [72 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.DeleteEventVideoCommandTests.Handle_WithValidVideoId_ShouldSucceed [61 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.CreateGroupTiered_WithValidTiers_ShouldSucceed [71 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.DeleteEventVideoCommandTests.Handle_WithNonExistentVideo_ShouldReturnFailure [4 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingGroupTiersTests.CreateSinglePrice_WithNullPrice_ShouldFail [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingTests.Create_WithNullAdultPrice_ShouldFail [1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingTests.Create_WithAgeLimitButNoChildPrice_ShouldFail [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingTests.Create_WithChildPriceButNoAgeLimit_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.DeleteEventVideoCommandTests.Handle_WithNonExistentEvent_ShouldReturnFailure [4 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.UploadBusinessImageCommandTests.Handle_WithValidCommand_ShouldReturnSuccessResult [36 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UpdateLanguagesCommandHandlerTests.Handle_Should_Fail_When_User_Not_Found [26 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingTests.IsChildAge_WithVariousAges_ShouldReturnCorrectResult(age: 12, expected: True) [1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingTests.IsChildAge_WithVariousAges_ShouldReturnCorrectResult(age: 5, expected: True) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingTests.IsChildAge_WithVariousAges_ShouldReturnCorrectResult(age: 13, expected: False) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingTests.IsChildAge_WithVariousAges_ShouldReturnCorrectResult(age: 0, expected: False) [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UpdateLanguagesCommandHandlerTests.Handle_Should_Fail_When_Invalid_Language_Code [4 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingTests.ValueObjectEquality_WithSameValues_ShouldBeEqual [2 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingTests.Create_WithChildPriceGreaterThanAdultPrice_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.DeleteEventVideoCommandTests.Handle_ShouldRaiseDomainEvent [7 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingTests.ValueObjectEquality_WithDifferentValues_ShouldNotBeEqual [1 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UpdateLanguagesCommandHandlerTests.Handle_Should_Fail_When_More_Than_5_Languages [4 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingTests.IsChildAge_WhenNoChildPricing_ShouldAlwaysReturnFalse [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingTests.Create_WithDifferentCurrencies_ShouldFail [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingTests.Create_WithValidAdultAndChildPrices_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingTests.CalculateForCategory_ForAdult_ShouldReturnAdultPrice [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingTests.Create_WithInvalidChildAgeLimit_ShouldFail(invalidAge: -1) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingTests.Create_WithInvalidChildAgeLimit_ShouldFail(invalidAge: 0) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingTests.Create_WithInvalidChildAgeLimit_ShouldFail(invalidAge: 100) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingTests.Create_WithInvalidChildAgeLimit_ShouldFail(invalidAge: 19) [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UpdateLanguagesCommandHandlerTests.Handle_Should_Fail_When_Empty_Languages [3 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingTests.CalculateForCategory_WithNoChildPricing_ShouldReturnAdultPrice [2 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingTests.Create_WithAdultPriceOnly_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.TicketPricingTests.CalculateForCategory_ForChild_ShouldReturnChildPrice [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserProfilePhotoTests.UpdateProfilePhoto_WithValidUrlAndBlobName_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Auth.Commands.LoginWithEntraCommandHandlerTests.Handle_WhenEmailAlreadyExistsWithDifferentProvider_ShouldReturnFailure [52 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserProfilePhotoTests.UpdateProfilePhoto_WithNullUrl_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.ReplaceEventImageCommandTests.Handle_WithNonExistentImageId_ShouldReturnFailure [17 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.Create_WithDifferentCurrencies_ShouldSucceed(amount: 1500, currency: LKR) [1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserProfilePhotoTests.RemoveProfilePhoto_WhenAlreadyRemoved_ShouldFail [2 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserProfilePhotoTests.ProfilePhotoBlobName_InitialState_ShouldBeNull [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.Create_WithDifferentCurrencies_ShouldSucceed(amount: 20, currency: EUR) [3 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.Create_WithDifferentCurrencies_ShouldSucceed(amount: 15, currency: GBP) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.Create_WithDifferentCurrencies_ShouldSucceed(amount: 30, currency: AUD) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.Create_WithDifferentCurrencies_ShouldSucceed(amount: 25, currency: CAD) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.Create_WithDifferentCurrencies_ShouldSucceed(amount: 10, currency: USD) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.IsFree_WithNullTicketPrice_ShouldReturnTrue [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserProfilePhotoTests.RemoveProfilePhoto_WhenPhotoExists_ShouldRaiseDomainEvent [3 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.Create_WithAllEventCategories_ShouldSucceed(category: Charity) [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.Create_WithAllEventCategories_ShouldSucceed(category: Community) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.ReplaceEventImageCommandTests.Handle_WithInvalidImageData_ShouldReturnFailure [7 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.Create_WithAllEventCategories_ShouldSucceed(category: Religious) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.Create_WithAllEventCategories_ShouldSucceed(category: Social) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.Create_WithAllEventCategories_ShouldSucceed(category: Cultural) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.Create_WithAllEventCategories_ShouldSucceed(category: Entertainment) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.Create_WithAllEventCategories_ShouldSucceed(category: Business) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.Create_WithAllEventCategories_ShouldSucceed(category: Educational) [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserProfilePhotoTests.RemoveProfilePhoto_WhenPhotoExists_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserProfilePhotoTests.UpdateProfilePhoto_ReplacingExistingPhoto_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.Create_WithDefaultCategory_ShouldSetCommunityCategory [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.Create_WithCategoryAndPrice_ShouldSetBothProperties [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.IsFree_WithZeroTicketPrice_ShouldReturnTrue [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserProfilePhotoTests.UpdateProfilePhoto_ReplacingExistingPhoto_ShouldRaiseNewEvent [2 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserProfilePhotoTests.UpdateProfilePhoto_WithWhitespaceBlobName_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.Create_FreeCharityEvent_ShouldHaveCorrectProperties [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserProfilePhotoTests.UpdateProfilePhoto_WithNullBlobName_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.IsFree_WithNonZeroTicketPrice_ShouldReturnFalse [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.ReplaceEventImageCommandTests.Handle_WithNonExistentEvent_ShouldReturnFailure [5 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.Create_PaidEntertainmentEvent_ShouldHaveCorrectProperties [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.Create_WithValidCategory_ShouldSetCategory [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.Create_WithZeroTicketPrice_ShouldCreateFreeEvent [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.Create_WithValidTicketPrice_ShouldSetTicketPrice [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.DeleteEventVideoCommandTests.Handle_WithMultipleVideos_ShouldRemoveCorrectOne [28 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventCategoryAndPricingTests.Create_WithNullTicketPrice_ShouldCreateFreeEvent [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Enums.IdentityProviderTests.RequiresPasswordHash_ShouldReturnCorrectValue(provider: EntraExternal, expectedRequiresPassword: False) [5 ms]
  Passed LankaConnect.Application.Tests.Users.Enums.IdentityProviderTests.RequiresPasswordHash_ShouldReturnCorrectValue(provider: Local, expectedRequiresPassword: True) [1 ms]
  Passed LankaConnect.Application.Tests.Users.Enums.IdentityProviderTests.IdentityProvider_ShouldHaveEntraExternalValue [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Enums.IdentityProviderTests.EmailPreVerified_ShouldReturnCorrectValue(provider: Local, expectedEmailPreVerified: False) [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserProfilePhotoTests.UpdateProfilePhoto_WithValidUrlAndBlobName_ShouldRaiseDomainEvent [11 ms]
  Passed LankaConnect.Application.Tests.Users.Enums.IdentityProviderTests.EmailPreVerified_ShouldReturnCorrectValue(provider: EntraExternal, expectedEmailPreVerified: True) [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserProfilePhotoTests.RemoveProfilePhoto_WhenNoPhotoExists_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Enums.IdentityProviderTests.IsExternalProvider_ShouldReturnCorrectValue(provider: EntraExternal, expectedIsExternal: True) [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Enums.IdentityProviderTests.IsExternalProvider_ShouldReturnCorrectValue(provider: Local, expectedIsExternal: False) [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Enums.IdentityProviderTests.RequiresExternalProviderId_ShouldReturnCorrectValue(provider: EntraExternal, expectedRequiresExternalId: True) [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Enums.IdentityProviderTests.RequiresExternalProviderId_ShouldReturnCorrectValue(provider: Local, expectedRequiresExternalId: False) [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserProfilePhotoTests.ProfilePhotoUrl_InitialState_ShouldBeNull [1 ms]
  Passed LankaConnect.Application.Tests.Users.Enums.IdentityProviderTests.ToDisplayName_ShouldReturnCorrectDisplayName(provider: EntraExternal, expectedDisplayName: "Microsoft Entra External ID") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserProfilePhotoTests.UpdateProfilePhoto_WithEmptyBlobName_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Enums.IdentityProviderTests.ToDisplayName_ShouldReturnCorrectDisplayName(provider: Local, expectedDisplayName: "Local") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Enums.IdentityProviderTests.IdentityProvider_ShouldHaveLocalValue [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserProfilePhotoTests.UpdateProfilePhoto_WithEmptyUrl_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserProfilePhotoTests.ProfilePhotoUrl_AfterUpdate_ShouldReturnCorrectValue [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserProfilePhotoTests.ProfilePhotoBlobName_AfterUpdate_ShouldReturnCorrectValue [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserProfilePhotoTests.UpdateProfilePhoto_WithWhitespaceUrl_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.ReplaceEventImageCommandTests.Handle_WhenReplacingImage_ShouldDeleteOldBlobAfterSuccess [43 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.ReplaceEventImageCommandTests.Handle_WithValidRequest_ShouldReplaceImageSuccessfully [59 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.ReplaceEventImageCommandTests.Handle_WhenDomainOperationFails_ShouldRollbackUploadedBlob [12 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.ReplaceEventImageCommandTests.Handle_WhenUploadFails_ShouldNotModifyEvent [29 ms]
  Passed LankaConnect.Application.Tests.Mappings.UserMappingProfileTests.Map_EmptyUserCollection_ShouldReturnEmptyCollection [148 ms]
  Passed LankaConnect.Application.Tests.Mappings.UserMappingProfileTests.Map_UserToUserDto_ShouldPreserveIsActiveStatus(isActive: True) [17 ms]
  Passed LankaConnect.Application.Tests.Mappings.UserMappingProfileTests.Map_UserToUserDto_ShouldPreserveIsActiveStatus(isActive: False) [20 ms]
  Passed LankaConnect.Application.Tests.Mappings.UserMappingProfileTests.Map_UserToUserDto_ShouldMapAllProperties [19 ms]
  Passed LankaConnect.Application.Tests.Mappings.UserMappingProfileTests.Configuration_ShouldBeValid [3 ms]
  Passed LankaConnect.Application.Tests.Mappings.UserMappingProfileTests.Map_UserWithPhoneNumber_ShouldMapPhoneNumber [15 ms]
  Passed LankaConnect.Application.Tests.Mappings.UserMappingProfileTests.Map_UserWithLongValues_ShouldMapCorrectly [23 ms]
  Passed LankaConnect.Application.Tests.Mappings.UserMappingProfileTests.Map_MultipleUsers_ShouldMaintainOrder [21 ms]
  Passed LankaConnect.Application.Tests.Mappings.UserMappingProfileTests.Map_UserWithoutOptionalFields_ShouldMapWithNulls [40 ms]
  Passed LankaConnect.Application.Tests.Mappings.UserMappingProfileTests.Map_UserCollectionToUserDtoCollection_ShouldMapAll [21 ms]
  Passed LankaConnect.Application.Tests.Mappings.UserMappingProfileTests.Map_NullUser_ShouldReturnNull [4 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.LinkExternalProviderCommandHandlerTests.Handle_ShouldCallUnitOfWorkCommit [490 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.LinkExternalProviderCommandHandlerTests.Handle_WhenUserNotFound_ShouldReturnFailure [8 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.ResetPasswordCommandHandlerTests.Handle_WithWeakPassword_ShouldReturnFailure [213 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.DeleteBusinessCommandHandlerTests.Handle_WithUsBusinessData_ShouldDeleteSuccessfully [383 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.LinkExternalProviderCommandHandlerTests.Handle_WithMultipleProviders_ShouldLinkSuccessfully [12 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.ResetPasswordCommandHandlerTests.Handle_ShouldResetFailedLoginAttempts [12 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.DeleteBusinessCommandHandlerTests.Handle_WithValidBusinessId_ShouldDeleteBusinessSuccessfully [8 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.DeleteBusinessCommandHandlerTests.Handle_WhenUnitOfWorkFails_ShouldPropagateException [11 ms]
  Passed LankaConnect.Application.Tests.Mappings.UserMappingProfileTests.Map_UserToUserDto_ShouldPreserveDateTimeKind [68 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.LinkExternalProviderCommandHandlerTests.Handle_WhenProviderAlreadyLinked_ShouldReturnFailure [41 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.DeleteBusinessCommandHandlerTests.Handle_WithCancellationToken_ShouldPassTokenToRepository [33 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.ResetPasswordCommandHandlerTests.Handle_ShouldClearPasswordResetToken [45 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.LinkExternalProviderCommandHandlerTests.Handle_ShouldRaiseDomainEvent [8 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.DeleteBusinessCommandHandlerTests.Handle_WithValidGuids_ShouldProcessCorrectly(guidString: "d290f1ee-6c54-4b01-90e6-d701748f0851") [8 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.DeleteBusinessCommandHandlerTests.Handle_WithValidGuids_ShouldProcessCorrectly(guidString: "123e4567-e89b-12d3-a456-426614174000") [5 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.DeleteBusinessCommandHandlerTests.Handle_WhenBusinessNotFound_ShouldThrowBusinessNotFoundException [7 ms]
  Passed LankaConnect.Application.Tests.Mappings.UserMappingProfileTests.Map_UserToUserDto_ShouldBeReversible [35 ms]
  Passed LankaConnect.Application.Tests.Auth.RegisterUserHandlerTests.Handle_WithEventOrganizerRole_ShouldCreateUserAsGeneralUserWithPendingUpgrade [414 ms]
  Passed LankaConnect.Application.Tests.Mappings.UserMappingProfileTests.Map_UserToUserDto_ShouldHandleEmailValueObjectCorrectly [16 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventRemoveVideoTests.RemoveVideo_ShouldRaiseDomainEvent [2 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventRemoveVideoTests.RemoveVideo_WithValidVideoId_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.LinkExternalProviderCommandHandlerTests.Handle_ShouldLogInformationOnSuccess [41 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.DeleteBusinessCommandHandlerTests.Handle_WhenRepositoryThrowsException_ShouldPropagateException [24 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventRemoveVideoTests.RemoveVideo_ShouldResequenceRemainingVideos [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventRemoveVideoTests.RemoveVideo_WithNonExistentVideoId_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventRemoveVideoTests.RemoveVideo_WhenNoVideos_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.DeleteBusinessCommandHandlerTests.Handle_WithEmptyGuid_ShouldReturnFailure [4 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventRemoveVideoTests.RemoveVideo_LastVideo_ShouldSucceed [2 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventRemoveVideoTests.RemoveVideo_DomainEventShouldIncludeBlobNames [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.LinkExternalProviderCommandHandlerTests.Handle_WithValidData_ShouldLinkProviderAndReturnSuccess [10 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserExternalLoginsTests.LinkExternalProvider_MultipleProviders_ShouldSucceed [4 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserExternalLoginsTests.LinkExternalProvider_WithInvalidProviderEmail_ShouldReturnFailure(invalidEmail: "") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserExternalLoginsTests.LinkExternalProvider_WithInvalidProviderEmail_ShouldReturnFailure(invalidEmail: null) [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserExternalLoginsTests.LinkExternalProvider_WithInvalidProviderEmail_ShouldReturnFailure(invalidEmail: "   ") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserExternalLoginsTests.UnlinkExternalProvider_WithExistingProvider_ShouldSucceed [2 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserExternalLoginsTests.LinkExternalProvider_WithInvalidExternalId_ShouldReturnFailure(invalidId: "") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserExternalLoginsTests.LinkExternalProvider_WithInvalidExternalId_ShouldReturnFailure(invalidId: null) [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserExternalLoginsTests.LinkExternalProvider_WithInvalidExternalId_ShouldReturnFailure(invalidId: "   ") [< 1 ms]
  Passed LankaConnect.Application.Tests.Auth.RegisterUserHandlerTests.Handle_WithValidRequest_ShouldSendVerificationEmail [20 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserExternalLoginsTests.UnlinkExternalProvider_WhenUserHasOtherProviders_ShouldSucceed [3 ms]
  Passed LankaConnect.Application.Tests.Auth.RegisterUserHandlerTests.Handle_WithInvalidEmail_ShouldReturnFailure [3 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserExternalLoginsTests.GetExternalLogin_WhenNotLinked_ShouldReturnNull [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserExternalLoginsTests.LinkExternalProvider_WhenAlreadyLinked_ShouldReturnFailure [1 ms]
  Passed LankaConnect.Application.Tests.Auth.RegisterUserHandlerTests.Handle_ShouldSetEmailVerificationToken [8 ms]
  Passed LankaConnect.Application.Tests.Behaviors.ValidationPipelineBehaviorTests.Handle_WhenValidatorThrows_ShouldPropagateException [29 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserExternalLoginsTests.LinkExternalProvider_ShouldRaiseDomainEvent [7 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserExternalLoginsTests.UnlinkExternalProvider_WhenNotLinked_ShouldReturnFailure [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserExternalLoginsTests.UnlinkExternalProvider_WhenUserHasPassword_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserExternalLoginsTests.HasExternalLogin_WhenLinked_ShouldReturnTrue [1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserExternalLoginsTests.NewUser_ShouldHaveEmptyExternalLogins [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserExternalLoginsTests.LinkExternalProvider_WithValidData_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.LinkExternalProviderCommandHandlerTests.Handle_WhenCommitFails_ShouldReturnFailure [23 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserExternalLoginsTests.GetExternalLogin_WhenLinked_ShouldReturnLogin [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserExternalLoginsTests.UnlinkExternalProvider_WhenLastAuthMethod_ShouldReturnFailure [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserExternalLoginsTests.UnlinkExternalProvider_ShouldRaiseDomainEvent [1 ms]
  Passed LankaConnect.Application.Tests.Auth.RegisterUserHandlerTests.Handle_WhenEmailFails_ShouldStillSucceedRegistration [7 ms]
  Passed LankaConnect.Application.Tests.Behaviors.ValidationPipelineBehaviorTests.Handle_WithMixedValidationResults_ShouldOnlyReturnErrors [10 ms]
  Passed LankaConnect.Application.Tests.Auth.RegisterUserHandlerTests.Handle_WithEmptyRequiredFields_ShouldReturnFailure(email: "test@example.com", password: "ValidPassword123!", firstName: "John", lastName: "") [6 ms]
  Passed LankaConnect.Application.Tests.Auth.RegisterUserHandlerTests.Handle_WithEmptyRequiredFields_ShouldReturnFailure(email: "test@example.com", password: "ValidPassword123!", firstName: "", lastName: "Doe") [1 ms]
  Passed LankaConnect.Application.Tests.Behaviors.ValidationPipelineBehaviorTests.Handle_WithMultipleValidatorsHavingErrors_ShouldCombineAllErrors [7 ms]
  Passed LankaConnect.Application.Tests.Auth.RegisterUserHandlerTests.Handle_WithEmptyRequiredFields_ShouldReturnFailure(email: "", password: "ValidPassword123!", firstName: "John", lastName: "Doe") [6 ms]
  Passed LankaConnect.Application.Tests.Behaviors.ValidationPipelineBehaviorTests.Handle_WithNoValidators_ShouldCallNext [4 ms]
  Passed LankaConnect.Application.Tests.Auth.RegisterUserHandlerTests.Handle_WithEmptyRequiredFields_ShouldReturnFailure(email: "test@example.com", password: "", firstName: "John", lastName: "Doe") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UpdateUserLocationCommandHandlerTests.Handle_WithValidLocation_ShouldUpdateUserAndReturnSuccess [21 ms]
  Passed LankaConnect.Application.Tests.Behaviors.ValidationPipelineBehaviorTests.Handle_WithValidationErrors_ShouldReturnFailureWithoutCallingNext [4 ms]
  Passed LankaConnect.Application.Tests.Events.EventHandlers.EventRejectedEventHandlerTests.Handle_OrganizerNotFound_ShouldNotSendEmail [21 ms]
  Passed LankaConnect.Application.Tests.Auth.RegisterUserHandlerTests.Handle_WithDifferentRoles_ShouldCreateUserWithCorrectRole(role: AdminManager) [10 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UpdateUserLocationCommandHandlerTests.Handle_WhenUserNotFound_ShouldReturnFailure [8 ms]
  Passed LankaConnect.Application.Tests.Auth.RegisterUserHandlerTests.Handle_WithDifferentRoles_ShouldCreateUserWithCorrectRole(role: Admin) [11 ms]
  Passed LankaConnect.Application.Tests.Behaviors.ValidationPipelineBehaviorTests.Handle_WithCancellationRequested_ShouldThrowOperationCancelledException [46 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UpdateUserLocationCommandHandlerTests.Handle_WithInvalidCity_ShouldReturnFailure [37 ms]
  Passed LankaConnect.Application.Tests.Auth.RegisterUserHandlerTests.Handle_WithDifferentRoles_ShouldCreateUserWithCorrectRole(role: GeneralUser) [29 ms]
  Passed LankaConnect.Application.Tests.Auth.RegisterUserHandlerTests.Handle_WithValidRequest_ShouldReturnSuccessWithUserResponse [9 ms]
  Passed LankaConnect.Application.Tests.Behaviors.ValidationPipelineBehaviorTests.Handle_WithMultipleValidators_ShouldValidateAll [11 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UpdateUserLocationCommandHandlerTests.Handle_WithInternationalLocation_ShouldSucceed [13 ms]
  Passed LankaConnect.Application.Tests.Behaviors.ValidationPipelineBehaviorTests.Handle_WithValidRequest_ShouldCallNext [4 ms]
  Passed LankaConnect.Application.Tests.Auth.RegisterUserHandlerTests.Handle_WithDatabaseError_ShouldRethrowException [8 ms]
  Passed LankaConnect.Application.Tests.Events.EventHandlers.EventApprovedEventHandlerTests.Handle_EventNotFound_ShouldNotSendEmail [124 ms]
  Passed LankaConnect.Application.Tests.Events.EventHandlers.EventRejectedEventHandlerTests.Handle_WithValidEvent_ShouldSendEmailToOrganizer [66 ms]
  Passed LankaConnect.Application.Tests.Auth.RegisterUserHandlerTests.Handle_WithExistingUser_ShouldReturnFailure [5 ms]
  Passed LankaConnect.Application.Tests.Events.BackgroundJobs.EventNotificationEmailJobTests.ExecuteAsync_HistoryNotFound_ShouldLogErrorAndReturn [126 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UpdateUserLocationCommandHandlerTests.Handle_WithNullLocation_ShouldClearLocationAndReturnSuccess [14 ms]
  Passed LankaConnect.Application.Tests.Events.EventHandlers.EventApprovedEventHandlerTests.Handle_OrganizerNotFound_ShouldNotSendEmail [12 ms]
  Passed LankaConnect.Application.Tests.Auth.RegisterUserHandlerTests.Handle_WithPasswordHashingFailure_ShouldReturnFailure [7 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.UpdateUserLocationCommandHandlerTests.Handle_ShouldUpdateExistingLocation [9 ms]
  Passed LankaConnect.Application.Tests.Auth.RegisterUserHandlerTests.Handle_WithWeakPassword_ShouldReturnFailure [6 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Update_WithNameExceeding50Characters_ShouldFail [22 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Create_WithEmptyBlobName_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.EventHandlers.EventRejectedEventHandlerTests.Handle_EmailServiceFailure_ShouldNotThrow [20 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.UpdateDefaultDuration_ShouldSetNewDuration [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.CanDelete_CustomBadge_ShouldReturnTrue [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Update_WithEmptyName_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.EventHandlers.EventApprovedEventHandlerTests.Handle_EmailServiceFailure_ShouldNotThrow [11 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Deactivate_SystemBadge_ShouldSucceed [1 ms]
  Passed LankaConnect.Application.Tests.Events.EventHandlers.EventRejectedEventHandlerTests.Handle_ExceptionDuringProcessing_ShouldNotThrow [7 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.CreateSystemBadge_ShouldTrimName [7 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Create_WithDifferentPositions_ShouldSucceed(position: BottomRight) [2 ms]
  Passed LankaConnect.Application.Tests.Events.EventHandlers.EventRejectedEventHandlerTests.Handle_EventNotFound_ShouldNotSendEmail [6 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Create_WithDifferentPositions_ShouldSucceed(position: TopLeft) [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Create_WithDifferentPositions_ShouldSucceed(position: TopRight) [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Create_WithDifferentPositions_ShouldSucceed(position: BottomLeft) [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.CreateSystemBadge_WithEmptyName_ShouldThrowException [1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.CanDelete_SystemBadge_ShouldReturnFalse [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.CreateSystemBadge_WithValidData_ShouldSucceed [1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Deactivate_InactiveBadge_ShouldFail [1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Create_WithoutDuration_ShouldHaveNullDefaultDurationDays [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Create_WithZeroOrNegativeDuration_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Create_WithDefaultDuration_ShouldSetDefaultDurationDays [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Create_WithEmptyCreatorUserId_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Create_ShouldTrimName [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.CreateSystemBadge_WithDuration_ShouldSetDefaultDurationDays [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.EventHandlers.EventRejectedEventHandlerTests.Handle_EmailContainsRejectionReason_ShouldIncludeReasonInBody [10 ms]
  Passed LankaConnect.Application.Tests.Events.BackgroundJobs.EventNotificationEmailJobTests.ExecuteAsync_WithValidHistory_ShouldSendEmailsAndUpdateStatistics [39 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserLocationTests.Create_WithCountryExceedingMaxLength_ShouldReturnFailure [1 ms]
  Passed LankaConnect.Application.Tests.Events.EventHandlers.EventApprovedEventHandlerTests.Handle_WithValidEvent_ShouldSendTemplatedEmailToOrganizer [24 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserLocationTests.Create_WithInvalidState_ShouldReturnFailure(city: "Los Angeles", state: "", zipCode: "90001", country: "United States") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserLocationTests.Create_WithInvalidState_ShouldReturnFailure(city: "Los Angeles", state: "   ", zipCode: "90001", country: "United States") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserLocationTests.Create_WithInvalidState_ShouldReturnFailure(city: "Los Angeles", state: null, zipCode: "90001", country: "United States") [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Update_SystemBadge_ShouldFail [5 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserLocationTests.ToString_ShouldReturnFormattedString [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserLocationTests.Create_WithInvalidCountry_ShouldReturnFailure(city: "Los Angeles", state: "California", zipCode: "90001", country: null) [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Create_WithEmptyName_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserLocationTests.Create_WithInvalidCountry_ShouldReturnFailure(city: "Los Angeles", state: "California", zipCode: "90001", country: "   ") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserLocationTests.Create_WithInvalidCountry_ShouldReturnFailure(city: "Los Angeles", state: "California", zipCode: "90001", country: "") [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Create_WithEmptyImageUrl_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserLocationTests.Create_WithInvalidZipCode_ShouldReturnFailure(city: "Los Angeles", state: "California", zipCode: "   ", country: "United States") [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Update_WithNegativeDisplayOrder_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Deactivate_ActiveBadge_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserLocationTests.Create_WithInvalidZipCode_ShouldReturnFailure(city: "Los Angeles", state: "California", zipCode: null, country: "United States") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserLocationTests.Create_WithInvalidZipCode_ShouldReturnFailure(city: "Los Angeles", state: "California", zipCode: "", country: "United States") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserLocationTests.Create_WithInvalidCity_ShouldReturnFailure(city: "   ", state: "California", zipCode: "90001", country: "United States") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserLocationTests.Create_WithInvalidCity_ShouldReturnFailure(city: "", state: "California", zipCode: "90001", country: "United States") [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Create_WithNameExceeding50Characters_ShouldFail [1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserLocationTests.Create_WithInvalidCity_ShouldReturnFailure(city: null, state: "California", zipCode: "90001", country: "United States") [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserLocationTests.Create_WithCityExceedingMaxLength_ShouldReturnFailure [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserLocationTests.TwoLocationsWithSameValues_ShouldBeEqual [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Create_WithWhitespaceName_ShouldFail [1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserLocationTests.Create_ShouldTrimWhitespace [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.UpdateDefaultDuration_WithNull_ShouldRemoveDuration [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.EventHandlers.EventApprovedEventHandlerTests.Handle_ExceptionDuringProcessing_ShouldNotThrow [6 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserLocationTests.Create_WithInternationalAddress_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.CreateSystemBadge_WithoutDuration_ShouldHaveNullDefaultDurationDays [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserLocationTests.Create_WithStateExceedingMaxLength_ShouldReturnFailure [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Create_WithNegativeDisplayOrder_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserLocationTests.Create_WithValidParameters_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserLocationTests.TwoLocationsWithDifferentValues_ShouldNotBeEqual [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Create_WithValidData_ShouldSucceed [1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserLocationTests.Create_WithUKAddress_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Activate_InactiveBadge_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.VerifyEmailCommandHandlerTests.Handle_WithUserNotFound_ShouldReturnFailure [40 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.UpdateImage_WithEmptyBlobName_ShouldFail [2 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.VerifyEmailCommandHandlerTests.Handle_WithCancellationToken_ShouldRespectCancellation [2 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.UpdateDefaultDuration_WithZeroOrNegative_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Update_CustomBadge_WithValidData_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.UpdateImage_WithEmptyUrl_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Domain.UserLocationTests.Create_WithZipCodeExceedingMaxLength_ShouldReturnFailure [5 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.Activate_ActiveBadge_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Badges.Domain.BadgeTests.UpdateImage_WithValidData_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventImageReplaceTests.ReplaceImage_WithNullImageUrl_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventImageReplaceTests.ReplaceImage_WithValidImageAndNewUrl_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventImageReplaceTests.ReplaceImage_WithNullBlobName_ShouldFail [1 ms]
  Passed LankaConnect.Application.Tests.Events.BackgroundJobs.EventNotificationEmailJobTests.ExecuteAsync_WithFailedEmails_ShouldTrackFailureCount [22 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventImageReplaceTests.ReplaceImage_WhenEventHasNoImages_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventImageReplaceTests.ReplaceImage_WithEmptyBlobName_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.VerifyEmailCommandHandlerTests.Handle_WithAlreadyVerifiedUser_ShouldReturnSuccess [9 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventImageReplaceTests.ReplaceImage_ShouldRaiseDomainEvent [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventImageReplaceTests.ReplaceImage_WithNonExistentImageId_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventImageReplaceTests.ReplaceImage_ShouldNotAffectOtherImages [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventImageReplaceTests.ReplaceImage_WithEmptyImageUrl_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventImageReplaceTests.ReplaceImage_ShouldMaintainDisplayOrder [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.BackgroundJobs.EventNotificationEmailJobTests.ExecuteAsync_EventNotFound_ShouldLogErrorAndReturn [6 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.VerifyEmailCommandHandlerTests.Handle_WithInvalidToken_ShouldReturnFailure [5 ms]
  Passed LankaConnect.Application.Tests.Events.EventHandlers.EventApprovedEventHandlerTests.Handle_WithValidEvent_ShouldIncludeEventAndManageUrls [25 ms]
  Passed LankaConnect.Application.Tests.Common.Models.BackupScheduleResultTests.BackupScheduleResult_Should_Be_Instantiable [1 ms]
  Passed LankaConnect.Application.Tests.Common.Models.BackupScheduleResultTests.BackupScheduleResult_Should_Have_Required_Properties [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventGroupPricingTests.CalculatePriceForAttendees_WithGroupTieredPricing_ShouldCalculateCorrectly(attendeeCount: 1, expectedAmount: 15) [7 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventGroupPricingTests.CalculatePriceForAttendees_WithGroupTieredPricing_ShouldCalculateCorrectly(attendeeCount: 2, expectedAmount: 30) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventGroupPricingTests.CalculatePriceForAttendees_WithGroupTieredPricing_ShouldCalculateCorrectly(attendeeCount: 10, expectedAmount: 100) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventGroupPricingTests.CalculatePriceForAttendees_WithGroupTieredPricing_ShouldCalculateCorrectly(attendeeCount: 3, expectedAmount: 36) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventGroupPricingTests.CalculatePriceForAttendees_WithGroupTieredPricing_ShouldCalculateCorrectly(attendeeCount: 6, expectedAmount: 60) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventGroupPricingTests.CalculatePriceForAttendees_WithGroupTieredPricing_ShouldCalculateCorrectly(attendeeCount: 4, expectedAmount: 48) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventGroupPricingTests.CalculatePriceForAttendees_WithGroupTieredPricing_ShouldCalculateCorrectly(attendeeCount: 5, expectedAmount: 60) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.CoversAttendeeCount_WithInvalidAttendeeCount_ShouldReturnFalse(invalidCount: -1) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.CoversAttendeeCount_WithInvalidAttendeeCount_ShouldReturnFalse(invalidCount: 0) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventGroupPricingTests.CalculatePriceForAttendees_WithLegacySinglePrice_ShouldStillWork [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.ToString_WithUnlimitedTier_ShouldFormatCorrectly [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventGroupPricingTests.IsFree_WithNoGroupTieredPricing_ShouldReturnTrue [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.Create_WithNegativePricePerPerson_ShouldFail [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.Create_WithInvalidMinAttendees_ShouldFail(invalidMin: -10) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventGroupPricingTests.CalculatePriceForAttendees_WithGroupTieredAndEmptyList_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.VerifyEmailCommandHandlerTests.Handle_WithValidToken_ShouldVerifyEmailAndSendWelcomeEmail [9 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.Create_WithInvalidMinAttendees_ShouldFail(invalidMin: 0) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.Create_WithInvalidMinAttendees_ShouldFail(invalidMin: -1) [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventGroupPricingTests.SetGroupPricing_WithNullPricing_ShouldFail [25 ms]
  Passed LankaConnect.Application.Tests.Common.ExceptionHandlingTests.NotFoundException_WithDifferentEntityTypes_ShouldFormatCorrectly(entityName: "Order", key: "789") [1 ms]
  Passed LankaConnect.Application.Tests.Common.ExceptionHandlingTests.NotFoundException_WithDifferentEntityTypes_ShouldFormatCorrectly(entityName: "Business", key: "456") [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventGroupPricingTests.CalculatePriceForAttendees_WithDualPricing_ShouldStillWork [1 ms]
  Passed LankaConnect.Application.Tests.Common.ExceptionHandlingTests.NotFoundException_WithDifferentEntityTypes_ShouldFormatCorrectly(entityName: "User", key: "123") [< 1 ms]
  Passed LankaConnect.Application.Tests.Common.ExceptionHandlingTests.NotFoundException_WithNullEntityName_ShouldHandleGracefully [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.ValueObjectEquality_WithSameValues_ShouldBeEqual [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventGroupPricingTests.SetGroupPricing_WithNonGroupTieredPricing_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Common.ExceptionHandlingTests.NotFoundException_ShouldInheritFromException [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.OverlapsWith_WithUnlimitedTierAndDefinedTier_ShouldDetectOverlap [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventGroupPricingTests.IsFree_WithGroupTieredPricing_ShouldReturnFalse [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.Create_WithNullPricePerPerson_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventGroupPricingTests.SetGroupPricing_ShouldNotBreakExistingDualPricingEvents [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.Create_WithValidMinMaxAndPrice_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventGroupPricingTests.CalculatePriceForAttendees_WithGroupTieredFreeEvent_ShouldReturnZero [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventGroupPricingTests.SetGroupPricing_ShouldRaiseEventPricingUpdatedEvent [2 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventGroupPricingTests.SetGroupPricing_WithValidTiers_ShouldSucceed [1 ms]
  Passed LankaConnect.Application.Tests.Common.ExceptionHandlingTests.NotFoundException_WithIntegerKey_ShouldFormatCorrectly [9 ms]
  Passed LankaConnect.Application.Tests.Common.ExceptionHandlingTests.NotFoundException_WithGuidKey_ShouldFormatCorrectly [< 1 ms]
  Passed LankaConnect.Application.Tests.Common.ExceptionHandlingTests.NotFoundException_WithNullOrWhitespaceMessage_ShouldHandleGracefully(message: null) [< 1 ms]
  Passed LankaConnect.Application.Tests.Common.ExceptionHandlingTests.NotFoundException_WithNullOrWhitespaceMessage_ShouldHandleGracefully(message: "   ") [< 1 ms]
  Passed LankaConnect.Application.Tests.Common.ExceptionHandlingTests.NotFoundException_WithNullOrWhitespaceMessage_ShouldHandleGracefully(message: "") [< 1 ms]
  Passed LankaConnect.Application.Tests.Common.ExceptionHandlingTests.NotFoundException_WithEmptyKey_ShouldHandleGracefully [< 1 ms]
  Passed LankaConnect.Application.Tests.Common.ExceptionHandlingTests.NotFoundException_WithSpecialCharacters_ShouldPreserveMessage [< 1 ms]
  Passed LankaConnect.Application.Tests.Common.ExceptionHandlingTests.NotFoundException_WithInnerException_ShouldPreserveInnerException [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateRegistrationDetailsCommandHandlerTests.Handle_PaidRegistration_ChangingAttendeeCount_ShouldFail [58 ms]
  Passed LankaConnect.Application.Tests.Common.ExceptionHandlingTests.NotFoundException_ToString_ShouldIncludeExceptionType [< 1 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.SendEmailVerificationCommandHandlerTests.Handle_WithValidEmail_ShouldSendVerificationEmail [77 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.OverlapsWith_WithAdjacentRanges_ShouldReturnFalse [2 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateRegistrationDetailsCommandHandlerTests.Handle_PaidRegistration_SameAttendeeCount_ShouldSucceed [6 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.Create_WithMaxAttendeesLessThanMin_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Common.ExceptionHandlingTests.NotFoundException_ShouldBeSerializable [6 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.CoversAttendeeCount_WithDefinedMaxAttendees_ShouldReturnCorrectResult(attendeeCount: 3, expected: False) [< 1 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.SendEmailVerificationCommandHandlerTests.Handle_WithNonExistentUser_ShouldReturnFailure [5 ms]
  Passed LankaConnect.Application.Tests.Common.ExceptionHandlingTests.NotFoundException_WithVeryLongMessage_ShouldPreserveMessage [2 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.CoversAttendeeCount_WithDefinedMaxAttendees_ShouldReturnCorrectResult(attendeeCount: 1, expected: True) [< 1 ms]
  Passed LankaConnect.Application.Tests.Common.ExceptionHandlingTests.NotFoundException_WithCustomMessage_ShouldSetMessage [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.CoversAttendeeCount_WithDefinedMaxAttendees_ShouldReturnCorrectResult(attendeeCount: 2, expected: True) [< 1 ms]
  Passed LankaConnect.Application.Tests.Common.ExceptionHandlingTests.NotFoundException_WithEntityNameAndKey_ShouldSetCorrectMessage [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.Create_WithNullMaxAttendees_ShouldSucceed [1 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateRegistrationDetailsCommandHandlerTests.Handle_FreeEvent_AddingAttendees_WithCapacity_ShouldSucceed [9 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.OverlapsWith_WithOverlappingRanges_ShouldReturnTrue [1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.CoversAttendeeCount_WithUnlimitedTier_ShouldReturnCorrectResult(attendeeCount: 2, expected: False) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.CoversAttendeeCount_WithUnlimitedTier_ShouldReturnCorrectResult(attendeeCount: 5, expected: True) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.CoversAttendeeCount_WithUnlimitedTier_ShouldReturnCorrectResult(attendeeCount: 100, expected: True) [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.CoversAttendeeCount_WithUnlimitedTier_ShouldReturnCorrectResult(attendeeCount: 3, expected: True) [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.DeleteProfilePhotoCommandHandlerTests.Handle_WhenUserNotFound_ShouldReturnFailure [31 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.ToString_WithDefinedMaxAttendees_ShouldFormatCorrectly [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.OverlapsWith_WithTwoUnlimitedTiers_ShouldReturnTrue [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.ValueObjectEquality_WithDifferentPrices_ShouldNotBeEqual [< 1 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.SendEmailVerificationCommandHandlerTests.Handle_WithInvalidEmail_ShouldReturnFailure [8 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.Create_WithMinAttendeesEqualToMax_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Domain.UnitTests.Events.ValueObjects.GroupPricingTierTests.ValueObjectEquality_WithDifferentMinAttendees_ShouldNotBeEqual [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationPropertyTests.Create_WithLocation_ShouldSucceed [1 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateRegistrationDetailsCommandHandlerTests.Handle_WithEmptyAttendees_ShouldReturnFailure [5 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationPropertyTests.RemoveLocation_WhenLocationDoesNotExist_ShouldFail [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationPropertyTests.Create_WithoutLocation_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationPropertyTests.HasLocation_WhenLocationSet_ShouldReturnTrue [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationPropertyTests.SetLocation_WithNullLocation_ShouldFail [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateRegistrationDetailsCommandHandlerTests.Handle_WithInvalidEmail_ShouldReturnFailure [5 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.DeleteProfilePhotoCommandHandlerTests.Handle_WhenImageDeletionFails_ShouldReturnFailure [9 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.CreateBusinessCommandHandlerTests.Handle_WithUsPhoneNumber_ShouldCreateBusinessWithCorrectContactInfo [17 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateRegistrationDetailsCommandHandlerTests.Handle_WithValidCommand_ShouldUpdateRegistration [5 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.CreateBusinessCommandHandlerTests.Handle_WithDifferentUsBusinessCategories_ShouldCreateSuccessfully(category: Healthcare) [2 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.CreateBusinessCommandHandlerTests.Handle_WithDifferentUsBusinessCategories_ShouldCreateSuccessfully(category: Services) [< 1 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.CreateBusinessCommandHandlerTests.Handle_WithDifferentUsBusinessCategories_ShouldCreateSuccessfully(category: Restaurant) [< 1 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.CreateBusinessCommandHandlerTests.Handle_WithDifferentUsBusinessCategories_ShouldCreateSuccessfully(category: Transportation) [< 1 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.ResetPasswordCommandHandlerTests.Handle_ShouldSendConfirmationEmailAsynchronously [332 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.CreateBusinessCommandHandlerTests.Handle_WithDifferentUsBusinessCategories_ShouldCreateSuccessfully(category: Retail) [< 1 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.DeleteProfilePhotoCommandHandlerTests.Handle_WhenUserHasNoPhoto_ShouldReturnFailure [8 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateRegistrationDetailsCommandHandlerTests.Handle_WhenRegistrationCancelled_ShouldReturnFailure [5 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationPropertyTests.Create_WithNullLocation_ShouldSucceed [14 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationPropertyTests.SetLocation_OnPublishedEvent_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationPropertyTests.SetLocation_WithValidLocation_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateRegistrationDetailsCommandHandlerTests.Handle_WhenUserNotRegistered_ShouldReturnFailure [5 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationPropertyTests.RemoveLocation_ConvertingToVirtualEvent_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationPropertyTests.HasLocation_WhenLocationNotSet_ShouldReturnFalse [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationPropertyTests.SetLocation_OnDraftEvent_ShouldSucceed [1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationPropertyTests.RemoveLocation_WhenLocationExists_ShouldSucceed [< 1 ms]
  Passed LankaConnect.Application.Tests.Events.Domain.EventLocationPropertyTests.SetLocation_WhenLocationAlreadySet_ShouldUpdateLocation [< 1 ms]
  Passed LankaConnect.Application.Tests.Behaviors.LoggingPipelineBehaviorTests.Handle_ShouldMeasureExecutionTime [736 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.CreateBusinessCommandHandlerTests.Handle_WithUsRestaurantCategory_ShouldSetCorrectCategory [13 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateRegistrationDetailsCommandHandlerTests.Handle_WithMoreThan10Attendees_ShouldReturnFailure [6 ms]
  Passed LankaConnect.Application.Tests.Users.Commands.DeleteProfilePhotoCommandHandlerTests.Handle_WithExistingPhoto_ShouldDeletePhotoAndUpdateUser [15 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.CreateBusinessCommandHandlerTests.Handle_WithUsCoordinates_ShouldCreateBusinessWithCorrectLocation [4 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.ResetPasswordCommandHandlerTests.Handle_WithValidTokenAndPassword_ShouldResetPassword [12 ms]
  Passed LankaConnect.Application.Tests.Behaviors.LoggingPipelineBehaviorTests.Handle_WithCancellationRequested_ShouldLogCancellation [8 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateRegistrationDetailsCommandHandlerTests.Handle_WithInvalidAttendeeName_ShouldReturnFailure [7 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.CreateBusinessCommandHandlerTests.Handle_WithUsAddress_ShouldCreateBusinessWithCorrectLocation [6 ms]
  Passed LankaConnect.Application.Tests.Events.Commands.UpdateRegistrationDetailsCommandHandlerTests.Handle_WhenEventNotFound_ShouldReturnFailure [4 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.ResetPasswordCommandHandlerTests.Handle_WithInvalidToken_ShouldReturnFailure [8 ms]
  Passed LankaConnect.Application.Tests.Behaviors.LoggingPipelineBehaviorTests.Handle_WithMultipleErrors_ShouldLogAllErrors [8 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.CreateBusinessCommandHandlerTests.Handle_WithCancellationToken_ShouldPassTokenToRepository [7 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.ResetPasswordCommandHandlerTests.Handle_WhenDatabaseThrowsException_ShouldReturnFailure [6 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.CreateBusinessCommandHandlerTests.Handle_WhenUnitOfWorkFails_ShouldPropagateException [5 ms]
  Passed LankaConnect.Application.Tests.Behaviors.LoggingPipelineBehaviorTests.Handle_ShouldIncludeRequestNameInLogs [10 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.ResetPasswordCommandHandlerTests.Handle_WhenPasswordHashingFails_ShouldReturnFailure [7 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.CreateBusinessCommandHandlerTests.Handle_WhenRepositoryThrowsException_ShouldPropagateException [5 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.CreateBusinessCommandHandlerTests.Handle_WithMinimumValidData_ShouldCreateBusinessSuccessfully [1 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.ResetPasswordCommandHandlerTests.Handle_WithNonExistentUser_ShouldReturnFailure [4 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.ResetPasswordCommandHandlerTests.Handle_WithInvalidEmail_ShouldReturnFailure [3 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.CreateBusinessCommandHandlerTests.Handle_WithComplexUsBusinessData_ShouldHandleAllProperties [5 ms]
  Passed LankaConnect.Application.Tests.Behaviors.LoggingPipelineBehaviorTests.Handle_WithSuccessfulRequest_ShouldLogStartAndComplete [13 ms]
  Passed LankaConnect.Application.Tests.Businesses.Commands.CreateBusinessCommandHandlerTests.Handle_WithValidUsBusinessCommand_ShouldCreateBusinessSuccessfully [7 ms]
  Passed LankaConnect.Application.Tests.Behaviors.LoggingPipelineBehaviorTests.Handle_WhenExceptionThrown_ShouldLogException [9 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.ResetPasswordCommandHandlerTests.Handle_ShouldRevokeAllRefreshTokens [16 ms]
  Passed LankaConnect.Application.Tests.Communications.Commands.ResetPasswordCommandHandlerTests.Handle_WithExpiredToken_ShouldReturnFailure [4 ms]
  Passed LankaConnect.Application.Tests.Behaviors.LoggingPipelineBehaviorTests.Handle_WithFailedRequest_ShouldLogStartCompleteAndError [11 ms]
  Passed LankaConnect.Application.Tests.ReferenceData.ReferenceDataServiceTests.GetByTypesAsync_ShouldRespectActiveOnlyFilter [423 ms]
  Passed LankaConnect.Application.Tests.ReferenceData.ReferenceDataServiceTests.GetByTypesAsync_ShouldMapMetadataCorrectly [9 ms]
  Passed LankaConnect.Application.Tests.ReferenceData.ReferenceDataServiceTests.GetByTypesAsync_ShouldReturnReferenceValues_WhenTypesExist [7 ms]
  Passed LankaConnect.Application.Tests.ReferenceData.ReferenceDataServiceTests.InvalidateCacheAsync_ShouldClearCache_ForSpecificType [6 ms]
  Passed LankaConnect.IntegrationTests.DummyTest.DummyTest_Should_Pass [4 s]
  Passed LankaConnect.Application.Tests.ReferenceData.ReferenceDataServiceTests.GetByTypesAsync_ShouldUseCachedData_OnSecondCall [13 ms]
  Passed LankaConnect.Application.Tests.ReferenceData.ReferenceDataServiceTests.GetByTypesAsync_ShouldReturnEmptyList_WhenNoDataExists [3 ms]
  Passed LankaConnect.Application.Tests.ReferenceData.ReferenceDataServiceTests.InvalidateAllCachesAsync_ShouldClearAllCaches [15 ms]
  Passed LankaConnect.Application.Tests.Events.Queries.GetEventRegistrationByEmailQueryHandlerTests.Handle_EmailIsNotRegistered_ReturnsFalse [2 s]
  Passed LankaConnect.Application.Tests.Events.Queries.GetEventRegistrationByEmailQueryHandlerTests.Handle_DifferentEventWithSameEmail_ReturnsFalse [9 ms]
  Passed LankaConnect.Application.Tests.Events.Queries.GetEventRegistrationByEmailQueryHandlerTests.Handle_NoRegistrationsForEvent_ReturnsFalse [9 ms]
  Passed LankaConnect.Application.Tests.Events.Queries.GetEventRegistrationByEmailQueryHandlerTests.Handle_EmailIsRegistered_ReturnsTrue [9 ms]
[xUnit.net 00:00:05.95]     LankaConnect.IntegrationTests.Repositories.UserRepositoryTests.GetByEmailAsync_WhenUserDoesNotExist_ShouldReturnNull [FAIL]
[xUnit.net 00:00:05.96]       System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
[xUnit.net 00:00:05.96]       Stack Trace:
[xUnit.net 00:00:05.96]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:05.96]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:05.96]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:05.96]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:05.96]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:05.96]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:05.96]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
[xUnit.net 00:00:05.96]            at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
[xUnit.net 00:00:05.96]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
[xUnit.net 00:00:05.96]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
[xUnit.net 00:00:05.96]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
[xUnit.net 00:00:05.96]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
[xUnit.net 00:00:05.96]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Repositories\UserRepositoryTests.cs(28,0): at LankaConnect.IntegrationTests.Repositories.UserRepositoryTests..ctor()
[xUnit.net 00:00:05.96]            at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean wrapExceptions)
[xUnit.net 00:00:05.96]     LankaConnect.IntegrationTests.Repositories.UserRepositoryTests.GetActiveUsersAsync_ShouldReturnOnlyActiveUsers [FAIL]
[xUnit.net 00:00:05.97]       System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
[xUnit.net 00:00:05.97]       Stack Trace:
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
[xUnit.net 00:00:05.97]            at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
[xUnit.net 00:00:05.97]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Repositories\UserRepositoryTests.cs(28,0): at LankaConnect.IntegrationTests.Repositories.UserRepositoryTests..ctor()
[xUnit.net 00:00:05.97]            at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean wrapExceptions)
[xUnit.net 00:00:05.97]     LankaConnect.IntegrationTests.Repositories.UserRepositoryTests.ExistsWithEmailAsync_WhenUserExists_ShouldReturnTrue [FAIL]
[xUnit.net 00:00:05.97]       System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
[xUnit.net 00:00:05.97]       Stack Trace:
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
[xUnit.net 00:00:05.97]            at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
[xUnit.net 00:00:05.97]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Repositories\UserRepositoryTests.cs(28,0): at LankaConnect.IntegrationTests.Repositories.UserRepositoryTests..ctor()
[xUnit.net 00:00:05.97]            at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean wrapExceptions)
[xUnit.net 00:00:05.97]     LankaConnect.IntegrationTests.Repositories.UserRepositoryTests.ExistsWithEmailAsync_WhenUserDoesNotExist_ShouldReturnFalse [FAIL]
[xUnit.net 00:00:05.97]       System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
[xUnit.net 00:00:05.97]       Stack Trace:
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:05.97]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:05.98]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:05.98]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:05.98]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:05.98]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:05.98]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
[xUnit.net 00:00:05.98]            at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
[xUnit.net 00:00:05.98]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
[xUnit.net 00:00:05.98]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
[xUnit.net 00:00:05.98]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
[xUnit.net 00:00:05.98]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
[xUnit.net 00:00:05.98]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Repositories\UserRepositoryTests.cs(28,0): at LankaConnect.IntegrationTests.Repositories.UserRepositoryTests..ctor()
[xUnit.net 00:00:05.98]            at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean wrapExceptions)
[xUnit.net 00:00:06.00]     LankaConnect.IntegrationTests.Repositories.UserRepositoryTests.GetByEmailAsync_WhenUserExists_ShouldReturnUser [FAIL]
[xUnit.net 00:00:06.00]       System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
[xUnit.net 00:00:06.00]       Stack Trace:
[xUnit.net 00:00:06.00]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:06.00]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:06.00]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:06.00]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:06.00]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:06.00]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:06.00]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
[xUnit.net 00:00:06.00]            at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
[xUnit.net 00:00:06.00]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
[xUnit.net 00:00:06.00]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
[xUnit.net 00:00:06.00]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
[xUnit.net 00:00:06.00]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
[xUnit.net 00:00:06.00]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Repositories\UserRepositoryTests.cs(28,0): at LankaConnect.IntegrationTests.Repositories.UserRepositoryTests..ctor()
[xUnit.net 00:00:06.00]            at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean wrapExceptions)
[xUnit.net 00:00:06.13]     LankaConnect.IntegrationTests.Storage.AzureBlobImageServiceIntegrationTests.GetSecureUrlAsync_InDevelopmentMode_ShouldReturnOriginalUrl [SKIP]
[xUnit.net 00:00:06.13]       AzureBlobImageService implementation not complete yet
[xUnit.net 00:00:06.13]     LankaConnect.IntegrationTests.Storage.AzureBlobImageServiceIntegrationTests.UploadImageAsync_WithLargeFile_ShouldFailValidation [SKIP]
[xUnit.net 00:00:06.13]       AzureBlobImageService implementation not complete yet
[xUnit.net 00:00:06.13]     LankaConnect.IntegrationTests.Storage.AzureBlobImageServiceIntegrationTests.UploadImageAsync_WithValidImage_ShouldUploadSuccessfully [SKIP]
[xUnit.net 00:00:06.13]       AzureBlobImageService implementation not complete yet
  Failed LankaConnect.IntegrationTests.Repositories.UserRepositoryTests.GetByEmailAsync_WhenUserDoesNotExist_ShouldReturnNull [1 ms]
  Error Message:
   System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
  Stack Trace:
     at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at LankaConnect.IntegrationTests.Repositories.UserRepositoryTests..ctor() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Repositories\UserRepositoryTests.cs:line 28
   at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean wrapExceptions)
  Failed LankaConnect.IntegrationTests.Repositories.UserRepositoryTests.GetActiveUsersAsync_ShouldReturnOnlyActiveUsers [1 ms]
  Error Message:
   System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
  Stack Trace:
     at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at LankaConnect.IntegrationTests.Repositories.UserRepositoryTests..ctor() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Repositories\UserRepositoryTests.cs:line 28
   at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean wrapExceptions)
  Failed LankaConnect.IntegrationTests.Repositories.UserRepositoryTests.ExistsWithEmailAsync_WhenUserExists_ShouldReturnTrue [1 ms]
  Error Message:
   System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
  Stack Trace:
     at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at LankaConnect.IntegrationTests.Repositories.UserRepositoryTests..ctor() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Repositories\UserRepositoryTests.cs:line 28
   at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean wrapExceptions)
  Failed LankaConnect.IntegrationTests.Repositories.UserRepositoryTests.ExistsWithEmailAsync_WhenUserDoesNotExist_ShouldReturnFalse [1 ms]
  Error Message:
   System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
  Stack Trace:
     at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at LankaConnect.IntegrationTests.Repositories.UserRepositoryTests..ctor() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Repositories\UserRepositoryTests.cs:line 28
   at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean wrapExceptions)
  Failed LankaConnect.IntegrationTests.Repositories.UserRepositoryTests.GetByEmailAsync_WhenUserExists_ShouldReturnUser [1 ms]
  Error Message:
   System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
  Stack Trace:
     at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at LankaConnect.IntegrationTests.Repositories.UserRepositoryTests..ctor() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Repositories\UserRepositoryTests.cs:line 28
   at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean wrapExceptions)
  Skipped LankaConnect.IntegrationTests.Storage.AzureBlobImageServiceIntegrationTests.GetSecureUrlAsync_InDevelopmentMode_ShouldReturnOriginalUrl [1 ms]
  Skipped LankaConnect.IntegrationTests.Storage.AzureBlobImageServiceIntegrationTests.UploadImageAsync_WithLargeFile_ShouldFailValidation [1 ms]
  Skipped LankaConnect.IntegrationTests.Storage.AzureBlobImageServiceIntegrationTests.UploadImageAsync_WithValidImage_ShouldUploadSuccessfully [1 ms]
[xUnit.net 00:00:06.14]     LankaConnect.IntegrationTests.Storage.AzureBlobImageServiceIntegrationTests.UploadImageAsync_ConcurrentUploads_ShouldHandleMultipleUploads [SKIP]
[xUnit.net 00:00:06.14]       AzureBlobImageService implementation not complete yet
[xUnit.net 00:00:06.14]     LankaConnect.IntegrationTests.Storage.AzureBlobImageServiceIntegrationTests.DeleteImageAsync_WithExistingImage_ShouldDeleteSuccessfully [SKIP]
[xUnit.net 00:00:06.14]       AzureBlobImageService implementation not complete yet
[xUnit.net 00:00:06.14]     LankaConnect.IntegrationTests.Storage.AzureBlobImageServiceIntegrationTests.ValidateImage_WithInvalidFileExtension_ShouldReturnFailure [SKIP]
[xUnit.net 00:00:06.14]       AzureBlobImageService implementation not complete yet
[xUnit.net 00:00:06.14]     LankaConnect.IntegrationTests.Storage.AzureBlobImageServiceIntegrationTests.ValidateImage_WithValidJpegBytes_ShouldReturnSuccess [SKIP]
[xUnit.net 00:00:06.14]       AzureBlobImageService implementation not complete yet
[xUnit.net 00:00:06.14]     LankaConnect.IntegrationTests.Storage.AzureBlobImageServiceIntegrationTests.ValidateImage_WithCorruptedImageData_ShouldReturnFailure [SKIP]
[xUnit.net 00:00:06.14]       AzureBlobImageService implementation not complete yet
[xUnit.net 00:00:06.14]     LankaConnect.IntegrationTests.Storage.AzureBlobImageServiceIntegrationTests.ResizeAndUploadAsync_WithValidImage_ShouldCreateMultipleSizes [SKIP]
[xUnit.net 00:00:06.14]       AzureBlobImageService implementation not complete yet
  Skipped LankaConnect.IntegrationTests.Storage.AzureBlobImageServiceIntegrationTests.UploadImageAsync_ConcurrentUploads_ShouldHandleMultipleUploads [1 ms]
  Skipped LankaConnect.IntegrationTests.Storage.AzureBlobImageServiceIntegrationTests.DeleteImageAsync_WithExistingImage_ShouldDeleteSuccessfully [1 ms]
  Skipped LankaConnect.IntegrationTests.Storage.AzureBlobImageServiceIntegrationTests.ValidateImage_WithInvalidFileExtension_ShouldReturnFailure [1 ms]
  Skipped LankaConnect.IntegrationTests.Storage.AzureBlobImageServiceIntegrationTests.ValidateImage_WithValidJpegBytes_ShouldReturnSuccess [1 ms]
  Skipped LankaConnect.IntegrationTests.Storage.AzureBlobImageServiceIntegrationTests.ValidateImage_WithCorruptedImageData_ShouldReturnFailure [1 ms]
  Skipped LankaConnect.IntegrationTests.Storage.AzureBlobImageServiceIntegrationTests.ResizeAndUploadAsync_WithValidImage_ShouldCreateMultipleSizes [1 ms]
  Passed LankaConnect.IntegrationTests.Controllers.EventsControllerSecurityTests.WaitingList_And_RSVP_Methods_Should_Not_Accept_UserId_Parameter(methodName: "RemoveFromWaitingList") [1 s]
  Passed LankaConnect.IntegrationTests.Controllers.EventsControllerSecurityTests.WaitingList_And_RSVP_Methods_Should_Not_Accept_UserId_Parameter(methodName: "CancelRsvp") [2 ms]
[xUnit.net 00:00:07.47]     LankaConnect.IntegrationTests.Repositories.SimplifiedEmailRepositoryTests.EmailTemplate_CreateWithCategory_ShouldPersistSuccessfully [FAIL]
[xUnit.net 00:00:07.47]       System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
[xUnit.net 00:00:07.47]       Stack Trace:
[xUnit.net 00:00:07.47]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:07.47]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.47]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:07.47]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.47]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.47]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.47]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
[xUnit.net 00:00:07.47]            at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
[xUnit.net 00:00:07.47]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
[xUnit.net 00:00:07.47]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
[xUnit.net 00:00:07.47]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
[xUnit.net 00:00:07.47]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
[xUnit.net 00:00:07.47]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(151,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync()
[xUnit.net 00:00:07.47]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(105,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync()
[xUnit.net 00:00:07.47]     LankaConnect.IntegrationTests.Repositories.SimplifiedEmailRepositoryTests.EmailRepositories_DependencyInjection_ShouldResolveCorrectly [FAIL]
[xUnit.net 00:00:07.47]       System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
[xUnit.net 00:00:07.47]       Stack Trace:
[xUnit.net 00:00:07.47]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:07.47]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
[xUnit.net 00:00:07.48]            at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
[xUnit.net 00:00:07.48]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(151,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync()
[xUnit.net 00:00:07.48]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(105,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync()
[xUnit.net 00:00:07.48]     LankaConnect.IntegrationTests.Repositories.EmailRepositoryIntegrationTests.AllEmailRepositories_DependencyInjection_ShouldResolveWithoutErrors [FAIL]
[xUnit.net 00:00:07.48]       System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
[xUnit.net 00:00:07.48]       Stack Trace:
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
[xUnit.net 00:00:07.48]            at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
[xUnit.net 00:00:07.48]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(151,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync()
[xUnit.net 00:00:07.48]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(105,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync()
[xUnit.net 00:00:07.48]     LankaConnect.IntegrationTests.Repositories.SimplifiedEmailRepositoryTests.EmailMessage_CreateWithEmailAddresses_ShouldPersistSuccessfully [FAIL]
[xUnit.net 00:00:07.48]       System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
[xUnit.net 00:00:07.48]       Stack Trace:
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
[xUnit.net 00:00:07.48]            at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
[xUnit.net 00:00:07.48]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(151,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync()
[xUnit.net 00:00:07.48]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(105,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync()
[xUnit.net 00:00:07.48]     LankaConnect.IntegrationTests.Repositories.EmailRepositoryIntegrationTests.EmailStatusRepository_CreateAndRetrieve_ShouldWork [FAIL]
[xUnit.net 00:00:07.48]       System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
[xUnit.net 00:00:07.48]       Stack Trace:
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.48]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:07.49]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.50]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.50]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.50]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
[xUnit.net 00:00:07.50]            at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
[xUnit.net 00:00:07.50]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
[xUnit.net 00:00:07.50]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
[xUnit.net 00:00:07.50]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
[xUnit.net 00:00:07.50]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
[xUnit.net 00:00:07.50]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(151,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync()
[xUnit.net 00:00:07.50]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(105,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync()
  Passed LankaConnect.IntegrationTests.Controllers.EventsControllerSecurityTests.WaitingList_And_RSVP_Methods_Should_Not_Accept_UserId_Parameter(methodName: "PromoteFromWaitingList") [< 1 ms]
  Passed LankaConnect.IntegrationTests.Controllers.EventsControllerSecurityTests.CancelRsvp_Should_Use_JWT_UserId_Not_Query_Parameter [71 ms]
  Failed LankaConnect.IntegrationTests.Repositories.SimplifiedEmailRepositoryTests.EmailTemplate_CreateWithCategory_ShouldPersistSuccessfully [1 ms]
  Error Message:
   System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
  Stack Trace:
     at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 151
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 105
  Failed LankaConnect.IntegrationTests.Repositories.SimplifiedEmailRepositoryTests.EmailRepositories_DependencyInjection_ShouldResolveCorrectly [1 ms]
  Error Message:
   System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
  Stack Trace:
     at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 151
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 105
  Failed LankaConnect.IntegrationTests.Repositories.EmailRepositoryIntegrationTests.AllEmailRepositories_DependencyInjection_ShouldResolveWithoutErrors [1 ms]
  Error Message:
   System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
  Stack Trace:
     at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 151
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 105
  Failed LankaConnect.IntegrationTests.Repositories.SimplifiedEmailRepositoryTests.EmailMessage_CreateWithEmailAddresses_ShouldPersistSuccessfully [1 ms]
  Error Message:
   System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
  Stack Trace:
     at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 151
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 105
  Failed LankaConnect.IntegrationTests.Repositories.EmailRepositoryIntegrationTests.EmailStatusRepository_CreateAndRetrieve_ShouldWork [1 ms]
  Error Message:
   System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
  Stack Trace:
     at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 151
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 105
[xUnit.net 00:00:07.52]     LankaConnect.IntegrationTests.Repositories.SimplifiedEmailRepositoryTests.EmailMessage_CompleteWorkflow_ShouldUpdateStatusCorrectly [FAIL]
[xUnit.net 00:00:07.52]       System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
[xUnit.net 00:00:07.52]       Stack Trace:
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
[xUnit.net 00:00:07.52]            at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
[xUnit.net 00:00:07.52]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(151,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync()
[xUnit.net 00:00:07.52]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(105,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync()
[xUnit.net 00:00:07.52]     LankaConnect.IntegrationTests.Repositories.EmailRepositoryIntegrationTests.EmailTemplateRepository_CreateAndRetrieve_ShouldWork [FAIL]
[xUnit.net 00:00:07.52]       System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
[xUnit.net 00:00:07.52]       Stack Trace:
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
[xUnit.net 00:00:07.52]            at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
[xUnit.net 00:00:07.52]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(151,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync()
[xUnit.net 00:00:07.52]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(105,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync()
[xUnit.net 00:00:07.52]     LankaConnect.IntegrationTests.Repositories.SimplifiedEmailRepositoryTests.EmailMessage_WithMultipleRecipients_ShouldPersistCorrectly [FAIL]
[xUnit.net 00:00:07.52]       System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
[xUnit.net 00:00:07.52]       Stack Trace:
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.52]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
[xUnit.net 00:00:07.52]            at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
[xUnit.net 00:00:07.53]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(151,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync()
[xUnit.net 00:00:07.53]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(105,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync()
[xUnit.net 00:00:07.53]     LankaConnect.IntegrationTests.Repositories.EmailRepositoryIntegrationTests.UserEmailPreferencesRepository_CreateAndRetrieve_ShouldWork [FAIL]
[xUnit.net 00:00:07.53]       System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
[xUnit.net 00:00:07.53]       Stack Trace:
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
[xUnit.net 00:00:07.53]            at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
[xUnit.net 00:00:07.53]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(151,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync()
[xUnit.net 00:00:07.53]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(105,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync()
[xUnit.net 00:00:07.53]     LankaConnect.IntegrationTests.Repositories.EmailRepositoryIntegrationTests.EmailMessageRepository_CreateAndRetrieve_ShouldWork [FAIL]
[xUnit.net 00:00:07.53]       System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
[xUnit.net 00:00:07.53]       Stack Trace:
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
[xUnit.net 00:00:07.53]            at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
[xUnit.net 00:00:07.53]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(151,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync()
[xUnit.net 00:00:07.53]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(105,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync()
[xUnit.net 00:00:07.53]     LankaConnect.IntegrationTests.Repositories.SimplifiedEmailRepositoryTests.EmailTemplate_CategoryMapping_ShouldWorkCorrectly [FAIL]
[xUnit.net 00:00:07.53]       System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
[xUnit.net 00:00:07.53]       Stack Trace:
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
[xUnit.net 00:00:07.53]            at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
[xUnit.net 00:00:07.53]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
[xUnit.net 00:00:07.53]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(151,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync()
[xUnit.net 00:00:07.53]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(105,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Repositories.SimplifiedEmailRepositoryTests.EmailMessage_CompleteWorkflow_ShouldUpdateStatusCorrectly [1 ms]
  Error Message:
   System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
  Stack Trace:
     at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 151
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 105
  Failed LankaConnect.IntegrationTests.Repositories.EmailRepositoryIntegrationTests.EmailTemplateRepository_CreateAndRetrieve_ShouldWork [1 ms]
  Error Message:
   System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
  Stack Trace:
     at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 151
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 105
  Failed LankaConnect.IntegrationTests.Repositories.SimplifiedEmailRepositoryTests.EmailMessage_WithMultipleRecipients_ShouldPersistCorrectly [1 ms]
  Error Message:
   System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
  Stack Trace:
     at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 151
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 105
  Failed LankaConnect.IntegrationTests.Repositories.EmailRepositoryIntegrationTests.UserEmailPreferencesRepository_CreateAndRetrieve_ShouldWork [1 ms]
  Error Message:
   System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
  Stack Trace:
     at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 151
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 105
  Failed LankaConnect.IntegrationTests.Repositories.EmailRepositoryIntegrationTests.EmailMessageRepository_CreateAndRetrieve_ShouldWork [1 ms]
  Error Message:
   System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
  Stack Trace:
     at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 151
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 105
  Failed LankaConnect.IntegrationTests.Repositories.SimplifiedEmailRepositoryTests.EmailTemplate_CategoryMapping_ShouldWorkCorrectly [1 ms]
  Error Message:
   System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
  Stack Trace:
     at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 151
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 105
  Passed LankaConnect.IntegrationTests.Controllers.EventsControllerSecurityTests.AddToWaitingList_Should_Require_Authorization [1 s]
[xUnit.net 00:00:08.34]     LankaConnect.IntegrationTests.Controllers.EventsControllerSecurityTests.GetMyRsvps_Should_Use_JWT_UserId_Not_Query_Parameter [FAIL]
[xUnit.net 00:00:08.34]       System.NullReferenceException : Object reference not set to an instance of an object.
[xUnit.net 00:00:08.34]       Stack Trace:
[xUnit.net 00:00:08.34]         C:\Work\LankaConnect\src\LankaConnect.API\Controllers\BaseController.cs(24,0): at LankaConnect.API.Controllers.BaseController`1.HandleResult[TResult](Result`1 result)
[xUnit.net 00:00:08.34]         C:\Work\LankaConnect\src\LankaConnect.API\Controllers\EventsController.cs(845,0): at LankaConnect.API.Controllers.EventsController.GetMyRsvps(String searchTerm, Nullable`1 category, Nullable`1 startDateFrom, Nullable`1 startDateTo, String state, List`1 metroAreaIds)
[xUnit.net 00:00:08.34]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Controllers\EventsControllerSecurityTests.cs(155,0): at LankaConnect.IntegrationTests.Controllers.EventsControllerSecurityTests.GetMyRsvps_Should_Use_JWT_UserId_Not_Query_Parameter()
[xUnit.net 00:00:08.34]         --- End of stack trace from previous location ---
[xUnit.net 00:00:08.39]     LankaConnect.IntegrationTests.Controllers.EventsControllerSecurityTests.User_Query_Methods_Should_Not_Accept_UserId_Parameter(methodName: "GetMyRsvps") [FAIL]
[xUnit.net 00:00:08.39]       Assert.Empty() Failure: Collection was not empty
[xUnit.net 00:00:08.39]       Collection: [System.String searchTerm, System.Nullable`1[LankaConnect.Domain.Events.Enums.EventCategory] category, System.Nullable`1[System.DateTime] startDateFrom, System.Nullable`1[System.DateTime] startDateTo, System.String state, ···]
[xUnit.net 00:00:08.39]       Stack Trace:
[xUnit.net 00:00:08.39]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Controllers\EventsControllerSecurityTests.cs(232,0): at LankaConnect.IntegrationTests.Controllers.EventsControllerSecurityTests.User_Query_Methods_Should_Not_Accept_UserId_Parameter(String methodName)
[xUnit.net 00:00:08.39]            at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
[xUnit.net 00:00:08.39]            at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
  Failed LankaConnect.IntegrationTests.Controllers.EventsControllerSecurityTests.GetMyRsvps_Should_Use_JWT_UserId_Not_Query_Parameter [21 ms]
  Error Message:
   System.NullReferenceException : Object reference not set to an instance of an object.
  Stack Trace:
     at LankaConnect.API.Controllers.BaseController`1.HandleResult[TResult](Result`1 result) in C:\Work\LankaConnect\src\LankaConnect.API\Controllers\BaseController.cs:line 24
   at LankaConnect.API.Controllers.EventsController.GetMyRsvps(String searchTerm, Nullable`1 category, Nullable`1 startDateFrom, Nullable`1 startDateTo, String state, List`1 metroAreaIds) in C:\Work\LankaConnect\src\LankaConnect.API\Controllers\EventsController.cs:line 845
   at LankaConnect.IntegrationTests.Controllers.EventsControllerSecurityTests.GetMyRsvps_Should_Use_JWT_UserId_Not_Query_Parameter() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Controllers\EventsControllerSecurityTests.cs:line 155
--- End of stack trace from previous location ---
  Passed LankaConnect.IntegrationTests.Controllers.EventsControllerSecurityTests.GetUpcomingEvents_Should_Use_JWT_UserId_Not_Query_Parameter [7 ms]
  Passed LankaConnect.IntegrationTests.Controllers.EventsControllerSecurityTests.AddToWaitingList_Should_Use_JWT_UserId_Not_Query_Parameter [8 ms]
  Passed LankaConnect.IntegrationTests.Controllers.EventsControllerSecurityTests.PromoteFromWaitingList_Should_Use_JWT_UserId_Not_Query_Parameter [8 ms]
  Passed LankaConnect.IntegrationTests.Controllers.EventsControllerSecurityTests.AddToWaitingList_Should_Not_Have_UserId_Query_Parameter [17 ms]
  Failed LankaConnect.IntegrationTests.Controllers.EventsControllerSecurityTests.User_Query_Methods_Should_Not_Accept_UserId_Parameter(methodName: "GetMyRsvps") [5 ms]
  Error Message:
   Assert.Empty() Failure: Collection was not empty
Collection: [System.String searchTerm, System.Nullable`1[LankaConnect.Domain.Events.Enums.EventCategory] category, System.Nullable`1[System.DateTime] startDateFrom, System.Nullable`1[System.DateTime] startDateTo, System.String state, ···]
  Stack Trace:
     at LankaConnect.IntegrationTests.Controllers.EventsControllerSecurityTests.User_Query_Methods_Should_Not_Accept_UserId_Parameter(String methodName) in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Controllers\EventsControllerSecurityTests.cs:line 232
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
  Passed LankaConnect.IntegrationTests.Controllers.EventsControllerSecurityTests.User_Query_Methods_Should_Not_Accept_UserId_Parameter(methodName: "GetUpcomingEvents") [< 1 ms]
  Passed LankaConnect.IntegrationTests.Controllers.EventsControllerSecurityTests.RemoveFromWaitingList_Should_Use_JWT_UserId_Not_Query_Parameter [6 ms]
[xUnit.net 00:00:10.61]     LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests.Database_CanConnect_Successfully [FAIL]
[xUnit.net 00:00:10.61]       System.ArgumentException : Docker is either not running or misconfigured. Please ensure that Docker is running and that the endpoint is properly configured. You can customize your configuration using either the environment variables or the ~/.testcontainers.properties file. For more information, visit:
https://dotnet.testcontainers.org/custom_configuration/ (Parameter 'DockerEndpointAuthConfig')
[xUnit.net 00:00:10.61]       Stack Trace:
[xUnit.net 00:00:10.61]         /_/src/Testcontainers/Guard.Null.cs(62,0): at DotNet.Testcontainers.Guard.ThrowIf[TType](ArgumentInfo`1& argument, Func`2 condition, Func`2 ifClause)
[xUnit.net 00:00:10.61]         /_/src/Testcontainers/Builders/AbstractBuilder`4.cs(145,0): at DotNet.Testcontainers.Builders.AbstractBuilder`4.Validate()
[xUnit.net 00:00:10.61]         /_/src/Testcontainers/Builders/ContainerBuilder`3.cs(383,0): at DotNet.Testcontainers.Builders.ContainerBuilder`3.Validate()
[xUnit.net 00:00:10.61]         /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs(101,0): at Testcontainers.PostgreSql.PostgreSqlBuilder.Validate()
[xUnit.net 00:00:10.61]         /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs(75,0): at Testcontainers.PostgreSql.PostgreSqlBuilder.Build()
[xUnit.net 00:00:10.61]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DatabaseConnectivityTests.cs(15,0): at LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests..ctor()
[xUnit.net 00:00:10.61]            at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean wrapExceptions)
[xUnit.net 00:00:10.61]     LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests.Database_HasCorrectTables_AfterMigration [FAIL]
[xUnit.net 00:00:10.61]       System.ArgumentException : Docker is either not running or misconfigured. Please ensure that Docker is running and that the endpoint is properly configured. You can customize your configuration using either the environment variables or the ~/.testcontainers.properties file. For more information, visit:
https://dotnet.testcontainers.org/custom_configuration/ (Parameter 'DockerEndpointAuthConfig')
[xUnit.net 00:00:10.61]       Stack Trace:
[xUnit.net 00:00:10.61]         /_/src/Testcontainers/Guard.Null.cs(62,0): at DotNet.Testcontainers.Guard.ThrowIf[TType](ArgumentInfo`1& argument, Func`2 condition, Func`2 ifClause)
[xUnit.net 00:00:10.61]         /_/src/Testcontainers/Builders/AbstractBuilder`4.cs(145,0): at DotNet.Testcontainers.Builders.AbstractBuilder`4.Validate()
[xUnit.net 00:00:10.61]         /_/src/Testcontainers/Builders/ContainerBuilder`3.cs(383,0): at DotNet.Testcontainers.Builders.ContainerBuilder`3.Validate()
[xUnit.net 00:00:10.61]         /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs(101,0): at Testcontainers.PostgreSql.PostgreSqlBuilder.Validate()
[xUnit.net 00:00:10.61]         /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs(75,0): at Testcontainers.PostgreSql.PostgreSqlBuilder.Build()
[xUnit.net 00:00:10.61]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DatabaseConnectivityTests.cs(15,0): at LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests..ctor()
[xUnit.net 00:00:10.61]            at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean wrapExceptions)
[xUnit.net 00:00:10.61]     LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests.Database_ConnectionPool_WorksCorrectly [FAIL]
[xUnit.net 00:00:10.61]       System.ArgumentException : Docker is either not running or misconfigured. Please ensure that Docker is running and that the endpoint is properly configured. You can customize your configuration using either the environment variables or the ~/.testcontainers.properties file. For more information, visit:
https://dotnet.testcontainers.org/custom_configuration/ (Parameter 'DockerEndpointAuthConfig')
[xUnit.net 00:00:10.61]       Stack Trace:
[xUnit.net 00:00:10.61]         /_/src/Testcontainers/Guard.Null.cs(62,0): at DotNet.Testcontainers.Guard.ThrowIf[TType](ArgumentInfo`1& argument, Func`2 condition, Func`2 ifClause)
[xUnit.net 00:00:10.61]         /_/src/Testcontainers/Builders/AbstractBuilder`4.cs(145,0): at DotNet.Testcontainers.Builders.AbstractBuilder`4.Validate()
[xUnit.net 00:00:10.61]         /_/src/Testcontainers/Builders/ContainerBuilder`3.cs(383,0): at DotNet.Testcontainers.Builders.ContainerBuilder`3.Validate()
[xUnit.net 00:00:10.62]         /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs(101,0): at Testcontainers.PostgreSql.PostgreSqlBuilder.Validate()
[xUnit.net 00:00:10.62]         /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs(75,0): at Testcontainers.PostgreSql.PostgreSqlBuilder.Build()
[xUnit.net 00:00:10.62]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DatabaseConnectivityTests.cs(15,0): at LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests..ctor()
[xUnit.net 00:00:10.62]            at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean wrapExceptions)
[xUnit.net 00:00:10.62]     LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests.Database_HandlesConnectionFailure_Gracefully [FAIL]
[xUnit.net 00:00:10.62]       System.ArgumentException : Docker is either not running or misconfigured. Please ensure that Docker is running and that the endpoint is properly configured. You can customize your configuration using either the environment variables or the ~/.testcontainers.properties file. For more information, visit:
https://dotnet.testcontainers.org/custom_configuration/ (Parameter 'DockerEndpointAuthConfig')
[xUnit.net 00:00:10.62]       Stack Trace:
[xUnit.net 00:00:10.62]         /_/src/Testcontainers/Guard.Null.cs(62,0): at DotNet.Testcontainers.Guard.ThrowIf[TType](ArgumentInfo`1& argument, Func`2 condition, Func`2 ifClause)
[xUnit.net 00:00:10.62]         /_/src/Testcontainers/Builders/AbstractBuilder`4.cs(145,0): at DotNet.Testcontainers.Builders.AbstractBuilder`4.Validate()
[xUnit.net 00:00:10.62]         /_/src/Testcontainers/Builders/ContainerBuilder`3.cs(383,0): at DotNet.Testcontainers.Builders.ContainerBuilder`3.Validate()
[xUnit.net 00:00:10.62]         /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs(101,0): at Testcontainers.PostgreSql.PostgreSqlBuilder.Validate()
[xUnit.net 00:00:10.62]         /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs(75,0): at Testcontainers.PostgreSql.PostgreSqlBuilder.Build()
[xUnit.net 00:00:10.62]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DatabaseConnectivityTests.cs(15,0): at LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests..ctor()
[xUnit.net 00:00:10.62]            at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean wrapExceptions)
[xUnit.net 00:00:10.62]     LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests.Database_CanExecuteTransaction_Successfully [FAIL]
[xUnit.net 00:00:10.62]       System.ArgumentException : Docker is either not running or misconfigured. Please ensure that Docker is running and that the endpoint is properly configured. You can customize your configuration using either the environment variables or the ~/.testcontainers.properties file. For more information, visit:
https://dotnet.testcontainers.org/custom_configuration/ (Parameter 'DockerEndpointAuthConfig')
[xUnit.net 00:00:10.62]       Stack Trace:
[xUnit.net 00:00:10.62]         /_/src/Testcontainers/Guard.Null.cs(62,0): at DotNet.Testcontainers.Guard.ThrowIf[TType](ArgumentInfo`1& argument, Func`2 condition, Func`2 ifClause)
[xUnit.net 00:00:10.62]         /_/src/Testcontainers/Builders/AbstractBuilder`4.cs(145,0): at DotNet.Testcontainers.Builders.AbstractBuilder`4.Validate()
[xUnit.net 00:00:10.62]         /_/src/Testcontainers/Builders/ContainerBuilder`3.cs(383,0): at DotNet.Testcontainers.Builders.ContainerBuilder`3.Validate()
[xUnit.net 00:00:10.62]         /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs(101,0): at Testcontainers.PostgreSql.PostgreSqlBuilder.Validate()
[xUnit.net 00:00:10.62]         /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs(75,0): at Testcontainers.PostgreSql.PostgreSqlBuilder.Build()
[xUnit.net 00:00:10.62]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DatabaseConnectivityTests.cs(15,0): at LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests..ctor()
[xUnit.net 00:00:10.62]            at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean wrapExceptions)
[xUnit.net 00:00:10.62]     LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests.Database_CommandTimeout_WorksCorrectly [FAIL]
[xUnit.net 00:00:10.62]       System.ArgumentException : Docker is either not running or misconfigured. Please ensure that Docker is running and that the endpoint is properly configured. You can customize your configuration using either the environment variables or the ~/.testcontainers.properties file. For more information, visit:
https://dotnet.testcontainers.org/custom_configuration/ (Parameter 'DockerEndpointAuthConfig')
[xUnit.net 00:00:10.62]       Stack Trace:
[xUnit.net 00:00:10.62]         /_/src/Testcontainers/Guard.Null.cs(62,0): at DotNet.Testcontainers.Guard.ThrowIf[TType](ArgumentInfo`1& argument, Func`2 condition, Func`2 ifClause)
[xUnit.net 00:00:10.62]         /_/src/Testcontainers/Builders/AbstractBuilder`4.cs(145,0): at DotNet.Testcontainers.Builders.AbstractBuilder`4.Validate()
[xUnit.net 00:00:10.62]         /_/src/Testcontainers/Builders/ContainerBuilder`3.cs(383,0): at DotNet.Testcontainers.Builders.ContainerBuilder`3.Validate()
[xUnit.net 00:00:10.62]         /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs(101,0): at Testcontainers.PostgreSql.PostgreSqlBuilder.Validate()
[xUnit.net 00:00:10.62]         /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs(75,0): at Testcontainers.PostgreSql.PostgreSqlBuilder.Build()
[xUnit.net 00:00:10.62]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DatabaseConnectivityTests.cs(15,0): at LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests..ctor()
[xUnit.net 00:00:10.62]            at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean wrapExceptions)
[xUnit.net 00:00:10.63]     LankaConnect.IntegrationTests.RepositoryDIValidationTest.EmailTemplateRepository_WithProperDISetup_ShouldCreateWithoutDIErrors [FAIL]
[xUnit.net 00:00:10.63]       System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
[xUnit.net 00:00:10.63]       Stack Trace:
[xUnit.net 00:00:10.63]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:10.63]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:10.63]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:10.63]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:10.63]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:10.63]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:10.63]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:10.63]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:10.63]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:10.63]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:10.63]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:10.64]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:10.64]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
[xUnit.net 00:00:10.64]            at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
[xUnit.net 00:00:10.64]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
[xUnit.net 00:00:10.64]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
[xUnit.net 00:00:10.64]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
[xUnit.net 00:00:10.64]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
[xUnit.net 00:00:10.64]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\RepositoryDIValidationTest.cs(106,0): at LankaConnect.IntegrationTests.RepositoryDIValidationTest.EmailTemplateRepository_WithProperDISetup_ShouldCreateWithoutDIErrors()
[xUnit.net 00:00:10.64]         --- End of stack trace from previous location ---
[xUnit.net 00:00:10.64]     LankaConnect.IntegrationTests.RepositoryDIValidationTest.ServiceCollection_WithProperEFCoreSetup_ShouldResolveRepositoriesWithoutDIErrors [FAIL]
[xUnit.net 00:00:10.64]       System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
[xUnit.net 00:00:10.64]       Stack Trace:
[xUnit.net 00:00:10.64]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:10.64]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:10.64]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:10.64]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:10.64]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:10.64]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:10.64]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:10.64]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:10.64]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:10.64]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:10.64]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:10.64]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:10.64]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
[xUnit.net 00:00:10.64]            at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
[xUnit.net 00:00:10.64]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
[xUnit.net 00:00:10.64]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
[xUnit.net 00:00:10.65]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
[xUnit.net 00:00:10.65]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
[xUnit.net 00:00:10.65]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\RepositoryDIValidationTest.cs(62,0): at LankaConnect.IntegrationTests.RepositoryDIValidationTest.ServiceCollection_WithProperEFCoreSetup_ShouldResolveRepositoriesWithoutDIErrors()
[xUnit.net 00:00:10.65]            at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
[xUnit.net 00:00:10.65]            at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
  Failed LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests.Database_CanConnect_Successfully [1 ms]
  Error Message:
   System.ArgumentException : Docker is either not running or misconfigured. Please ensure that Docker is running and that the endpoint is properly configured. You can customize your configuration using either the environment variables or the ~/.testcontainers.properties file. For more information, visit:
https://dotnet.testcontainers.org/custom_configuration/ (Parameter 'DockerEndpointAuthConfig')
  Stack Trace:
     at DotNet.Testcontainers.Guard.ThrowIf[TType](ArgumentInfo`1& argument, Func`2 condition, Func`2 ifClause) in /_/src/Testcontainers/Guard.Null.cs:line 62
   at DotNet.Testcontainers.Builders.AbstractBuilder`4.Validate() in /_/src/Testcontainers/Builders/AbstractBuilder`4.cs:line 145
   at DotNet.Testcontainers.Builders.ContainerBuilder`3.Validate() in /_/src/Testcontainers/Builders/ContainerBuilder`3.cs:line 383
   at Testcontainers.PostgreSql.PostgreSqlBuilder.Validate() in /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs:line 101
   at Testcontainers.PostgreSql.PostgreSqlBuilder.Build() in /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs:line 75
   at LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests..ctor() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DatabaseConnectivityTests.cs:line 15
   at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean wrapExceptions)
  Failed LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests.Database_HasCorrectTables_AfterMigration [1 ms]
  Error Message:
   System.ArgumentException : Docker is either not running or misconfigured. Please ensure that Docker is running and that the endpoint is properly configured. You can customize your configuration using either the environment variables or the ~/.testcontainers.properties file. For more information, visit:
https://dotnet.testcontainers.org/custom_configuration/ (Parameter 'DockerEndpointAuthConfig')
  Stack Trace:
     at DotNet.Testcontainers.Guard.ThrowIf[TType](ArgumentInfo`1& argument, Func`2 condition, Func`2 ifClause) in /_/src/Testcontainers/Guard.Null.cs:line 62
   at DotNet.Testcontainers.Builders.AbstractBuilder`4.Validate() in /_/src/Testcontainers/Builders/AbstractBuilder`4.cs:line 145
   at DotNet.Testcontainers.Builders.ContainerBuilder`3.Validate() in /_/src/Testcontainers/Builders/ContainerBuilder`3.cs:line 383
   at Testcontainers.PostgreSql.PostgreSqlBuilder.Validate() in /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs:line 101
   at Testcontainers.PostgreSql.PostgreSqlBuilder.Build() in /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs:line 75
   at LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests..ctor() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DatabaseConnectivityTests.cs:line 15
   at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean wrapExceptions)
  Failed LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests.Database_ConnectionPool_WorksCorrectly [1 ms]
  Error Message:
   System.ArgumentException : Docker is either not running or misconfigured. Please ensure that Docker is running and that the endpoint is properly configured. You can customize your configuration using either the environment variables or the ~/.testcontainers.properties file. For more information, visit:
https://dotnet.testcontainers.org/custom_configuration/ (Parameter 'DockerEndpointAuthConfig')
  Stack Trace:
     at DotNet.Testcontainers.Guard.ThrowIf[TType](ArgumentInfo`1& argument, Func`2 condition, Func`2 ifClause) in /_/src/Testcontainers/Guard.Null.cs:line 62
   at DotNet.Testcontainers.Builders.AbstractBuilder`4.Validate() in /_/src/Testcontainers/Builders/AbstractBuilder`4.cs:line 145
   at DotNet.Testcontainers.Builders.ContainerBuilder`3.Validate() in /_/src/Testcontainers/Builders/ContainerBuilder`3.cs:line 383
   at Testcontainers.PostgreSql.PostgreSqlBuilder.Validate() in /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs:line 101
   at Testcontainers.PostgreSql.PostgreSqlBuilder.Build() in /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs:line 75
   at LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests..ctor() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DatabaseConnectivityTests.cs:line 15
   at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean wrapExceptions)
  Failed LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests.Database_HandlesConnectionFailure_Gracefully [1 ms]
  Error Message:
   System.ArgumentException : Docker is either not running or misconfigured. Please ensure that Docker is running and that the endpoint is properly configured. You can customize your configuration using either the environment variables or the ~/.testcontainers.properties file. For more information, visit:
https://dotnet.testcontainers.org/custom_configuration/ (Parameter 'DockerEndpointAuthConfig')
  Stack Trace:
     at DotNet.Testcontainers.Guard.ThrowIf[TType](ArgumentInfo`1& argument, Func`2 condition, Func`2 ifClause) in /_/src/Testcontainers/Guard.Null.cs:line 62
   at DotNet.Testcontainers.Builders.AbstractBuilder`4.Validate() in /_/src/Testcontainers/Builders/AbstractBuilder`4.cs:line 145
   at DotNet.Testcontainers.Builders.ContainerBuilder`3.Validate() in /_/src/Testcontainers/Builders/ContainerBuilder`3.cs:line 383
   at Testcontainers.PostgreSql.PostgreSqlBuilder.Validate() in /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs:line 101
   at Testcontainers.PostgreSql.PostgreSqlBuilder.Build() in /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs:line 75
   at LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests..ctor() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DatabaseConnectivityTests.cs:line 15
   at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean wrapExceptions)
  Failed LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests.Database_CanExecuteTransaction_Successfully [1 ms]
  Error Message:
   System.ArgumentException : Docker is either not running or misconfigured. Please ensure that Docker is running and that the endpoint is properly configured. You can customize your configuration using either the environment variables or the ~/.testcontainers.properties file. For more information, visit:
https://dotnet.testcontainers.org/custom_configuration/ (Parameter 'DockerEndpointAuthConfig')
  Stack Trace:
     at DotNet.Testcontainers.Guard.ThrowIf[TType](ArgumentInfo`1& argument, Func`2 condition, Func`2 ifClause) in /_/src/Testcontainers/Guard.Null.cs:line 62
   at DotNet.Testcontainers.Builders.AbstractBuilder`4.Validate() in /_/src/Testcontainers/Builders/AbstractBuilder`4.cs:line 145
   at DotNet.Testcontainers.Builders.ContainerBuilder`3.Validate() in /_/src/Testcontainers/Builders/ContainerBuilder`3.cs:line 383
   at Testcontainers.PostgreSql.PostgreSqlBuilder.Validate() in /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs:line 101
   at Testcontainers.PostgreSql.PostgreSqlBuilder.Build() in /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs:line 75
   at LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests..ctor() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DatabaseConnectivityTests.cs:line 15
   at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean wrapExceptions)
  Failed LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests.Database_CommandTimeout_WorksCorrectly [1 ms]
  Error Message:
   System.ArgumentException : Docker is either not running or misconfigured. Please ensure that Docker is running and that the endpoint is properly configured. You can customize your configuration using either the environment variables or the ~/.testcontainers.properties file. For more information, visit:
https://dotnet.testcontainers.org/custom_configuration/ (Parameter 'DockerEndpointAuthConfig')
  Stack Trace:
     at DotNet.Testcontainers.Guard.ThrowIf[TType](ArgumentInfo`1& argument, Func`2 condition, Func`2 ifClause) in /_/src/Testcontainers/Guard.Null.cs:line 62
   at DotNet.Testcontainers.Builders.AbstractBuilder`4.Validate() in /_/src/Testcontainers/Builders/AbstractBuilder`4.cs:line 145
   at DotNet.Testcontainers.Builders.ContainerBuilder`3.Validate() in /_/src/Testcontainers/Builders/ContainerBuilder`3.cs:line 383
   at Testcontainers.PostgreSql.PostgreSqlBuilder.Validate() in /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs:line 101
   at Testcontainers.PostgreSql.PostgreSqlBuilder.Build() in /_/src/Testcontainers.PostgreSql/PostgreSqlBuilder.cs:line 75
   at LankaConnect.IntegrationTests.Infrastructure.DatabaseConnectivityTests..ctor() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DatabaseConnectivityTests.cs:line 15
   at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean wrapExceptions)
  Failed LankaConnect.IntegrationTests.RepositoryDIValidationTest.EmailTemplateRepository_WithProperDISetup_ShouldCreateWithoutDIErrors [7 ms]
  Error Message:
   System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
  Stack Trace:
     at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at LankaConnect.IntegrationTests.RepositoryDIValidationTest.EmailTemplateRepository_WithProperDISetup_ShouldCreateWithoutDIErrors() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\RepositoryDIValidationTest.cs:line 106
--- End of stack trace from previous location ---
  Failed LankaConnect.IntegrationTests.RepositoryDIValidationTest.ServiceCollection_WithProperEFCoreSetup_ShouldResolveRepositoriesWithoutDIErrors [5 ms]
  Error Message:
   System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
  Stack Trace:
     at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at LankaConnect.IntegrationTests.RepositoryDIValidationTest.ServiceCollection_WithProperEFCoreSetup_ShouldResolveRepositoriesWithoutDIErrors() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\RepositoryDIValidationTest.cs:line 62
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
2026-01-24 08:36:32.567 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:32.567 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:32.567 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:32.567 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:32.567 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:32.567 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:32.567 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:35.003 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:35.003 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:35.003 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:35.003 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:35.003 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:35.003 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:35.003 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:35.007 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:35.008 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:35.008 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:35.008 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:35.007 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:35.007 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:35.007 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:35.010 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:35.010 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:35.010 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:35.010 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:35.011 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:35.011 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:35.011 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:35.011 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:35.011 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:35.011 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:35.011 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:35.011 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:35.011 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:35.012 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:35.012 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:35.012 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:35.012 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:35.012 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:35.012 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:35.013 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:35.013 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:35.013 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:35.013 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:35.013 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:35.013 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:35.013 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:35.013 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:35.013 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:35.014 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:35.014 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:35.014 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:35.014 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:35.014 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:35.014 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:35.014 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:35.014 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:35.015 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:35.015 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:35.015 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:35.015 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:35.015 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:35.016 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:35.016 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:35.016 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:35.016 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:35.016 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:35.016 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:35.016 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:35.017 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:35.015 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:35.016 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:35.017 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:35.015 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:35.015 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:35.017 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:35.015 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:35.495 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:35.495 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:35.495 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:35.495 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:35.495 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:35.495 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:35.495 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:35.496 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:35.496 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:35.496 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:35.496 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:35.496 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:35.497 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:35.497 -05:00 [INF]  Program: Applying database migrations...
[xUnit.net 00:00:15.49]   Finished:    LankaConnect.Application.Tests
  Passed LankaConnect.Application.Tests.Common.ImportResolution.UserIdImportTests.Application_Should_Resolve_UserId_From_Domain_Layer [13 s]

Test Run Successful.
Total tests: 1191
     Passed: 1190
    Skipped: 1
 Total time: 16.7109 Seconds
2026-01-24 08:36:38.812 -05:00 [WRN]  Microsoft.EntityFrameworkCore.Model: The entity type 'EventCategoryRef' was first mapped explicitly and then ignored. Consider not mapping the entity type in the first place.
warn: 1/24/2026 08:36:38.823 CoreEventId.MappedEntityTypeIgnoredWarning[10626] (Microsoft.EntityFrameworkCore.Model) 
      The entity type 'EventCategoryRef' was first mapped explicitly and then ignored. Consider not mapping the entity type in the first place.
2026-01-24 08:36:38.825 -05:00 [WRN]  Microsoft.EntityFrameworkCore.Model: The entity type 'EventStatusRef' was first mapped explicitly and then ignored. Consider not mapping the entity type in the first place.
warn: 1/24/2026 08:36:38.826 CoreEventId.MappedEntityTypeIgnoredWarning[10626] (Microsoft.EntityFrameworkCore.Model) 
      The entity type 'EventStatusRef' was first mapped explicitly and then ignored. Consider not mapping the entity type in the first place.
2026-01-24 08:36:38.826 -05:00 [WRN]  Microsoft.EntityFrameworkCore.Model: The entity type 'UserRoleRef' was first mapped explicitly and then ignored. Consider not mapping the entity type in the first place.
warn: 1/24/2026 08:36:38.826 CoreEventId.MappedEntityTypeIgnoredWarning[10626] (Microsoft.EntityFrameworkCore.Model) 
      The entity type 'UserRoleRef' was first mapped explicitly and then ignored. Consider not mapping the entity type in the first place.
[xUnit.net 00:00:18.91]     LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.Redis_Container_IsAccessible [FAIL]
[xUnit.net 00:00:18.91]       StackExchange.Redis.RedisConnectionException : It was not possible to connect to the redis server(s). Error connecting right now. To allow this multiplexer to continue retrying until it's able to connect, use abortConnect=false in your connection string or AbortOnConnectFail=false; in your code.
[xUnit.net 00:00:18.91]       Stack Trace:
[xUnit.net 00:00:18.91]         /_/src/StackExchange.Redis/ConnectionMultiplexer.cs(716,0): at StackExchange.Redis.ConnectionMultiplexer.ConnectImpl(ConfigurationOptions configuration, TextWriter writer, Nullable`1 serverType, EndPointCollection endpoints)
[xUnit.net 00:00:18.91]         /_/src/StackExchange.Redis/ConnectionMultiplexer.cs(678,0): at StackExchange.Redis.ConnectionMultiplexer.Connect(ConfigurationOptions configuration, TextWriter log)
[xUnit.net 00:00:18.91]         /_/src/StackExchange.Redis/ConnectionMultiplexer.cs(656,0): at StackExchange.Redis.ConnectionMultiplexer.Connect(String configuration, TextWriter log)
[xUnit.net 00:00:18.91]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DockerConnectivityTests.cs(56,0): at LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.Redis_Container_IsAccessible()
[xUnit.net 00:00:18.91]         --- End of stack trace from previous location ---
  Failed LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.Redis_Container_IsAccessible [11 s]
  Error Message:
   StackExchange.Redis.RedisConnectionException : It was not possible to connect to the redis server(s). Error connecting right now. To allow this multiplexer to continue retrying until it's able to connect, use abortConnect=false in your connection string or AbortOnConnectFail=false; in your code.
  Stack Trace:
     at StackExchange.Redis.ConnectionMultiplexer.ConnectImpl(ConfigurationOptions configuration, TextWriter writer, Nullable`1 serverType, EndPointCollection endpoints) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 716
   at StackExchange.Redis.ConnectionMultiplexer.Connect(ConfigurationOptions configuration, TextWriter log) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 678
   at StackExchange.Redis.ConnectionMultiplexer.Connect(String configuration, TextWriter log) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 656
   at LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.Redis_Container_IsAccessible() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DockerConnectivityTests.cs:line 56
--- End of stack trace from previous location ---
[xUnit.net 00:00:18.92]     LankaConnect.IntegrationTests.Repositories.PostgreSQLRepositoryTests.UserRepository_CRUD_Operations_ShouldWork [FAIL]
[xUnit.net 00:00:18.92]       System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
[xUnit.net 00:00:18.92]       Stack Trace:
[xUnit.net 00:00:18.92]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:18.92]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:18.92]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:18.92]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:18.92]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:18.92]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:18.92]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
[xUnit.net 00:00:18.92]            at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
[xUnit.net 00:00:18.92]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
[xUnit.net 00:00:18.93]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(151,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync()
[xUnit.net 00:00:18.93]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(105,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync()
[xUnit.net 00:00:18.93]     LankaConnect.IntegrationTests.Repositories.PostgreSQLRepositoryTests.UserRepository_DatabaseConnection_ShouldWork [FAIL]
[xUnit.net 00:00:18.93]       System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
[xUnit.net 00:00:18.93]       Stack Trace:
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
[xUnit.net 00:00:18.93]            at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
[xUnit.net 00:00:18.93]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(151,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync()
[xUnit.net 00:00:18.93]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(105,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync()
[xUnit.net 00:00:18.93]     LankaConnect.IntegrationTests.Repositories.PostgreSQLRepositoryTests.AllRepositories_DependencyInjection_ShouldResolveCorrectly [FAIL]
[xUnit.net 00:00:18.93]       System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
[xUnit.net 00:00:18.93]       Stack Trace:
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
[xUnit.net 00:00:18.93]            at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
[xUnit.net 00:00:18.93]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
[xUnit.net 00:00:18.93]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(151,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync()
[xUnit.net 00:00:18.93]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(105,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync()
[xUnit.net 00:00:18.93]     LankaConnect.IntegrationTests.Repositories.PostgreSQLRepositoryTests.CreateAndRetrieveUser_AgainstPostgreSQL_ShouldWork [FAIL]
[xUnit.net 00:00:18.94]       System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
[xUnit.net 00:00:18.94]       Stack Trace:
[xUnit.net 00:00:18.94]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:18.94]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:18.94]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:18.94]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:18.94]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:18.94]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:18.94]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
[xUnit.net 00:00:18.94]            at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
[xUnit.net 00:00:18.94]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
[xUnit.net 00:00:18.94]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
[xUnit.net 00:00:18.94]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
[xUnit.net 00:00:18.94]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
[xUnit.net 00:00:18.94]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(151,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync()
[xUnit.net 00:00:18.94]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(105,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync()
[xUnit.net 00:00:18.94]     LankaConnect.IntegrationTests.Repositories.PostgreSQLRepositoryTests.EmailTemplateRepository_BasicOperations_ShouldWork [FAIL]
[xUnit.net 00:00:18.94]       System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
[xUnit.net 00:00:18.94]       Stack Trace:
[xUnit.net 00:00:18.94]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
[xUnit.net 00:00:18.94]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
[xUnit.net 00:00:18.94]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
[xUnit.net 00:00:18.94]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:18.94]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:18.94]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
[xUnit.net 00:00:18.94]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
[xUnit.net 00:00:18.94]            at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
[xUnit.net 00:00:18.94]            at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
[xUnit.net 00:00:18.94]            at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
[xUnit.net 00:00:18.94]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
[xUnit.net 00:00:18.94]            at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
[xUnit.net 00:00:18.94]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(151,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync()
[xUnit.net 00:00:18.94]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs(105,0): at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync()
2026-01-24 08:36:39.789 -05:00 [WRN]  Microsoft.EntityFrameworkCore.Model.Validation: The property 'ReviewContent.Cons' is a collection or enumeration type with a value converter but with no value comparer. Set a value comparer to ensure the collection/enumeration elements are compared correctly.
warn: 1/24/2026 08:36:39.791 CoreEventId.CollectionWithoutComparer[10620] (Microsoft.EntityFrameworkCore.Model.Validation) 
      The property 'ReviewContent.Cons' is a collection or enumeration type with a value converter but with no value comparer. Set a value comparer to ensure the collection/enumeration elements are compared correctly.
2026-01-24 08:36:39.792 -05:00 [WRN]  Microsoft.EntityFrameworkCore.Model.Validation: The property 'ReviewContent.Pros' is a collection or enumeration type with a value converter but with no value comparer. Set a value comparer to ensure the collection/enumeration elements are compared correctly.
warn: 1/24/2026 08:36:39.792 CoreEventId.CollectionWithoutComparer[10620] (Microsoft.EntityFrameworkCore.Model.Validation) 
      The property 'ReviewContent.Pros' is a collection or enumeration type with a value converter but with no value comparer. Set a value comparer to ensure the collection/enumeration elements are compared correctly.
2026-01-24 08:36:39.798 -05:00 [WRN]  Microsoft.EntityFrameworkCore.Model.Validation: The property 'EmailMessage.RecipientStatuses' is a collection or enumeration type with a value converter but with no value comparer. Set a value comparer to ensure the collection/enumeration elements are compared correctly.
warn: 1/24/2026 08:36:39.798 CoreEventId.CollectionWithoutComparer[10620] (Microsoft.EntityFrameworkCore.Model.Validation) 
      The property 'EmailMessage.RecipientStatuses' is a collection or enumeration type with a value converter but with no value comparer. Set a value comparer to ensure the collection/enumeration elements are compared correctly.
2026-01-24 08:36:39.799 -05:00 [WRN]  Microsoft.EntityFrameworkCore.Model.Validation: The property 'EmailMessage.TemplateData' is a collection or enumeration type with a value converter but with no value comparer. Set a value comparer to ensure the collection/enumeration elements are compared correctly.
warn: 1/24/2026 08:36:39.799 CoreEventId.CollectionWithoutComparer[10620] (Microsoft.EntityFrameworkCore.Model.Validation) 
      The property 'EmailMessage.TemplateData' is a collection or enumeration type with a value converter but with no value comparer. Set a value comparer to ensure the collection/enumeration elements are compared correctly.
[xUnit.net 00:00:19.63]     LankaConnect.IntegrationTests.Infrastructure.LoggingConfigurationTests.PerformanceLogging_MeasuresDuration [FAIL]
[xUnit.net 00:00:19.63]       Expected timedEvent not to be <null>.
[xUnit.net 00:00:19.63]       Stack Trace:
[xUnit.net 00:00:19.63]            at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
[xUnit.net 00:00:19.63]            at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
[xUnit.net 00:00:19.63]            at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
[xUnit.net 00:00:19.63]            at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
[xUnit.net 00:00:19.63]            at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
[xUnit.net 00:00:19.63]            at FluentAssertions.Execution.AssertionScope.FailWith(String message)
[xUnit.net 00:00:19.63]            at FluentAssertions.Primitives.ReferenceTypeAssertions`2.NotBeNull(String because, Object[] becauseArgs)
[xUnit.net 00:00:19.63]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\LoggingConfigurationTests.cs(247,0): at LankaConnect.IntegrationTests.Infrastructure.LoggingConfigurationTests.PerformanceLogging_MeasuresDuration()
[xUnit.net 00:00:19.63]            at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
[xUnit.net 00:00:19.63]            at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
  Failed LankaConnect.IntegrationTests.Repositories.PostgreSQLRepositoryTests.UserRepository_CRUD_Operations_ShouldWork [1 ms]
  Error Message:
   System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
  Stack Trace:
     at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 151
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 105
  Failed LankaConnect.IntegrationTests.Repositories.PostgreSQLRepositoryTests.UserRepository_DatabaseConnection_ShouldWork [1 ms]
  Error Message:
   System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
  Stack Trace:
     at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 151
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 105
  Failed LankaConnect.IntegrationTests.Repositories.PostgreSQLRepositoryTests.AllRepositories_DependencyInjection_ShouldResolveCorrectly [1 ms]
  Error Message:
   System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
  Stack Trace:
     at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 151
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 105
  Failed LankaConnect.IntegrationTests.Repositories.PostgreSQLRepositoryTests.CreateAndRetrieveUser_AgainstPostgreSQL_ShouldWork [1 ms]
  Error Message:
   System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
  Stack Trace:
     at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 151
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 105
  Failed LankaConnect.IntegrationTests.Repositories.PostgreSQLRepositoryTests.EmailTemplateRepository_BasicOperations_ShouldWork [1 ms]
  Error Message:
   System.InvalidOperationException : Unable to resolve service for type 'MediatR.IPublisher' while attempting to activate 'LankaConnect.Infrastructure.Data.AppDbContext'.
  Stack Trace:
     at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.EnsureDatabaseCreatedAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 151
   at LankaConnect.IntegrationTests.Common.DockerComposeTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeTestBase.cs:line 105
  Passed LankaConnect.IntegrationTests.Infrastructure.LoggingConfigurationTests.LogLevel_Filtering_WorksCorrectly [291 ms]
  Failed LankaConnect.IntegrationTests.Infrastructure.LoggingConfigurationTests.PerformanceLogging_MeasuresDuration [398 ms]
  Error Message:
   Expected timedEvent not to be <null>.
  Stack Trace:
     at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(String message)
   at FluentAssertions.Primitives.ReferenceTypeAssertions`2.NotBeNull(String because, Object[] becauseArgs)
   at LankaConnect.IntegrationTests.Infrastructure.LoggingConfigurationTests.PerformanceLogging_MeasuresDuration() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\LoggingConfigurationTests.cs:line 247
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
  Passed LankaConnect.IntegrationTests.Infrastructure.LoggingConfigurationTests.LogContext_PreservesScope [81 ms]
  Passed LankaConnect.IntegrationTests.Infrastructure.LoggingConfigurationTests.StructuredLogging_WorksCorrectly [44 ms]
2026-01-24 08:36:40.080 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:40.239 -05:00 [INF]  LankaConnect.IntegrationTests.Infrastructure.LoggingConfigurationTests: Test log message from endpoint
2026-01-24 08:36:40.256 -05:00 [INF]  Microsoft.AspNetCore.Http.Result.OkObjectResult: Setting HTTP status code 200.
2026-01-24 08:36:40.261 -05:00 [INF]  Microsoft.AspNetCore.Http.Result.OkObjectResult: Writing value of type 'String' as Json.
2026-01-24 08:36:40.283 -05:00 [WRN]  Microsoft.EntityFrameworkCore.Model.Validation: The 'EventCategory' property 'Category' on entity type 'Event' is configured with a database-generated default, but has no configured sentinel value. The database-generated default will always be used for inserts when the property has the value 'Religious', since this is the CLR default for the 'EventCategory' type. Consider using a nullable type, using a nullable backing field, or setting the sentinel value for the property to ensure the database default is used when, and only when, appropriate. See https://aka.ms/efcore-docs-default-values for more information.
warn: 1/24/2026 08:36:40.286 RelationalEventId.BoolWithDefaultWarning[20601] (Microsoft.EntityFrameworkCore.Model.Validation) 
      The 'EventCategory' property 'Category' on entity type 'Event' is configured with a database-generated default, but has no configured sentinel value. The database-generated default will always be used for inserts when the property has the value 'Religious', since this is the CLR default for the 'EventCategory' type. Consider using a nullable type, using a nullable backing field, or setting the sentinel value for the property to ensure the database default is used when, and only when, appropriate. See https://aka.ms/efcore-docs-default-values for more information.
2026-01-24 08:36:40.287 -05:00 [WRN]  Microsoft.EntityFrameworkCore.Model.Validation: The 'RegistrationStatus' property 'Status' on entity type 'Registration' is configured with a database-generated default, but has no configured sentinel value. The database-generated default will always be used for inserts when the property has the value 'Pending', since this is the CLR default for the 'RegistrationStatus' type. Consider using a nullable type, using a nullable backing field, or setting the sentinel value for the property to ensure the database default is used when, and only when, appropriate. See https://aka.ms/efcore-docs-default-values for more information.
warn: 1/24/2026 08:36:40.287 RelationalEventId.BoolWithDefaultWarning[20601] (Microsoft.EntityFrameworkCore.Model.Validation) 
      The 'RegistrationStatus' property 'Status' on entity type 'Registration' is configured with a database-generated default, but has no configured sentinel value. The database-generated default will always be used for inserts when the property has the value 'Pending', since this is the CLR default for the 'RegistrationStatus' type. Consider using a nullable type, using a nullable backing field, or setting the sentinel value for the property to ensure the database default is used when, and only when, appropriate. See https://aka.ms/efcore-docs-default-values for more information.
2026-01-24 08:36:40.288 -05:00 [WRN]  Microsoft.EntityFrameworkCore.Model.Validation: The 'UserRole' property 'Role' on entity type 'User' is configured with a database-generated default, but has no configured sentinel value. The database-generated default will always be used for inserts when the property has the value '0', since this is the CLR default for the 'UserRole' type. Consider using a nullable type, using a nullable backing field, or setting the sentinel value for the property to ensure the database default is used when, and only when, appropriate. See https://aka.ms/efcore-docs-default-values for more information.
warn: 1/24/2026 08:36:40.288 RelationalEventId.BoolWithDefaultWarning[20601] (Microsoft.EntityFrameworkCore.Model.Validation) 
      The 'UserRole' property 'Role' on entity type 'User' is configured with a database-generated default, but has no configured sentinel value. The database-generated default will always be used for inserts when the property has the value '0', since this is the CLR default for the 'UserRole' type. Consider using a nullable type, using a nullable backing field, or setting the sentinel value for the property to ensure the database default is used when, and only when, appropriate. See https://aka.ms/efcore-docs-default-values for more information.
2026-01-24 08:36:40.300 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:40.300 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:40.300 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:40.300 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:40.300 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:40.301 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:40.301 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:40.301 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:40.301 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:40.301 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:40.303 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:40.303 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:45.383 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:45.383 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:45.383 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:45.383 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:45.383 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:45.383 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:45.383 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:45.383 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:45.562 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:45.562 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:45.563 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:45.583 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:45.605 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:00:25.40]     LankaConnect.IntegrationTests.Repositories.BusinessRepositoryTests.SearchByNameAsync_Should_Return_Matching_Businesses [FAIL]
[xUnit.net 00:00:25.40]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:25.40]       Stack Trace:
[xUnit.net 00:00:25.40]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:25.40]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:25.40]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:25.40]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:25.40]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:25.40]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:25.40]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Repositories.BusinessRepositoryTests.SearchByNameAsync_Should_Return_Matching_Businesses [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:00:25.40]     LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetEventsByRadiusAsync_Should_Return_Events_Within_100_Miles [FAIL]
[xUnit.net 00:00:25.40]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:25.41]       Stack Trace:
[xUnit.net 00:00:25.41]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:25.41]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:25.41]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:25.41]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:25.41]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:25.41]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:25.41]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
[xUnit.net 00:00:25.41]     LankaConnect.IntegrationTests.Email.EmailIntegrationTests.ConcurrentEmailProcessing_ShouldHandleMultipleRequests [FAIL]
[xUnit.net 00:00:25.41]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:25.41]       Stack Trace:
[xUnit.net 00:00:25.42]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:25.42]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:25.42]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:25.42]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:25.42]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:25.42]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:25.42]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
[xUnit.net 00:00:25.42]     LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.UnlinkExternalProvider_WhenNotLinked_ShouldReturn400 [FAIL]
[xUnit.net 00:00:25.42]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:25.42]       Stack Trace:
[xUnit.net 00:00:25.44]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:25.44]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:25.45]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:25.45]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:25.45]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:25.45]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:25.45]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
[xUnit.net 00:00:25.45]     LankaConnect.IntegrationTests.Controllers.BusinessesControllerTests.CreateBusiness_Should_Return_Created_With_Valid_Data [FAIL]
[xUnit.net 00:00:25.45]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:25.45]       Stack Trace:
[xUnit.net 00:00:25.45]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:25.45]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:25.45]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:25.45]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:25.45]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:25.45]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:25.45]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
[xUnit.net 00:00:25.45]     LankaConnect.IntegrationTests.Email.EmailPerformanceTests.SingleEmailSend_ShouldCompleteWithinTimeLimit [FAIL]
[xUnit.net 00:00:25.45]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:25.45]       Stack Trace:
[xUnit.net 00:00:25.45]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:25.46]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:25.46]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:25.46]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:25.46]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:25.46]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:25.46]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetEventsByRadiusAsync_Should_Return_Events_Within_100_Miles [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Email.EmailIntegrationTests.ConcurrentEmailProcessing_ShouldHandleMultipleRequests [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.UnlinkExternalProvider_WhenNotLinked_ShouldReturn400 [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Controllers.BusinessesControllerTests.CreateBusiness_Should_Return_Created_With_Valid_Data [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Email.EmailPerformanceTests.SingleEmailSend_ShouldCompleteWithinTimeLimit [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:00:25.46]     LankaConnect.IntegrationTests.Email.EmailApiTests.VerifyEmail_WithValidToken_ShouldReturnSuccess [FAIL]
[xUnit.net 00:00:25.46]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:25.46]       Stack Trace:
[xUnit.net 00:00:25.46]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:25.46]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:25.46]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:25.47]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:25.47]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:25.47]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:25.47]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:36:45.717 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:45.728 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:45.728 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:45.728 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:45.728 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:45.748 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:45.749 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:46.135 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:46.136 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:46.136 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:46.136 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:46.136 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:46.136 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:46.136 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:46.136 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:46.136 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:46.136 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:46.137 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:46.137 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:46.137 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:46.137 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:46.137 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:46.138 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:46.138 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:46.138 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:46.138 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:46.138 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:46.138 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:46.138 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:46.139 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:46.139 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:46.140 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:46.140 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:46.140 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:46.141 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:46.141 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:46.142 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:46.142 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:46.142 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:46.142 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:46.142 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:46.142 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:46.142 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:46.142 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:46.142 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:46.143 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:46.143 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:46.143 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:46.143 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:46.143 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:46.144 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:46.144 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:46.144 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:46.144 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:46.144 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:46.144 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:46.144 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:46.144 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:46.144 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:46.145 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:46.145 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:46.145 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:46.145 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:46.145 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:46.146 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:46.145 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:46.146 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:46.150 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:46.150 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:46.150 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:46.150 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:46.150 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:46.150 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:46.150 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:46.150 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:46.150 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:46.150 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:46.151 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:46.151 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:46.160 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:46.160 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:46.160 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:46.160 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:46.160 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:46.160 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:46.161 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:46.161 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:46.161 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:46.161 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:46.161 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:46.162 -05:00 [INF]  Program: Applying database migrations...
  Failed LankaConnect.IntegrationTests.Email.EmailApiTests.VerifyEmail_WithValidToken_ShouldReturnSuccess [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:00:29.66]     LankaConnect.IntegrationTests.Repositories.ServiceRepositoryTests.GetActiveByBusinessIdAsync_Should_Return_Only_Active_Services [FAIL]
[xUnit.net 00:00:29.66]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:29.66]       Stack Trace:
[xUnit.net 00:00:29.66]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:29.66]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:29.66]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:29.66]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:29.66]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:29.66]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:29.66]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Repositories.ServiceRepositoryTests.GetActiveByBusinessIdAsync_Should_Return_Only_Active_Services [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:36:49.919 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:50.206 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:50.206 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:50.207 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:50.209 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:50.209 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:50.209 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:50.210 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:50.210 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:50.210 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:50.210 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:50.212 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:50.212 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:50.332 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:50.331 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:50.336 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:50.331 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:50.331 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:50.334 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:50.335 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:50.344 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:50.346 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:50.346 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:50.346 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:50.347 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:50.349 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:50.353 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:00:30.17]     LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.UnlinkExternalProvider_WhenLastAuthMethod_ShouldReturn400 [FAIL]
[xUnit.net 00:00:30.17]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:30.18]       Stack Trace:
[xUnit.net 00:00:30.18]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:30.18]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:30.18]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:30.18]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:30.18]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:30.18]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:30.18]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
[xUnit.net 00:00:30.18]     LankaConnect.IntegrationTests.Repositories.BusinessRepositoryTests.GetBusinessCountByCategoryAsync_Should_Return_Correct_Count [FAIL]
[xUnit.net 00:00:30.18]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:30.18]       Stack Trace:
[xUnit.net 00:00:30.18]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:30.18]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:30.18]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:30.18]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:30.18]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:30.18]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:30.18]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
[xUnit.net 00:00:30.19]     LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetNearestEventsAsync_Should_Respect_MaxResults_Parameter [FAIL]
[xUnit.net 00:00:30.19]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:30.20]       Stack Trace:
[xUnit.net 00:00:30.20]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:30.20]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:30.20]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:30.20]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:30.20]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:30.20]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:30.20]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:36:50.437 -05:00 [INF]  : Starting LankaConnect API
[xUnit.net 00:00:30.20]     LankaConnect.IntegrationTests.Controllers.BusinessesControllerTests.GetBusinesses_Should_Return_Paginated_List [FAIL]
[xUnit.net 00:00:30.20]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:30.20]       Stack Trace:
[xUnit.net 00:00:30.20]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:30.20]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:30.21]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:30.21]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:30.21]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:30.21]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:30.21]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
[xUnit.net 00:00:30.22]     LankaConnect.IntegrationTests.Email.EmailPerformanceTests.LargeEmailContent_ShouldHandleEfficiently [FAIL]
[xUnit.net 00:00:30.22]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:30.22]       Stack Trace:
[xUnit.net 00:00:30.22]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:30.22]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:30.22]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:30.22]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:30.22]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:30.22]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
2026-01-24 08:36:50.454 -05:00 [INF]  : Starting LankaConnect API
[xUnit.net 00:00:30.22]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.UnlinkExternalProvider_WhenLastAuthMethod_ShouldReturn400 [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Repositories.BusinessRepositoryTests.GetBusinessCountByCategoryAsync_Should_Return_Correct_Count [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetNearestEventsAsync_Should_Respect_MaxResults_Parameter [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Controllers.BusinessesControllerTests.GetBusinesses_Should_Return_Paginated_List [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Email.EmailPerformanceTests.LargeEmailContent_ShouldHandleEfficiently [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:36:50.458 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:50.488 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:50.505 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:50.807 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:50.808 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:50.808 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:50.808 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:50.809 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:50.809 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:50.809 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:50.809 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:50.809 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:50.809 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:50.809 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:50.809 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:50.809 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:50.809 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:50.810 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:50.810 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:50.810 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:50.810 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:50.810 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:50.810 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:50.811 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:50.811 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:50.811 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:50.811 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:50.818 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:50.819 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:50.819 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:50.819 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:50.819 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:50.819 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:50.819 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:50.819 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:50.819 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:50.819 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:50.820 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:50.820 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:50.820 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:50.820 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:50.821 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:50.821 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:50.821 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:50.821 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:50.821 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:50.821 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:50.821 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:50.821 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:50.821 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:50.822 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:50.822 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:50.822 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:50.822 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:50.822 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:50.822 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:50.822 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:50.822 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:50.822 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:50.822 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:50.823 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:50.823 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:50.823 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:54.270 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:54.279 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:00:34.31]     LankaConnect.IntegrationTests.Email.EmailIntegrationTests.SendTemplatedEmailAsync_WithValidTemplate_ShouldRenderAndSend [FAIL]
[xUnit.net 00:00:34.31]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:34.31]       Stack Trace:
[xUnit.net 00:00:34.31]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:34.31]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:34.31]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:34.31]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:34.31]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:34.31]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:34.31]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Email.EmailIntegrationTests.SendTemplatedEmailAsync_WithValidTemplate_ShouldRenderAndSend [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:36:54.569 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:54.726 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:54.726 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:54.726 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:54.726 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:54.726 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:54.726 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:54.726 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:54.726 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:54.727 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:54.727 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:54.727 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:54.727 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:54.918 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:54.919 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:54.889 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:54.890 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:54.919 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:54.931 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:54.932 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:54.930 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:54.932 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:54.931 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:00:34.72]     LankaConnect.IntegrationTests.Email.EmailPerformanceTests.BulkEmailQueue_ShouldHandleLargeVolume [FAIL]
[xUnit.net 00:00:34.72]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:34.72]       Stack Trace:
[xUnit.net 00:00:34.72]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:34.72]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:34.72]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:34.72]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:34.72]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:34.72]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:34.72]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
[xUnit.net 00:00:34.72]     LankaConnect.IntegrationTests.Repositories.BusinessRepositoryTests.GetByCategoryAsync_Should_Return_Active_Businesses_In_Category [FAIL]
[xUnit.net 00:00:34.72]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:34.72]       Stack Trace:
[xUnit.net 00:00:34.72]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:34.72]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:34.72]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:34.72]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:34.73]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:34.73]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:34.73]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
[xUnit.net 00:00:34.73]     LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetNearestEventsAsync_Should_Only_Return_Published_Upcoming_Events [FAIL]
[xUnit.net 00:00:34.73]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:34.73]       Stack Trace:
[xUnit.net 00:00:34.73]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:34.73]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:34.73]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:34.73]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:34.73]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:34.73]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:34.73]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
[xUnit.net 00:00:34.73]     LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.UnlinkExternalProvider_WhenUserHasOtherProviders_ShouldUnlinkSuccessfully [FAIL]
[xUnit.net 00:00:34.73]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:34.73]       Stack Trace:
[xUnit.net 00:00:34.73]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:34.73]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:34.73]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:34.73]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:34.73]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:34.73]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:34.73]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:36:55.002 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:55.008 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:55.008 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:55.009 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:55.384 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:55.384 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:55.384 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:55.384 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:55.384 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:55.384 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:55.384 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:55.384 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:55.384 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:55.384 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:55.384 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:55.384 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:55.384 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:55.384 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:55.385 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:55.385 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:55.385 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:55.385 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:55.385 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:55.385 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:55.385 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:55.385 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:55.385 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:55.385 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:55.386 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:55.386 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:55.386 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:55.386 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:55.386 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:55.386 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:55.386 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:55.386 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:55.386 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:55.386 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:55.386 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:55.386 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:55.386 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:55.386 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:55.386 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:55.386 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:55.386 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:55.386 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:55.386 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:55.386 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:55.387 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:55.387 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:55.387 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:55.387 -05:00 [INF]  Program: Applying database migrations...
  Failed LankaConnect.IntegrationTests.Email.EmailPerformanceTests.BulkEmailQueue_ShouldHandleLargeVolume [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Repositories.BusinessRepositoryTests.GetByCategoryAsync_Should_Return_Active_Businesses_In_Category [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetNearestEventsAsync_Should_Only_Return_Published_Upcoming_Events [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.UnlinkExternalProvider_WhenUserHasOtherProviders_ShouldUnlinkSuccessfully [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:00:37.98]     LankaConnect.IntegrationTests.Email.EmailApiTests.EmailWebhook_ShouldHandleMailHogWebhooks [FAIL]
[xUnit.net 00:00:37.98]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:37.98]       Stack Trace:
[xUnit.net 00:00:37.98]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:37.98]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:37.98]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:37.98]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:37.98]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:37.98]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:37.98]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Email.EmailApiTests.EmailWebhook_ShouldHandleMailHogWebhooks [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:36:58.234 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:58.382 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:58.383 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:58.383 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:58.427 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:58.427 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:58.427 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:58.427 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:58.428 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:58.428 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:58.428 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:58.428 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:58.429 -05:00 [INF]  Program: Applying database migrations...
[xUnit.net 00:00:38.43]     LankaConnect.IntegrationTests.Repositories.ServiceRepositoryTests.GetByBusinessIdAndNameAsync_Should_Return_Matching_Service [FAIL]
[xUnit.net 00:00:38.43]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:38.43]       Stack Trace:
[xUnit.net 00:00:38.43]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:38.44]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:38.44]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:38.44]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:38.44]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:38.44]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:38.44]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:36:58.686 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:58.805 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:58.805 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:58.805 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:58.816 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:58.823 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:58.842 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:58.848 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:58.849 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:58.849 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:58.849 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:58.849 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:58.849 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:58.851 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:59.436 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:59.436 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:00:39.21]     LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetEventsByRadiusAsync_Should_Return_Events_Within_25_Miles [FAIL]
[xUnit.net 00:00:39.21]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:39.21]       Stack Trace:
[xUnit.net 00:00:39.21]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:39.21]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:39.21]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:39.21]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:39.21]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:39.22]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:39.22]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
[xUnit.net 00:00:39.22]     LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.GetLinkedProviders_WithNoProviders_ShouldReturn200AndEmptyList [FAIL]
[xUnit.net 00:00:39.22]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:39.22]       Stack Trace:
[xUnit.net 00:00:39.22]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:39.22]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:39.22]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:39.22]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:39.22]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:39.22]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:39.22]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:36:59.453 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:36:59.453 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:00:39.23]     LankaConnect.IntegrationTests.Email.EmailPerformanceTests.TemplateRendering_ShouldBePerformant [FAIL]
[xUnit.net 00:00:39.23]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:39.23]       Stack Trace:
[xUnit.net 00:00:39.23]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:39.23]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:39.23]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:39.23]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:39.23]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:39.23]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:39.23]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
[xUnit.net 00:00:39.23]     LankaConnect.IntegrationTests.Repositories.BusinessRepositoryTests.GetByOwnerIdAsync_Should_Return_Businesses_For_Owner [FAIL]
[xUnit.net 00:00:39.23]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:39.23]       Stack Trace:
[xUnit.net 00:00:39.23]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:39.24]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:39.24]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:39.24]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:39.24]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:39.24]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:39.24]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Repositories.ServiceRepositoryTests.GetByBusinessIdAndNameAsync_Should_Return_Matching_Service [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetEventsByRadiusAsync_Should_Return_Events_Within_25_Miles [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.GetLinkedProviders_WithNoProviders_ShouldReturn200AndEmptyList [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Email.EmailPerformanceTests.TemplateRendering_ShouldBePerformant [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Repositories.BusinessRepositoryTests.GetByOwnerIdAsync_Should_Return_Businesses_For_Owner [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:36:59.502 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:59.502 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:59.510 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:59.515 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:36:59.903 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:59.903 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:59.904 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:59.940 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:59.941 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:59.941 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:59.941 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:59.941 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:59.941 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:59.941 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:59.942 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:59.942 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:59.942 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:59.942 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:59.942 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:59.942 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:59.942 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:59.942 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:59.943 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:59.943 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:59.943 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:59.943 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:59.944 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:59.944 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:59.946 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:59.946 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:59.946 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:59.946 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:59.947 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:59.947 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:59.947 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:59.947 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:59.947 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:59.947 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:59.948 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:59.948 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:36:59.953 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:36:59.953 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:36:59.953 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:36:59.953 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:36:59.954 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:36:59.954 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:36:59.954 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:36:59.954 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:36:59.954 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:36:59.954 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:36:59.955 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:36:59.956 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:02.478 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:02.520 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:00:42.50]     LankaConnect.IntegrationTests.Controllers.BusinessesControllerTests.GetBusiness_Should_Return_NotFound_For_Invalid_Id [FAIL]
[xUnit.net 00:00:42.50]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:42.50]       Stack Trace:
[xUnit.net 00:00:42.50]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:42.50]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:42.50]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:42.50]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:42.50]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:42.50]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:42.50]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.BusinessesControllerTests.GetBusiness_Should_Return_NotFound_For_Invalid_Id [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:37:02.749 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:02.927 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:02.936 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:02.945 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:02.951 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:02.951 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:02.951 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:02.951 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:02.952 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:02.952 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:02.952 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:02.952 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:02.952 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:02.953 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:03.999 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:00:43.78]     LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.GetLinkedProviders_WhenUserNotFound_ShouldReturn404 [FAIL]
[xUnit.net 00:00:43.78]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:43.78]       Stack Trace:
[xUnit.net 00:00:43.78]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:43.78]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:43.78]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:43.78]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:43.78]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:43.78]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:43.78]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:04.015 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:04.017 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:00:43.79]     LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetEventsByCityAsync_Should_Return_Empty_For_Invalid_City [FAIL]
[xUnit.net 00:00:43.79]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:43.79]       Stack Trace:
[xUnit.net 00:00:43.79]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:43.80]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:43.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:43.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:43.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:43.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:43.80]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
[xUnit.net 00:00:43.80]     LankaConnect.IntegrationTests.Email.EmailPerformanceTests.DatabaseOperations_ShouldScaleEfficiently [FAIL]
[xUnit.net 00:00:43.80]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:43.80]       Stack Trace:
[xUnit.net 00:00:43.80]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:43.80]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:43.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:43.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:43.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:43.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:43.80]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:04.044 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:04.040 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:04.053 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:04.067 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:04.067 -05:00 [INF]  : Starting LankaConnect API
  Failed LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.GetLinkedProviders_WhenUserNotFound_ShouldReturn404 [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetEventsByCityAsync_Should_Return_Empty_For_Invalid_City [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Email.EmailPerformanceTests.DatabaseOperations_ShouldScaleEfficiently [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:00:46.60]     LankaConnect.IntegrationTests.Email.EmailIntegrationTests.EmailRetry_WithFailedEmails_ShouldRetryThem [FAIL]
[xUnit.net 00:00:46.60]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:46.60]       Stack Trace:
[xUnit.net 00:00:46.60]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:46.60]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:46.60]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:46.60]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:46.60]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:46.60]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:46.60]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Email.EmailIntegrationTests.EmailRetry_WithFailedEmails_ShouldRetryThem [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:37:06.857 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:07.027 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:07.034 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:07.035 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:07.035 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:07.036 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:07.036 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:07.036 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:07.036 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:07.036 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:07.036 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:07.037 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:07.037 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:07.038 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:07.033 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:00:47.45]     LankaConnect.IntegrationTests.Email.EmailApiTests.SendEmailVerification_WithValidEmail_ShouldReturnSuccess [FAIL]
[xUnit.net 00:00:47.45]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:47.45]       Stack Trace:
[xUnit.net 00:00:47.45]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:47.45]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:47.45]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:47.45]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:47.45]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:47.45]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:47.45]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:07.711 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:07.912 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:07.912 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:07.912 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:07.913 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:07.913 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:07.913 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:07.913 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:07.913 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:07.914 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:07.914 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:07.915 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:07.915 -05:00 [INF]  Program: Applying database migrations...
[xUnit.net 00:00:47.95]     LankaConnect.IntegrationTests.Repositories.BusinessRepositoryTests.IsOwnerOfBusinessAsync_Should_Return_True_For_Owner [FAIL]
[xUnit.net 00:00:47.95]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:47.95]       Stack Trace:
[xUnit.net 00:00:47.95]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:47.95]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:47.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:47.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:47.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:47.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:47.95]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:08.212 -05:00 [INF]  : Starting LankaConnect API
  Failed LankaConnect.IntegrationTests.Email.EmailApiTests.SendEmailVerification_WithValidEmail_ShouldReturnSuccess [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Repositories.BusinessRepositoryTests.IsOwnerOfBusinessAsync_Should_Return_True_For_Owner [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:37:08.353 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:08.354 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:08.353 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:08.398 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:08.407 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:08.407 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:08.407 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:08.407 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:08.408 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:08.409 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:08.409 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:08.410 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:08.410 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
[xUnit.net 00:00:48.18]     LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.UnlinkExternalProvider_WithValidData_ShouldReturn200AndUnlinkProvider [FAIL]
[xUnit.net 00:00:48.18]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:48.18]       Stack Trace:
[xUnit.net 00:00:48.18]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:48.18]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:48.18]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
2026-01-24 08:37:08.412 -05:00 [INF]  Program: Applying database migrations...
[xUnit.net 00:00:48.18]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:48.18]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:48.18]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:48.18]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
[xUnit.net 00:00:48.18]     LankaConnect.IntegrationTests.Email.EmailPerformanceTests.EmailRetry_ShouldHandleFailuresEfficiently [FAIL]
[xUnit.net 00:00:48.18]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:48.18]       Stack Trace:
[xUnit.net 00:00:48.18]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:48.18]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:48.18]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:48.18]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:48.18]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:48.18]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:48.18]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:08.463 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:08.469 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:08.689 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:08.690 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:08.690 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:08.690 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:08.728 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:08.728 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:08.728 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:08.728 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:08.728 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:08.728 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:08.729 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:08.729 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:08.729 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:08.729 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:08.729 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:08.729 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:08.729 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:08.729 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:08.729 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:08.729 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:08.730 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:08.730 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:08.731 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:08.731 -05:00 [INF]  Program: Applying database migrations...
  Failed LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.UnlinkExternalProvider_WithValidData_ShouldReturn200AndUnlinkProvider [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Email.EmailPerformanceTests.EmailRetry_ShouldHandleFailuresEfficiently [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:00:50.68]     LankaConnect.IntegrationTests.Repositories.ServiceRepositoryTests.GetFreeServicesAsync_Should_Return_Services_Without_Price [FAIL]
[xUnit.net 00:00:50.68]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:50.68]       Stack Trace:
[xUnit.net 00:00:50.69]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:50.69]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:50.69]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:50.69]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:50.69]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:50.69]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:50.69]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:10.938 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:11.120 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:11.121 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:11.121 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:11.115 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:11.125 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:11.158 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:11.163 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:11.164 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:11.165 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:11.165 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:11.165 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:11.165 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:11.166 -05:00 [INF]  Program: Applying database migrations...
  Failed LankaConnect.IntegrationTests.Repositories.ServiceRepositoryTests.GetFreeServicesAsync_Should_Return_Services_Without_Price [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:37:11.984 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:00:51.77]     LankaConnect.IntegrationTests.Email.EmailApiTests.EmailApiEndpoints_ShouldRequireAuthentication [FAIL]
[xUnit.net 00:00:51.77]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:51.77]       Stack Trace:
[xUnit.net 00:00:51.77]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:51.77]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:51.77]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:51.77]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:51.77]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:51.77]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:51.77]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:12.028 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:12.219 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:12.220 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:12.220 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:12.220 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:12.220 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:12.220 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:12.220 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:12.221 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:12.221 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:12.221 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:12.221 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:12.222 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:12.485 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:12.493 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:12.777 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:12.777 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:00:52.56]     LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.LinkExternalProvider_WhenAlreadyLinked_ShouldReturn400 [FAIL]
[xUnit.net 00:00:52.56]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:52.56]       Stack Trace:
[xUnit.net 00:00:52.56]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:52.56]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:52.56]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:52.56]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:52.56]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:52.56]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:52.56]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
[xUnit.net 00:00:52.57]     LankaConnect.IntegrationTests.Email.EmailPerformanceTests.MemoryUsage_ShouldRemainStable [FAIL]
[xUnit.net 00:00:52.57]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:52.57]       Stack Trace:
[xUnit.net 00:00:52.57]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:52.57]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:52.57]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:52.57]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:52.57]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:52.57]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:52.57]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:12.820 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:12.831 -05:00 [INF]  : Starting LankaConnect API
  Failed LankaConnect.IntegrationTests.Email.EmailApiTests.EmailApiEndpoints_ShouldRequireAuthentication [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.LinkExternalProvider_WhenAlreadyLinked_ShouldReturn400 [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Email.EmailPerformanceTests.MemoryUsage_ShouldRemainStable [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:37:13.065 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:13.066 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:13.066 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:13.072 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:13.076 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:13.076 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:13.076 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:13.076 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:13.076 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:13.077 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:13.077 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:13.077 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:13.077 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:13.077 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:13.077 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:13.077 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:13.077 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:13.077 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:13.078 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:13.078 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:13.078 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:13.078 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:13.079 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:13.079 -05:00 [INF]  Program: Applying database migrations...
[xUnit.net 00:00:54.82]     LankaConnect.IntegrationTests.Controllers.BusinessImagesControllerTests.SetPrimaryBusinessImage_WithExistingImage_ShouldReturnNoContent [FAIL]
[xUnit.net 00:00:54.82]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:54.82]       Stack Trace:
[xUnit.net 00:00:54.82]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:54.82]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:54.82]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:54.82]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:54.82]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:54.82]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:54.82]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.BusinessImagesControllerTests.SetPrimaryBusinessImage_WithExistingImage_ShouldReturnNoContent [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:37:15.071 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:15.214 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:15.214 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:15.214 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:15.216 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:15.216 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:15.216 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:15.216 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:15.217 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:15.217 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:15.217 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:15.217 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:15.217 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:15.250 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:15.257 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:16.311 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:00:56.08]     LankaConnect.IntegrationTests.Email.EmailApiTests.SendPasswordResetEmail_WithValidEmail_ShouldReturnSuccess [FAIL]
[xUnit.net 00:00:56.08]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:56.09]       Stack Trace:
[xUnit.net 00:00:56.09]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:56.09]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:56.09]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:56.09]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:56.09]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:56.09]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:56.09]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:16.342 -05:00 [INF]  : Starting LankaConnect API
[xUnit.net 00:00:56.13]     LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetEventsByCityAsync_Should_Filter_By_State_When_Provided [FAIL]
[xUnit.net 00:00:56.13]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:56.13]       Stack Trace:
[xUnit.net 00:00:56.13]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:56.13]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:56.13]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:56.13]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:56.13]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:56.13]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:56.13]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:16.399 -05:00 [INF]  : Starting LankaConnect API
  Failed LankaConnect.IntegrationTests.Email.EmailApiTests.SendPasswordResetEmail_WithValidEmail_ShouldReturnSuccess [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetEventsByCityAsync_Should_Filter_By_State_When_Provided [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:37:16.572 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:16.573 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:16.573 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:16.610 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:16.610 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:16.610 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:16.611 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:16.611 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:16.611 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:16.611 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:16.612 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:16.612 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:16.642 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:16.642 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:16.643 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:16.643 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:16.643 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:16.643 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:16.643 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:16.643 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:16.643 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:16.644 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:16.644 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:16.644 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:17.150 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:17.150 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:17.174 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:17.238 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:00:57.03]     LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.LinkExternalProvider_WithValidData_ShouldReturn200AndLinkProvider [FAIL]
[xUnit.net 00:00:57.03]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:57.03]       Stack Trace:
[xUnit.net 00:00:57.03]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:57.03]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:57.03]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:57.03]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:57.03]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:57.04]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:57.04]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:17.292 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:17.411 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:17.412 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:17.412 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:17.412 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:17.412 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:17.412 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:17.412 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:17.412 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:17.412 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:17.412 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:17.412 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:17.413 -05:00 [INF]  Program: Applying database migrations...
  Failed LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.LinkExternalProvider_WithValidData_ShouldReturn200AndLinkProvider [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:00:58.85]     LankaConnect.IntegrationTests.Email.EmailIntegrationTests.QueueEmailAsync_ShouldPersistToDatabase [FAIL]
[xUnit.net 00:00:58.85]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:58.85]       Stack Trace:
[xUnit.net 00:00:58.85]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:58.85]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:58.85]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:58.85]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:58.85]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:58.85]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:58.85]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:19.109 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:19.295 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:19.305 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:19.321 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:19.358 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:19.358 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:19.359 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:19.359 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:19.359 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:19.359 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:19.360 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:19.360 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:19.360 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:19.361 -05:00 [INF]  Program: Applying database migrations...
  Failed LankaConnect.IntegrationTests.Email.EmailIntegrationTests.QueueEmailAsync_ShouldPersistToDatabase [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:00:59.95]     LankaConnect.IntegrationTests.Repositories.BusinessRepositoryTests.SearchByLocationAsync_Should_Return_Businesses_In_City [FAIL]
[xUnit.net 00:00:59.95]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:00:59.95]       Stack Trace:
[xUnit.net 00:00:59.96]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:00:59.96]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:00:59.96]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:59.96]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:59.96]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:59.96]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:59.96]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:20.225 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:20.377 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:20.404 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:20.404 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:20.404 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:20.404 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:20.405 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:20.405 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:20.405 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:20.405 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:20.405 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:20.406 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:20.406 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:20.674 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:20.686 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:20.715 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:00.51]     LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetEventsByRadiusAsync_Should_Return_Empty_When_No_Events_In_Radius [FAIL]
[xUnit.net 00:01:00.51]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:00.52]       Stack Trace:
[xUnit.net 00:01:00.52]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:00.52]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:00.52]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:00.52]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:01:00.52]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:00.52]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:01:00.52]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:20.769 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:20.962 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:20.962 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:20.962 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:20.962 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:20.962 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:20.963 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:20.963 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:20.963 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:20.963 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:20.963 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:20.964 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:20.964 -05:00 [INF]  Program: Applying database migrations...
  Failed LankaConnect.IntegrationTests.Repositories.BusinessRepositoryTests.SearchByLocationAsync_Should_Return_Businesses_In_City [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetEventsByRadiusAsync_Should_Return_Empty_When_No_Events_In_Radius [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:37:21.480 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:21.504 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:03.01]     LankaConnect.IntegrationTests.Repositories.ServiceRepositoryTests.AddAsync_Should_Add_Service_Successfully [FAIL]
[xUnit.net 00:01:03.01]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:03.01]       Stack Trace:
[xUnit.net 00:01:03.01]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:03.01]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:03.01]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:03.01]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:01:03.01]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:03.01]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:01:03.01]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Repositories.ServiceRepositoryTests.AddAsync_Should_Add_Service_Successfully [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:37:23.264 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:23.434 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:23.443 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:23.454 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:23.461 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:23.462 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:23.463 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:23.463 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:23.463 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:23.464 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:23.464 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:23.464 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:23.464 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:23.465 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:24.478 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:04.28]     LankaConnect.IntegrationTests.Repositories.BusinessRepositoryTests.AddAsync_Should_Add_Business_Successfully [FAIL]
[xUnit.net 00:01:04.28]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:04.28]       Stack Trace:
[xUnit.net 00:01:04.28]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:04.29]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:04.29]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:04.29]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:01:04.29]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:04.29]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:01:04.29]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:24.545 -05:00 [INF]  : Starting LankaConnect API
[xUnit.net 00:01:04.33]     LankaConnect.IntegrationTests.Email.EmailPerformanceTests.EmailQueueProcessing_ShouldMaintainThroughput [FAIL]
[xUnit.net 00:01:04.33]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:04.33]       Stack Trace:
[xUnit.net 00:01:04.33]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:04.33]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:04.33]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:04.33]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:01:04.33]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:04.33]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:01:04.33]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:24.594 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:24.736 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:24.736 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:24.736 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:24.737 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:24.737 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:24.737 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:24.737 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:24.737 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:24.738 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:24.738 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:24.738 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:24.738 -05:00 [INF]  Program: Applying database migrations...
  Failed LankaConnect.IntegrationTests.Repositories.BusinessRepositoryTests.AddAsync_Should_Add_Business_Successfully [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Email.EmailPerformanceTests.EmailQueueProcessing_ShouldMaintainThroughput [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:37:24.782 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:24.783 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:24.783 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:24.783 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:24.783 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:24.783 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:24.783 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:24.783 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:24.784 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:24.784 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:24.784 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:24.784 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:25.025 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:25.031 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:07.06]     LankaConnect.IntegrationTests.Controllers.BusinessImagesControllerTests.GetBusinessImages_WithExistingImages_ShouldReturnImages [FAIL]
[xUnit.net 00:01:07.06]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:07.06]       Stack Trace:
[xUnit.net 00:01:07.06]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:07.06]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:07.06]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:07.06]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:01:07.06]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:07.06]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:01:07.06]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.BusinessImagesControllerTests.GetBusinessImages_WithExistingImages_ShouldReturnImages [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:37:27.348 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:27.516 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:27.516 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:27.516 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:27.516 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:27.516 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:27.516 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:27.516 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:27.517 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:27.517 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:27.517 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:27.518 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:27.518 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:27.534 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:27.541 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:08.18]     LankaConnect.IntegrationTests.Email.EmailApiTests.GetEmailStatus_WithInvalidId_ShouldReturnBadRequest [FAIL]
[xUnit.net 00:01:08.18]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:08.18]       Stack Trace:
[xUnit.net 00:01:08.18]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:08.18]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:08.18]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:08.18]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:01:08.18]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:08.18]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:01:08.18]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:28.441 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:28.643 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:28.643 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:28.644 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:28.644 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:28.644 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:28.644 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:28.644 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:28.644 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:28.644 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:28.644 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:28.645 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:28.645 -05:00 [INF]  Program: Applying database migrations...
  Failed LankaConnect.IntegrationTests.Email.EmailApiTests.GetEmailStatus_WithInvalidId_ShouldReturnBadRequest [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:37:28.816 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:28.825 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:28.848 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:08.63]     LankaConnect.IntegrationTests.Email.EmailPerformanceTests.ConcurrentEmailSending_ShouldMaintainPerformance [FAIL]
[xUnit.net 00:01:08.63]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:08.63]       Stack Trace:
[xUnit.net 00:01:08.63]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:08.63]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:08.63]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:08.63]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:01:08.63]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:08.63]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:01:08.63]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:28.881 -05:00 [INF]  : Starting LankaConnect API
[xUnit.net 00:01:08.70]     LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.UnlinkExternalProvider_WhenUserNotFound_ShouldReturn404 [FAIL]
[xUnit.net 00:01:08.70]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:08.70]       Stack Trace:
[xUnit.net 00:01:08.70]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:08.70]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:08.70]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:08.70]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:01:08.70]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:08.70]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:01:08.70]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:28.950 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:29.095 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:29.095 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:29.096 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:29.120 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:29.132 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:29.132 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:29.132 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:29.132 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:29.132 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:29.132 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:29.132 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:29.132 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:29.132 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:29.133 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:29.133 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:29.133 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:29.133 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:29.133 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:29.133 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:29.134 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:29.134 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:29.155 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:29.155 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:29.155 -05:00 [INF]  Program: Applying database migrations...
  Failed LankaConnect.IntegrationTests.Email.EmailPerformanceTests.ConcurrentEmailSending_ShouldMaintainPerformance [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.UnlinkExternalProvider_WhenUserNotFound_ShouldReturn404 [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:01:11.22]     LankaConnect.IntegrationTests.Email.EmailIntegrationTests.SendEmailAsync_WithValidData_ShouldSendEmail [FAIL]
[xUnit.net 00:01:11.22]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:11.22]       Stack Trace:
[xUnit.net 00:01:11.22]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:11.22]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:11.22]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:11.22]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:01:11.22]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:11.22]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:01:11.22]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:31.477 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:31.588 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:31.597 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
  Failed LankaConnect.IntegrationTests.Email.EmailIntegrationTests.SendEmailAsync_WithValidData_ShouldSendEmail [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:37:32.706 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:12.48]     LankaConnect.IntegrationTests.Email.EmailApiTests.VerifyEmail_WithEmptyToken_ShouldReturnBadRequest [FAIL]
[xUnit.net 00:01:12.48]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:12.48]       Stack Trace:
[xUnit.net 00:01:12.48]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:12.48]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:12.48]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:12.48]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:01:12.48]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:12.48]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:01:12.48]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:32.737 -05:00 [INF]  : Starting LankaConnect API
[xUnit.net 00:01:12.56]     LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetEventsByCityAsync_Should_Return_Empty_For_Empty_City_Name [FAIL]
[xUnit.net 00:01:12.56]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:12.56]       Stack Trace:
[xUnit.net 00:01:12.56]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:12.56]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:12.56]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:12.56]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:01:12.56]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:12.56]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:01:12.56]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:32.817 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:32.978 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:32.978 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:32.978 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:33.029 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:33.030 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:33.030 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:33.030 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:33.030 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:33.030 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:33.030 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:33.031 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:33.031 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:33.155 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:33.156 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:33.156 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:33.156 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:33.156 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:33.156 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:33.156 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:33.157 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:33.157 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:33.157 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:33.158 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:33.158 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:33.216 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:33.239 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:33.255 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:33.264 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:13.05]     LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.LinkExternalProvider_WithMultipleProviders_ShouldLinkAll [FAIL]
[xUnit.net 00:01:13.05]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:13.05]       Stack Trace:
[xUnit.net 00:01:13.05]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:13.05]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:13.05]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:13.05]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:01:13.05]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:13.05]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:01:13.05]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:33.302 -05:00 [INF]  : Starting LankaConnect API
  Failed LankaConnect.IntegrationTests.Email.EmailApiTests.VerifyEmail_WithEmptyToken_ShouldReturnBadRequest [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetEventsByCityAsync_Should_Return_Empty_For_Empty_City_Name [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.LinkExternalProvider_WithMultipleProviders_ShouldLinkAll [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:37:33.458 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:33.458 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:33.458 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:33.458 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:33.458 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:33.459 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:33.459 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:33.459 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:33.459 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:33.459 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:33.460 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:33.460 -05:00 [INF]  Program: Applying database migrations...
[xUnit.net 00:01:15.30]     LankaConnect.IntegrationTests.Repositories.ServiceRepositoryTests.GetActiveServiceCountByBusinessIdAsync_Should_Return_Active_Count_Only [FAIL]
[xUnit.net 00:01:15.30]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:15.30]       Stack Trace:
[xUnit.net 00:01:15.30]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:15.30]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:15.30]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:15.30]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:01:15.30]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:15.30]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:01:15.30]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Repositories.ServiceRepositoryTests.GetActiveServiceCountByBusinessIdAsync_Should_Return_Active_Count_Only [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:37:35.553 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:35.732 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:35.732 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:35.732 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:35.733 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:35.733 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:35.733 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:35.733 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:35.733 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:35.733 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:35.734 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:35.734 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:35.734 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:35.770 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:16.38]     LankaConnect.IntegrationTests.Repositories.BusinessRepositoryTests.IsOwnerOfBusinessAsync_Should_Return_False_For_Non_Owner [FAIL]
[xUnit.net 00:01:16.38]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:16.38]       Stack Trace:
[xUnit.net 00:01:16.38]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:16.38]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:16.38]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:16.38]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:01:16.38]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:16.38]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:01:16.38]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:36.636 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:36.778 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:36.778 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:36.778 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:36.778 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:36.778 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:36.778 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:36.778 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:36.779 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:36.779 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:36.779 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:36.780 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:36.780 -05:00 [INF]  Program: Applying database migrations...
  Failed LankaConnect.IntegrationTests.Repositories.BusinessRepositoryTests.IsOwnerOfBusinessAsync_Should_Return_False_For_Non_Owner [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:37:37.087 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:37.094 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:37.213 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:16.99]     LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetEventsByCityAsync_Should_Return_Events_In_Specified_City [FAIL]
[xUnit.net 00:01:16.99]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:16.99]       Stack Trace:
[xUnit.net 00:01:16.99]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:16.99]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:16.99]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:16.99]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:01:16.99]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:16.99]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:01:16.99]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:37.260 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:37.397 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:37.397 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:37.397 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:37.397 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:37.398 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:37.398 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:37.398 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:37.398 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:37.398 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:37.398 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:37.399 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:37.399 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:37.507 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:37.525 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
  Failed LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetEventsByCityAsync_Should_Return_Events_In_Specified_City [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:01:19.43]     LankaConnect.IntegrationTests.Controllers.BusinessImagesControllerTests.UploadBusinessImage_WithInvalidFileType_ShouldReturnBadRequest [FAIL]
[xUnit.net 00:01:19.43]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:19.43]       Stack Trace:
[xUnit.net 00:01:19.43]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:19.43]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:19.44]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:19.44]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:01:19.44]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:19.44]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:01:19.44]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:39.692 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:39.792 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:39.801 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
  Failed LankaConnect.IntegrationTests.Controllers.BusinessImagesControllerTests.UploadBusinessImage_WithInvalidFileType_ShouldReturnBadRequest [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:37:40.845 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:20.62]     LankaConnect.IntegrationTests.Repositories.BusinessRepositoryTests.GetWithServicesAsync_Should_Include_Active_Services [FAIL]
[xUnit.net 00:01:20.62]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:20.62]       Stack Trace:
[xUnit.net 00:01:20.62]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:20.62]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:20.62]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:20.62]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:01:20.62]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:20.62]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:01:20.62]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:40.901 -05:00 [INF]  : Starting LankaConnect API
[xUnit.net 00:01:20.78]     LankaConnect.IntegrationTests.Email.EmailPerformanceTests.StressTest_ShouldHandleHighLoad [FAIL]
[xUnit.net 00:01:20.78]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:20.78]       Stack Trace:
[xUnit.net 00:01:20.78]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:20.78]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:20.78]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:20.78]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:01:20.78]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:20.78]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:01:20.78]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:41.051 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:41.072 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:41.075 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:41.076 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:41.100 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:41.100 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:41.100 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:41.101 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:41.101 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:41.101 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:41.101 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:41.101 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:41.102 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:41.196 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:41.197 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:41.197 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:41.197 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:41.197 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:41.197 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:41.197 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:41.197 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:41.197 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:41.198 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:41.198 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:41.198 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:41.479 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:41.486 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
  Failed LankaConnect.IntegrationTests.Repositories.BusinessRepositoryTests.GetWithServicesAsync_Should_Include_Active_Services [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Email.EmailPerformanceTests.StressTest_ShouldHandleHighLoad [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:01:23.49]     LankaConnect.IntegrationTests.Email.EmailIntegrationTests.QueueEmailAsync_WithHighPriority_ShouldSetCorrectPriority [FAIL]
[xUnit.net 00:01:23.49]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:23.49]       Stack Trace:
[xUnit.net 00:01:23.49]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:23.49]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:23.49]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:23.49]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:01:23.49]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:23.49]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:01:23.49]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Email.EmailIntegrationTests.QueueEmailAsync_WithHighPriority_ShouldSetCorrectPriority [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:37:43.743 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:43.912 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:43.912 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:43.913 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:43.913 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:43.913 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:43.913 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:43.913 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:43.913 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:43.913 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:43.913 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:43.913 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:43.914 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:43.920 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:24.56]     LankaConnect.IntegrationTests.Email.EmailApiTests.EmailApi_ShouldValidateRequestPayload [FAIL]
[xUnit.net 00:01:24.56]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:24.56]       Stack Trace:
[xUnit.net 00:01:24.56]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:24.56]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:24.56]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:24.56]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:01:24.56]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:24.56]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:01:24.56]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:44.812 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:44.950 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:44.950 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:44.950 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:44.950 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:44.950 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:44.950 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:44.950 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:44.950 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:44.950 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:44.951 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:44.951 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:44.951 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:45.180 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:45.189 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
  Failed LankaConnect.IntegrationTests.Email.EmailApiTests.EmailApi_ShouldValidateRequestPayload [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:37:45.268 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:25.04]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Login_MultipleFailedAttempts_ShouldLockAccount [FAIL]
[xUnit.net 00:01:25.04]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:25.04]       Stack Trace:
[xUnit.net 00:01:25.04]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:25.04]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:25.04]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:25.04]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:25.04]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:45.297 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:45.434 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:45.434 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:45.435 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:45.435 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:45.435 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:45.435 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:45.435 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:45.436 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:45.436 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:45.436 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:45.437 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:45.437 -05:00 [INF]  Program: Applying database migrations...
[xUnit.net 00:01:25.20]     LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.LinkExternalProvider_WhenUserNotFound_ShouldReturn400 [FAIL]
[xUnit.net 00:01:25.21]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:25.21]       Stack Trace:
[xUnit.net 00:01:25.21]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:25.21]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:25.21]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:25.21]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:01:25.21]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:25.21]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:01:25.21]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:45.465 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:45.587 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:45.587 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:45.587 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:45.627 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:45.627 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:45.627 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:45.627 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:45.627 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:45.627 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:45.628 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:45.628 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:45.628 -05:00 [INF]  Program: Applying database migrations...
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Login_MultipleFailedAttempts_ShouldLockAccount [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.LinkExternalProvider_WhenUserNotFound_ShouldReturn400 [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:01:27.62]     LankaConnect.IntegrationTests.Repositories.ServiceRepositoryTests.SearchByNameAsync_Should_Return_Services_Matching_Name [FAIL]
[xUnit.net 00:01:27.62]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:27.62]       Stack Trace:
[xUnit.net 00:01:27.62]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:27.62]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:27.62]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:27.63]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:01:27.63]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:27.63]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:01:27.63]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:47.877 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:47.995 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:48.006 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
  Failed LankaConnect.IntegrationTests.Repositories.ServiceRepositoryTests.SearchByNameAsync_Should_Return_Services_Matching_Name [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:37:48.998 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:28.78]     LankaConnect.IntegrationTests.Email.EmailApiTests.EmailApi_ShouldReturnCorrectErrorResponse [FAIL]
[xUnit.net 00:01:28.78]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:28.78]       Stack Trace:
[xUnit.net 00:01:28.78]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:28.78]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:28.78]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:28.78]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:28.78]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:49.032 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:49.220 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:49.220 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:49.220 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:49.220 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:49.220 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:49.220 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:49.221 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:49.221 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:49.221 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:49.221 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:49.222 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:49.222 -05:00 [INF]  Program: Applying database migrations...
[xUnit.net 00:01:28.99]     LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetEventsByRadiusAsync_Should_Only_Return_Published_Upcoming_Events [FAIL]
[xUnit.net 00:01:28.99]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:28.99]       Stack Trace:
[xUnit.net 00:01:28.99]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:28.99]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:28.99]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:28.99]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:01:28.99]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:28.99]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:01:28.99]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:49.245 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:49.447 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:49.448 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:49.448 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:49.485 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:49.485 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:49.485 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:49.485 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:49.485 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:49.485 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:49.485 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:49.486 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:49.486 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:49.505 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:49.519 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:49.708 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:29.49]     LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.ExternalProviderWorkflow_LinkGetUnlink_ShouldWorkEndToEnd [FAIL]
[xUnit.net 00:01:29.49]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:29.49]       Stack Trace:
[xUnit.net 00:01:29.49]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:29.49]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:29.49]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:29.49]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:29.49]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:49.734 -05:00 [INF]  : Starting LankaConnect API
  Failed LankaConnect.IntegrationTests.Email.EmailApiTests.EmailApi_ShouldReturnCorrectErrorResponse [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetEventsByRadiusAsync_Should_Only_Return_Published_Upcoming_Events [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.ExternalProviderWorkflow_LinkGetUnlink_ShouldWorkEndToEnd [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:37:49.908 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:49.908 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:49.908 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:49.908 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:49.908 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:49.909 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:49.909 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:49.909 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:49.909 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:49.909 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:49.910 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:49.910 -05:00 [INF]  Program: Applying database migrations...
[xUnit.net 00:01:31.67]     LankaConnect.IntegrationTests.Controllers.BusinessImagesControllerTests.DeleteBusinessImage_WithExistingImage_ShouldReturnNoContent [FAIL]
[xUnit.net 00:01:31.67]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:31.67]       Stack Trace:
[xUnit.net 00:01:31.67]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:31.67]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:31.67]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:31.67]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:31.67]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.BusinessImagesControllerTests.DeleteBusinessImage_WithExistingImage_ShouldReturnNoContent [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:37:51.925 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:52.095 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:52.095 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:52.095 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:52.096 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:52.096 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:52.096 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:52.096 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:52.096 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:52.097 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:52.097 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:52.097 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:52.097 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:52.145 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:32.76]     LankaConnect.IntegrationTests.Repositories.BusinessRepositoryTests.GetBusinessesWithFiltersAsync_Should_Apply_Multiple_Filters [FAIL]
[xUnit.net 00:01:32.76]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:32.76]       Stack Trace:
[xUnit.net 00:01:32.76]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:32.76]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:32.76]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:32.76]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:32.76]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:53.019 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:53.099 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:53.099 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:53.099 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:53.099 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:53.099 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:53.099 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:53.099 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:53.099 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:53.099 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:53.099 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:53.100 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:53.100 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:53.298 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:53.313 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
  Failed LankaConnect.IntegrationTests.Repositories.BusinessRepositoryTests.GetBusinessesWithFiltersAsync_Should_Apply_Multiple_Filters [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Passed LankaConnect.IntegrationTests.UnitTest1.Test1 [< 1 ms]
2026-01-24 08:37:53.566 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:33.34]     LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetEventsByRadiusAsync_Should_Exclude_Events_Without_Location [FAIL]
[xUnit.net 00:01:33.34]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:33.34]       Stack Trace:
[xUnit.net 00:01:33.34]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:33.34]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:33.34]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:33.34]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:33.34]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:53.583 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:53.702 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:53.703 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:53.703 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:53.703 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:53.703 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:53.703 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:53.703 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:53.703 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:53.703 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:53.703 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:53.704 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:53.704 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:53.962 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:53.976 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
  Failed LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetEventsByRadiusAsync_Should_Exclude_Events_Without_Location [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:01:35.83]     LankaConnect.IntegrationTests.Email.EmailIntegrationTests.EmailValidation_WithInvalidEmailAddress_ShouldHandleGracefully [FAIL]
[xUnit.net 00:01:35.83]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:35.83]       Stack Trace:
[xUnit.net 00:01:35.83]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:35.83]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:35.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:35.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:35.83]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:56.101 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:56.189 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:56.189 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:56.189 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:56.189 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:56.189 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:56.189 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:56.189 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:56.189 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:56.189 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:56.189 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:56.190 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:56.190 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:56.188 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:56.194 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
  Failed LankaConnect.IntegrationTests.Email.EmailIntegrationTests.EmailValidation_WithInvalidEmailAddress_ShouldHandleGracefully [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:37:57.168 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:36.95]     LankaConnect.IntegrationTests.Controllers.EntraAuthControllerTests.LoginWithEntra_WithValidToken_ExistingUser_ShouldReturn200AndNotCreateDuplicate [FAIL]
[xUnit.net 00:01:36.95]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:36.95]       Stack Trace:
[xUnit.net 00:01:36.95]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:36.95]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:36.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:36.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:36.95]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:57.203 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:57.338 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:57.338 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:57.338 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:57.338 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:57.339 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:57.339 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:57.339 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:57.339 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:57.339 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:57.339 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:57.339 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:57.339 -05:00 [INF]  Program: Applying database migrations...
[xUnit.net 00:01:37.20]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Register_WithDifferentRoles_ShouldCreateUserWithCorrectRole(role: GeneralUser) [FAIL]
[xUnit.net 00:01:37.20]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:37.20]       Stack Trace:
[xUnit.net 00:01:37.20]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:37.20]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:37.20]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:37.20]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:37.20]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:37:57.441 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:37:57.561 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:37:57.561 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:37:57.561 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:37:57.597 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:37:57.598 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:37:57.598 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:37:57.598 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:37:57.598 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:37:57.598 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:37:57.598 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:37:57.598 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:37:57.598 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:37:57.753 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:37:57.757 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
  Failed LankaConnect.IntegrationTests.Controllers.EntraAuthControllerTests.LoginWithEntra_WithValidToken_ExistingUser_ShouldReturn200AndNotCreateDuplicate [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Register_WithDifferentRoles_ShouldCreateUserWithCorrectRole(role: GeneralUser) [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:01:39.83]     LankaConnect.IntegrationTests.Repositories.ServiceRepositoryTests.GetServiceCountByBusinessIdAsync_Should_Return_Total_Count [FAIL]
[xUnit.net 00:01:39.83]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:39.83]       Stack Trace:
[xUnit.net 00:01:39.83]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:39.83]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:39.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:39.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:39.83]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Repositories.ServiceRepositoryTests.GetServiceCountByBusinessIdAsync_Should_Return_Total_Count [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:38:00.083 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:00.250 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:00.250 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:00.250 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:00.250 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:00.250 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:00.251 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:00.251 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:00.251 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:00.251 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:00.251 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:00.252 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:00.252 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:38:00.256 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:00.264 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:40.98]     LankaConnect.IntegrationTests.Email.EmailApiTests.GetEmailStatus_WithValidId_ShouldReturnEmailStatus [FAIL]
[xUnit.net 00:01:40.98]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:40.98]       Stack Trace:
[xUnit.net 00:01:40.98]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:40.98]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:40.98]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:40.98]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:40.98]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:01.238 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:01.422 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:01.432 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:01.432 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:01.432 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:01.433 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:01.433 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:01.433 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:01.433 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:01.433 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:01.433 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:01.433 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:01.434 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:01.434 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:38:01.441 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
  Failed LankaConnect.IntegrationTests.Email.EmailApiTests.GetEmailStatus_WithValidId_ShouldReturnEmailStatus [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:38:01.671 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:41.45]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Register_WithDifferentRoles_ShouldCreateUserWithCorrectRole(role: EventOrganizer) [FAIL]
[xUnit.net 00:01:41.45]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:41.45]       Stack Trace:
[xUnit.net 00:01:41.45]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:41.45]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:41.45]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:41.45]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:41.45]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:01.704 -05:00 [INF]  : Starting LankaConnect API
[xUnit.net 00:01:41.48]     LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.GetLinkedProviders_WithLinkedProviders_ShouldReturn200AndProviderList [FAIL]
[xUnit.net 00:01:41.48]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:41.48]       Stack Trace:
[xUnit.net 00:01:41.48]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:41.48]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:41.48]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:41.48]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:41.48]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:01.777 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:01.920 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:01.920 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:01.920 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:01.921 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:01.921 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:01.921 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:01.921 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:01.921 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:01.921 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:01.921 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:01.921 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:01.922 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:38:01.939 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:01.940 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:01.940 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:01.940 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:01.940 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:01.940 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:01.940 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:01.940 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:01.940 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:01.940 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:01.941 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:01.941 -05:00 [INF]  Program: Applying database migrations...
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Register_WithDifferentRoles_ShouldCreateUserWithCorrectRole(role: EventOrganizer) [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Controllers.ExternalProviderManagementTests.GetLinkedProviders_WithLinkedProviders_ShouldReturn200AndProviderList [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:01:44.03]     LankaConnect.IntegrationTests.Controllers.BusinessImagesControllerTests.UploadBusinessImage_WithValidImage_ShouldReturnCreated [FAIL]
[xUnit.net 00:01:44.03]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:44.03]       Stack Trace:
[xUnit.net 00:01:44.03]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:44.03]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:44.03]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:44.03]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:44.03]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:04.287 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:04.349 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:04.360 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
  Failed LankaConnect.IntegrationTests.Controllers.BusinessImagesControllerTests.UploadBusinessImage_WithValidImage_ShouldReturnCreated [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:38:05.504 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:45.28]     LankaConnect.IntegrationTests.Email.EmailApiTests.EmailApi_ShouldHandleRateLimiting [FAIL]
[xUnit.net 00:01:45.28]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:45.28]       Stack Trace:
[xUnit.net 00:01:45.28]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:45.28]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:45.28]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:45.28]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:45.28]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:05.550 -05:00 [INF]  : Starting LankaConnect API
[xUnit.net 00:01:45.38]     LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetEventsByRadiusAsync_Should_Return_Events_Within_50_Miles [FAIL]
[xUnit.net 00:01:45.38]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:45.38]       Stack Trace:
[xUnit.net 00:01:45.38]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:45.38]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:45.38]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:45.38]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:45.38]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:05.639 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:05.727 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:05.727 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:05.727 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:05.763 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:05.763 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:05.763 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:05.763 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:05.764 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:05.764 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:05.764 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:05.764 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:05.764 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:38:05.772 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:05.772 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:05.772 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:05.773 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:05.773 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:05.773 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:05.773 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:05.773 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:05.773 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:05.773 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:05.773 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:05.773 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:38:05.978 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:06.000 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:06.007 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:45.83]     LankaConnect.IntegrationTests.Email.MailHogIntegrationTests.SearchMailHogMessages_ShouldFindSpecificEmails [FAIL]
[xUnit.net 00:01:45.83]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:45.83]       Stack Trace:
[xUnit.net 00:01:45.83]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:45.83]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:45.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:45.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:45.83]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Email.EmailApiTests.EmailApi_ShouldHandleRateLimiting [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetEventsByRadiusAsync_Should_Return_Events_Within_50_Miles [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Email.MailHogIntegrationTests.SearchMailHogMessages_ShouldFindSpecificEmails [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:38:06.107 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:06.218 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:06.218 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:06.218 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:06.218 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:06.218 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:06.219 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:06.219 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:06.219 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:06.219 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:06.219 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:06.219 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:06.219 -05:00 [INF]  Program: Applying database migrations...
[xUnit.net 00:01:48.01]     LankaConnect.IntegrationTests.Email.EmailIntegrationTests.EmailTracking_ShouldUpdateEmailStatus [FAIL]
[xUnit.net 00:01:48.01]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:48.01]       Stack Trace:
[xUnit.net 00:01:48.01]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:48.01]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:48.01]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:48.01]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:48.01]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Email.EmailIntegrationTests.EmailTracking_ShouldUpdateEmailStatus [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:38:08.261 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:08.398 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:08.398 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:08.400 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:08.438 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:08.438 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:08.438 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:08.438 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:08.438 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:08.439 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:08.439 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:08.439 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:08.439 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:38:08.558 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:49.21]     LankaConnect.IntegrationTests.Controllers.EntraAuthControllerTests.LoginWithEntra_WhenEntraDisabled_ShouldReturn400BadRequest [FAIL]
[xUnit.net 00:01:49.21]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:49.21]       Stack Trace:
[xUnit.net 00:01:49.21]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:49.21]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:49.21]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:49.21]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:49.21]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:09.466 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:09.573 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:09.574 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:09.574 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:09.574 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:09.574 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:09.574 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:09.574 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:09.574 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:09.574 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:09.574 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:09.574 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:09.574 -05:00 [INF]  Program: Applying database migrations...
  Failed LankaConnect.IntegrationTests.Controllers.EntraAuthControllerTests.LoginWithEntra_WhenEntraDisabled_ShouldReturn400BadRequest [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:38:09.827 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:09.844 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:09.846 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:09.853 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:49.66]     LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetEventsByCityAsync_Should_Be_Case_Insensitive [FAIL]
[xUnit.net 00:01:49.66]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:49.66]       Stack Trace:
[xUnit.net 00:01:49.66]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:49.66]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:49.66]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:49.66]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:49.66]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:09.907 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:10.031 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:10.032 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:10.032 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:10.032 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:10.032 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:10.032 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:10.032 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:10.032 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:10.032 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:10.033 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:10.033 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:10.033 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:38:10.288 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:10.299 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
  Failed LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetEventsByCityAsync_Should_Be_Case_Insensitive [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:01:52.20]     LankaConnect.IntegrationTests.Repositories.ServiceRepositoryTests.GetByBusinessIdAsync_Should_Return_All_Services_For_Business [FAIL]
[xUnit.net 00:01:52.20]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:52.20]       Stack Trace:
[xUnit.net 00:01:52.20]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:52.20]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:52.20]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:52.20]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:52.20]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:12.469 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:12.535 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:12.539 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
  Failed LankaConnect.IntegrationTests.Repositories.ServiceRepositoryTests.GetByBusinessIdAsync_Should_Return_All_Services_For_Business [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:38:13.638 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:53.41]     LankaConnect.IntegrationTests.Controllers.EntraAuthControllerTests.LoginWithEntra_ShouldReturnRefreshTokenInResponse [FAIL]
[xUnit.net 00:01:53.41]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:53.41]       Stack Trace:
[xUnit.net 00:01:53.41]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:53.41]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:53.41]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:53.41]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:53.41]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:13.677 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:13.787 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:13.787 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:13.788 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:13.788 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:13.788 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:13.788 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:13.788 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:13.788 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:13.788 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:13.788 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:13.788 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:13.788 -05:00 [INF]  Program: Applying database migrations...
[xUnit.net 00:01:53.60]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Register_WithDifferentRoles_ShouldCreateUserWithCorrectRole(role: Admin) [FAIL]
[xUnit.net 00:01:53.60]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:53.60]       Stack Trace:
[xUnit.net 00:01:53.60]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:53.60]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:53.60]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:53.60]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:53.60]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:13.848 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:13.957 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:13.957 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:13.957 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:13.990 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:13.990 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:13.990 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:13.990 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:13.990 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:13.990 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:13.990 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:13.991 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:13.991 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:38:14.113 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:14.119 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
  Failed LankaConnect.IntegrationTests.Controllers.EntraAuthControllerTests.LoginWithEntra_ShouldReturnRefreshTokenInResponse [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Register_WithDifferentRoles_ShouldCreateUserWithCorrectRole(role: Admin) [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:01:56.20]     LankaConnect.IntegrationTests.Controllers.BusinessImagesControllerTests.ReorderBusinessImages_WithValidOrder_ShouldReturnNoContent [FAIL]
[xUnit.net 00:01:56.20]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:56.20]       Stack Trace:
[xUnit.net 00:01:56.20]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:56.20]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:56.20]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:56.20]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:56.20]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.BusinessImagesControllerTests.ReorderBusinessImages_WithValidOrder_ShouldReturnNoContent [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:38:16.456 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:16.620 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:16.620 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:16.620 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:16.621 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:16.621 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:16.621 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:16.621 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:16.621 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:16.621 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:16.621 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:16.622 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:16.622 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:38:16.653 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:57.40]     LankaConnect.IntegrationTests.Email.EmailApiTests.SendEmailVerification_WithInvalidEmail_ShouldReturnBadRequest [FAIL]
[xUnit.net 00:01:57.40]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:57.40]       Stack Trace:
[xUnit.net 00:01:57.40]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:57.40]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:57.41]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:57.41]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:57.41]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:17.656 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:17.853 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:17.853 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:17.853 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:17.853 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:17.853 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:17.854 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:17.854 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:17.854 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:17.854 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:17.854 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:17.856 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:17.857 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:38:17.860 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:17.876 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
  Failed LankaConnect.IntegrationTests.Email.EmailApiTests.SendEmailVerification_WithInvalidEmail_ShouldReturnBadRequest [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:01:57.83]     LankaConnect.IntegrationTests.Email.MailHogIntegrationTests.LargeEmailContent_ShouldBeHandledCorrectly [FAIL]
[xUnit.net 00:01:57.83]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:57.83]       Stack Trace:
[xUnit.net 00:01:57.83]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:57.83]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:57.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:57.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:57.83]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:18.065 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:01:57.84]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Register_WithDifferentRoles_ShouldCreateUserWithCorrectRole(role: AdminManager) [FAIL]
[xUnit.net 00:01:57.84]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:01:57.84]       Stack Trace:
[xUnit.net 00:01:57.84]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:01:57.84]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:01:57.84]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:01:57.84]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:01:57.84]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:18.109 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:18.116 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:18.354 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:18.354 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:18.354 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:18.354 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:18.356 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:18.356 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:18.356 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:18.356 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:18.357 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:18.357 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:18.357 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:18.357 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:18.357 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:18.357 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:18.357 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:18.357 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:18.357 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:38:18.357 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:18.357 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:18.358 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:18.358 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:18.358 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:18.358 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:18.358 -05:00 [INF]  Program: Applying database migrations...
  Failed LankaConnect.IntegrationTests.Email.MailHogIntegrationTests.LargeEmailContent_ShouldBeHandledCorrectly [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Register_WithDifferentRoles_ShouldCreateUserWithCorrectRole(role: AdminManager) [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:02:00.40]     LankaConnect.IntegrationTests.Email.EmailIntegrationTests.BulkEmailOperations_ShouldProcessEfficiently [FAIL]
[xUnit.net 00:02:00.40]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:00.40]       Stack Trace:
[xUnit.net 00:02:00.40]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:00.40]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:00.40]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:00.40]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:00.40]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:20.658 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:20.684 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:20.729 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
  Failed LankaConnect.IntegrationTests.Email.EmailIntegrationTests.BulkEmailOperations_ShouldProcessEfficiently [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:38:21.925 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:02:01.70]     LankaConnect.IntegrationTests.Email.EmailApiTests.EmailApi_ShouldHandleContentNegotiation [FAIL]
[xUnit.net 00:02:01.70]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:01.70]       Stack Trace:
[xUnit.net 00:02:01.70]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:01.70]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:01.70]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:01.70]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:01.70]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
[xUnit.net 00:02:01.79]     LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetNearestEventsAsync_Should_Return_Events_Ordered_By_Distance [FAIL]
[xUnit.net 00:02:01.79]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:01.79]       Stack Trace:
[xUnit.net 00:02:01.79]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:01.79]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:01.79]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:01.79]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:01.79]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:22.062 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:22.280 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:22.280 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:22.280 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:22.280 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:22.281 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:22.281 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:22.281 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:22.281 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:22.281 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:22.281 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:22.282 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:22.282 -05:00 [INF]  Program: Applying database migrations...
[xUnit.net 00:02:02.17]     LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.PostgreSQL_Container_IsAccessible [FAIL]
[xUnit.net 00:02:02.17]       Npgsql.NpgsqlException : Failed to connect to 127.0.0.1:5432
[xUnit.net 00:02:02.17]       ---- System.Net.Sockets.SocketException : No connection could be made because the target machine actively refused it.
[xUnit.net 00:02:02.17]       Stack Trace:
[xUnit.net 00:02:02.17]            at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
[xUnit.net 00:02:02.17]            at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
[xUnit.net 00:02:02.17]            at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
[xUnit.net 00:02:02.17]            at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
[xUnit.net 00:02:02.17]            at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
[xUnit.net 00:02:02.17]            at Npgsql.PoolingDataSource.<Get>g__RentAsync|33_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
[xUnit.net 00:02:02.17]            at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
[xUnit.net 00:02:02.17]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DockerConnectivityTests.cs(38,0): at LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.PostgreSQL_Container_IsAccessible()
[xUnit.net 00:02:02.17]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DockerConnectivityTests.cs(46,0): at LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.PostgreSQL_Container_IsAccessible()
[xUnit.net 00:02:02.17]         --- End of stack trace from previous location ---
[xUnit.net 00:02:02.18]         ----- Inner Stack Trace -----
[xUnit.net 00:02:02.18]            at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
[xUnit.net 00:02:02.18]            at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
[xUnit.net 00:02:02.18]            at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
[xUnit.net 00:02:02.18]            at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
[xUnit.net 00:02:02.18]            at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
[xUnit.net 00:02:02.20]     LankaConnect.IntegrationTests.Infrastructure.LoggingConfigurationTests.RequestLogging_WorksInWebContext [FAIL]
[xUnit.net 00:02:02.20]       Expected logEvents {empty} to have an item matching e.MessageTemplate.Text.Contains("Test log message from endpoint").
[xUnit.net 00:02:02.20]       Stack Trace:
[xUnit.net 00:02:02.20]            at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
[xUnit.net 00:02:02.20]            at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
[xUnit.net 00:02:02.20]            at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
[xUnit.net 00:02:02.20]            at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
[xUnit.net 00:02:02.20]            at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
[xUnit.net 00:02:02.21]            at FluentAssertions.Execution.AssertionScope.FailWith(String message, Object[] args)
[xUnit.net 00:02:02.21]            at FluentAssertions.Collections.GenericCollectionAssertions`3.Contain(Expression`1 predicate, String because, Object[] becauseArgs)
[xUnit.net 00:02:02.21]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\LoggingConfigurationTests.cs(201,0): at LankaConnect.IntegrationTests.Infrastructure.LoggingConfigurationTests.RequestLogging_WorksInWebContext()
[xUnit.net 00:02:02.21]         --- End of stack trace from previous location ---
  Failed LankaConnect.IntegrationTests.Email.EmailApiTests.EmailApi_ShouldHandleContentNegotiation [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetNearestEventsAsync_Should_Return_Events_Ordered_By_Distance [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.PostgreSQL_Container_IsAccessible [1 m 42 s]
  Error Message:
   Npgsql.NpgsqlException : Failed to connect to 127.0.0.1:5432
---- System.Net.Sockets.SocketException : No connection could be made because the target machine actively refused it.
  Stack Trace:
     at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|33_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.PostgreSQL_Container_IsAccessible() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DockerConnectivityTests.cs:line 38
   at LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.PostgreSQL_Container_IsAccessible() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DockerConnectivityTests.cs:line 46
--- End of stack trace from previous location ---
----- Inner Stack Trace -----
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
  Failed LankaConnect.IntegrationTests.Infrastructure.LoggingConfigurationTests.RequestLogging_WorksInWebContext [1 m 42 s]
  Error Message:
   Expected logEvents {empty} to have an item matching e.MessageTemplate.Text.Contains("Test log message from endpoint").
  Stack Trace:
     at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(String message, Object[] args)
   at FluentAssertions.Collections.GenericCollectionAssertions`3.Contain(Expression`1 predicate, String because, Object[] becauseArgs)
   at LankaConnect.IntegrationTests.Infrastructure.LoggingConfigurationTests.RequestLogging_WorksInWebContext() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\LoggingConfigurationTests.cs:line 201
--- End of stack trace from previous location ---
2026-01-24 08:38:22.473 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:22.473 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:02:02.34]     LankaConnect.IntegrationTests.Email.MailHogIntegrationTests.VerifyEmailHeaders_ShouldContainCorrectMetadata [FAIL]
[xUnit.net 00:02:02.34]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:02.34]       Stack Trace:
[xUnit.net 00:02:02.34]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:02.34]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:02.34]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:02.34]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:02.34]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:22.591 -05:00 [INF]  : Starting LankaConnect API
[xUnit.net 00:02:02.44]     LankaConnect.IntegrationTests.Infrastructure.LoggingConfigurationTests.LogEnrichment_AddsExpectedProperties [FAIL]
[xUnit.net 00:02:02.44]       Expected enrichedEvent.Properties["Application"].ToString() ""LankaConnect.API"" to contain "LankaConnect.Tests".
[xUnit.net 00:02:02.44]       Stack Trace:
[xUnit.net 00:02:02.44]            at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
[xUnit.net 00:02:02.44]            at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
[xUnit.net 00:02:02.44]            at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
[xUnit.net 00:02:02.44]            at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
[xUnit.net 00:02:02.44]            at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
[xUnit.net 00:02:02.44]            at FluentAssertions.Execution.AssertionScope.FailWith(String message, Object[] args)
[xUnit.net 00:02:02.44]            at FluentAssertions.Primitives.StringAssertions`1.Contain(String expected, String because, Object[] becauseArgs)
[xUnit.net 00:02:02.44]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\LoggingConfigurationTests.cs(169,0): at LankaConnect.IntegrationTests.Infrastructure.LoggingConfigurationTests.LogEnrichment_AddsExpectedProperties()
[xUnit.net 00:02:02.44]            at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
[xUnit.net 00:02:02.44]            at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
[xUnit.net 00:02:02.61]     LankaConnect.IntegrationTests.Phase6A53VerificationTests.VerifyEmailTemplateMigrationApplied [FAIL]
[xUnit.net 00:02:02.61]       Npgsql.PostgresException : 42703: column "id" does not exist
[xUnit.net 00:02:02.61]       
[xUnit.net 00:02:02.61]       POSITION: 8
[xUnit.net 00:02:02.61]       Stack Trace:
[xUnit.net 00:02:02.61]            at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
[xUnit.net 00:02:02.61]            at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
[xUnit.net 00:02:02.61]            at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
[xUnit.net 00:02:02.61]            at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
[xUnit.net 00:02:02.61]            at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
[xUnit.net 00:02:02.61]            at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
[xUnit.net 00:02:02.61]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Phase6A53VerificationTests.cs(59,0): at LankaConnect.IntegrationTests.Phase6A53VerificationTests.VerifyEmailTemplateMigrationApplied()
[xUnit.net 00:02:02.61]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Phase6A53VerificationTests.cs(93,0): at LankaConnect.IntegrationTests.Phase6A53VerificationTests.VerifyEmailTemplateMigrationApplied()
[xUnit.net 00:02:02.61]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Phase6A53VerificationTests.cs(140,0): at LankaConnect.IntegrationTests.Phase6A53VerificationTests.VerifyEmailTemplateMigrationApplied()
[xUnit.net 00:02:02.61]         --- End of stack trace from previous location ---
[xUnit.net 00:02:02.61]       Output:
[xUnit.net 00:02:02.61]         ✅ Database connected successfully!
[xUnit.net 00:02:02.61]         
[xUnit.net 00:02:02.61]         === CHECK 1: Email Template Migration Status ===
[xUnit.net 00:02:02.61]         ✅ Migration Applied: 20251229231742_Phase6A53Fix3_RevertToCorrectTemplateNoLogo
[xUnit.net 00:02:02.61]            Product Version: 8.0.19
[xUnit.net 00:02:02.61]         
[xUnit.net 00:02:02.61]         === CHECK 2: Email Template Content ===
  Failed LankaConnect.IntegrationTests.Email.MailHogIntegrationTests.VerifyEmailHeaders_ShouldContainCorrectMetadata [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Passed LankaConnect.IntegrationTests.Infrastructure.LoggingConfigurationTests.ExceptionLogging_CapturesFullDetails [148 ms]
  Failed LankaConnect.IntegrationTests.Infrastructure.LoggingConfigurationTests.LogEnrichment_AddsExpectedProperties [82 ms]
  Error Message:
   Expected enrichedEvent.Properties["Application"].ToString() ""LankaConnect.API"" to contain "LankaConnect.Tests".
  Stack Trace:
     at FluentAssertions.Execution.XUnit2TestFramework.Throw(String message)
   at FluentAssertions.Execution.TestFrameworkProvider.Throw(String message)
   at FluentAssertions.Execution.DefaultAssertionStrategy.HandleFailure(String message)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(Func`1 failReasonFunc)
   at FluentAssertions.Execution.AssertionScope.FailWith(String message, Object[] args)
   at FluentAssertions.Primitives.StringAssertions`1.Contain(String expected, String because, Object[] becauseArgs)
   at LankaConnect.IntegrationTests.Infrastructure.LoggingConfigurationTests.LogEnrichment_AddsExpectedProperties() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\LoggingConfigurationTests.cs:line 169
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
  Passed LankaConnect.IntegrationTests.Infrastructure.LoggingConfigurationTests.SerilogConfiguration_IsSetupCorrectly [167 ms]
  Failed LankaConnect.IntegrationTests.Phase6A53VerificationTests.VerifyEmailTemplateMigrationApplied [2 m 1 s]
  Error Message:
   Npgsql.PostgresException : 42703: column "id" does not exist

POSITION: 8
  Stack Trace:
     at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at LankaConnect.IntegrationTests.Phase6A53VerificationTests.VerifyEmailTemplateMigrationApplied() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Phase6A53VerificationTests.cs:line 59
   at LankaConnect.IntegrationTests.Phase6A53VerificationTests.VerifyEmailTemplateMigrationApplied() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Phase6A53VerificationTests.cs:line 93
   at LankaConnect.IntegrationTests.Phase6A53VerificationTests.VerifyEmailTemplateMigrationApplied() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Phase6A53VerificationTests.cs:line 140
--- End of stack trace from previous location ---
  Standard Output Messages:
 ✅ Database connected successfully!
 
 === CHECK 1: Email Template Migration Status ===
 ✅ Migration Applied: 20251229231742_Phase6A53Fix3_RevertToCorrectTemplateNoLogo
    Product Version: 8.0.19
 
 === CHECK 2: Email Template Content ===


[xUnit.net 00:02:04.40]     LankaConnect.IntegrationTests.Repositories.ServiceRepositoryTests.GetByPriceRangeAsync_Should_Return_Services_In_Price_Range [FAIL]
[xUnit.net 00:02:04.40]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:04.40]       Stack Trace:
[xUnit.net 00:02:04.40]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:04.40]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:04.40]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:04.40]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:04.40]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:24.651 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:24.865 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:24.865 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:24.865 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:24.866 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:24.866 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:24.867 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:24.867 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:24.867 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:24.867 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:24.867 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:24.868 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:24.869 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:38:24.948 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
  Failed LankaConnect.IntegrationTests.Repositories.ServiceRepositoryTests.GetByPriceRangeAsync_Should_Return_Services_In_Price_Range [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:02:05.62]     LankaConnect.IntegrationTests.Controllers.EntraAuthControllerTests.LoginWithEntra_WithValidToken_NewUser_ShouldReturn200AndAutoProvisionUser [FAIL]
[xUnit.net 00:02:05.62]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:05.62]       Stack Trace:
[xUnit.net 00:02:05.62]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:05.62]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:05.62]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:05.62]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:05.62]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:25.871 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:26.042 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:26.042 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:26.043 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:26.043 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:26.043 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:26.043 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:26.043 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:26.043 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:26.043 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:26.044 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:26.044 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:26.045 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:38:26.359 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:26.376 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:02:06.26]     LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.MailHog_Container_IsAccessible [FAIL]
[xUnit.net 00:02:06.26]       System.Net.Sockets.SocketException : No connection could be made because the target machine actively refused it.
[xUnit.net 00:02:06.26]       Stack Trace:
[xUnit.net 00:02:06.26]            at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
[xUnit.net 00:02:06.26]            at System.Threading.Tasks.ValueTask.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
[xUnit.net 00:02:06.26]         --- End of stack trace from previous location ---
[xUnit.net 00:02:06.26]            at System.Net.Sockets.TcpClient.CompleteConnectAsync(Task task)
[xUnit.net 00:02:06.26]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DockerConnectivityTests.cs(79,0): at LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.MailHog_Container_IsAccessible()
[xUnit.net 00:02:06.26]         --- End of stack trace from previous location ---
[xUnit.net 00:02:06.68]     LankaConnect.IntegrationTests.Email.MailHogIntegrationTests.SendMultipleEmails_ShouldAllAppearInMailHog [FAIL]
[xUnit.net 00:02:06.68]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:06.68]       Stack Trace:
[xUnit.net 00:02:06.68]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:06.68]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:06.68]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:06.68]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:06.68]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:26.930 -05:00 [INF]  : Starting LankaConnect API
  Failed LankaConnect.IntegrationTests.Controllers.EntraAuthControllerTests.LoginWithEntra_WithValidToken_NewUser_ShouldReturn200AndAutoProvisionUser [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.MailHog_Container_IsAccessible [4 s]
  Error Message:
   System.Net.Sockets.SocketException : No connection could be made because the target machine actively refused it.
  Stack Trace:
     at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(Task task)
   at LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.MailHog_Container_IsAccessible() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DockerConnectivityTests.cs:line 79
--- End of stack trace from previous location ---
  Failed LankaConnect.IntegrationTests.Email.MailHogIntegrationTests.SendMultipleEmails_ShouldAllAppearInMailHog [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:38:27.125 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:27.125 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:27.125 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:27.126 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:27.126 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:27.126 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:27.126 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:27.126 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:27.126 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:27.126 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:27.127 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:27.127 -05:00 [INF]  Program: Applying database migrations...
[xUnit.net 00:02:08.65]     LankaConnect.IntegrationTests.Controllers.BusinessImagesControllerTests.UploadBusinessImage_WithNonExistentBusiness_ShouldReturnBadRequest [FAIL]
[xUnit.net 00:02:08.65]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:08.65]       Stack Trace:
[xUnit.net 00:02:08.65]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:08.65]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:08.65]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:08.65]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:08.65]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.BusinessImagesControllerTests.UploadBusinessImage_WithNonExistentBusiness_ShouldReturnBadRequest [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:38:28.899 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:28.972 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:28.982 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:30.141 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:02:09.92]     LankaConnect.IntegrationTests.Controllers.EntraAuthControllerTests.LoginWithEntra_WithExpiredToken_ShouldReturn401Unauthorized [FAIL]
[xUnit.net 00:02:09.92]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:09.92]       Stack Trace:
[xUnit.net 00:02:09.92]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:09.92]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:09.92]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:09.92]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:09.92]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:30.181 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:30.373 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:30.373 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:30.373 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:30.374 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:30.374 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:30.374 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:30.374 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:30.374 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:30.374 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:30.374 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:30.376 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:30.377 -05:00 [INF]  Program: Applying database migrations...
  Failed LankaConnect.IntegrationTests.Controllers.EntraAuthControllerTests.LoginWithEntra_WithExpiredToken_ShouldReturn401Unauthorized [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:02:10.51]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Logout_WithoutAuthentication_ShouldReturn401Unauthorized [FAIL]
[xUnit.net 00:02:10.51]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:10.51]       Stack Trace:
[xUnit.net 00:02:10.52]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:10.52]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:10.52]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:10.52]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:10.52]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:30.778 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:31.145 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:31.145 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:31.145 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:31.146 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:31.147 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:31.147 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:31.147 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:31.147 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:31.147 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:31.148 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:31.148 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:31.149 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:38:31.238 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:31.263 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Logout_WithoutAuthentication_ShouldReturn401Unauthorized [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:02:12.69]     LankaConnect.IntegrationTests.Email.EmailIntegrationTests.ProcessEmailQueueAsync_WithQueuedEmails_ShouldProcessThem [FAIL]
[xUnit.net 00:02:12.69]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:12.69]       Stack Trace:
[xUnit.net 00:02:12.69]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:12.69]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:12.69]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:12.69]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:12.69]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:32.943 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:33.097 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:33.097 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:33.098 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:33.098 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:33.098 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:33.098 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:33.098 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:33.098 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:33.098 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:33.098 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:33.099 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:33.099 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:38:33.192 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
  Failed LankaConnect.IntegrationTests.Email.EmailIntegrationTests.ProcessEmailQueueAsync_WithQueuedEmails_ShouldProcessThem [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:02:13.84]     LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetNearestEventsAsync_Should_Exclude_Events_Without_Coordinates [FAIL]
[xUnit.net 00:02:13.84]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:13.84]       Stack Trace:
[xUnit.net 00:02:13.84]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:13.84]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:13.84]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:13.84]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:13.84]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:34.453 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:02:14.23]     LankaConnect.IntegrationTests.Controllers.EntraAuthControllerTests.LoginWithEntra_WithMissingAccessToken_ShouldReturn400BadRequest [FAIL]
[xUnit.net 00:02:14.24]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:14.24]       Stack Trace:
[xUnit.net 00:02:14.24]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:14.24]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:14.24]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:14.24]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:14.24]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:34.487 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:34.642 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:34.642 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:34.642 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:34.643 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:34.643 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:34.643 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:34.643 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:34.643 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:34.644 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:34.644 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:34.644 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:34.644 -05:00 [INF]  Program: Applying database migrations...
  Failed LankaConnect.IntegrationTests.Repositories.EventRepositoryLocationTests.GetNearestEventsAsync_Should_Exclude_Events_Without_Coordinates [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Controllers.EntraAuthControllerTests.LoginWithEntra_WithMissingAccessToken_ShouldReturn400BadRequest [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:38:35.235 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:35.244 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:02:16.87]     LankaConnect.IntegrationTests.Repositories.ServiceRepositoryTests.DeactivateAllByBusinessIdAsync_Should_Deactivate_All_Services [FAIL]
[xUnit.net 00:02:16.87]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:16.87]       Stack Trace:
[xUnit.net 00:02:16.88]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:16.88]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:16.88]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:16.88]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:16.88]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:37.185 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:02:16.96]     LankaConnect.IntegrationTests.Email.EmailIntegrationTests.SendEmailAsync_WithHtmlContent_ShouldSendMultipartEmail [FAIL]
[xUnit.net 00:02:16.96]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:16.96]       Stack Trace:
[xUnit.net 00:02:16.96]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:16.96]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:16.96]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:16.96]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:16.96]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Repositories.ServiceRepositoryTests.DeactivateAllByBusinessIdAsync_Should_Deactivate_All_Services [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Email.EmailIntegrationTests.SendEmailAsync_WithHtmlContent_ShouldSendMultipartEmail [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:38:37.214 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:37.370 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:37.370 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:37.370 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:37.370 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:37.370 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:37.370 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:37.371 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:37.371 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:37.371 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:37.371 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:37.371 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:37.371 -05:00 [INF]  Program: Applying database migrations...
[xUnit.net 00:02:18.48]     LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.Docker_NetworkConnectivity_WorksCorrectly [FAIL]
[xUnit.net 00:02:18.48]       StackExchange.Redis.RedisConnectionException : It was not possible to connect to the redis server(s). Error connecting right now. To allow this multiplexer to continue retrying until it's able to connect, use abortConnect=false in your connection string or AbortOnConnectFail=false; in your code.
[xUnit.net 00:02:18.48]       Stack Trace:
[xUnit.net 00:02:18.48]         /_/src/StackExchange.Redis/ConnectionMultiplexer.cs(716,0): at StackExchange.Redis.ConnectionMultiplexer.ConnectImpl(ConfigurationOptions configuration, TextWriter writer, Nullable`1 serverType, EndPointCollection endpoints)
[xUnit.net 00:02:18.48]         /_/src/StackExchange.Redis/ConnectionMultiplexer.cs(678,0): at StackExchange.Redis.ConnectionMultiplexer.Connect(ConfigurationOptions configuration, TextWriter log)
[xUnit.net 00:02:18.48]         /_/src/StackExchange.Redis/ConnectionMultiplexer.cs(656,0): at StackExchange.Redis.ConnectionMultiplexer.Connect(String configuration, TextWriter log)
[xUnit.net 00:02:18.48]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DockerConnectivityTests.cs(140,0): at LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.Docker_NetworkConnectivity_WorksCorrectly()
[xUnit.net 00:02:18.48]         --- End of stack trace from previous location ---
  Failed LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.Docker_NetworkConnectivity_WorksCorrectly [12 s]
  Error Message:
   StackExchange.Redis.RedisConnectionException : It was not possible to connect to the redis server(s). Error connecting right now. To allow this multiplexer to continue retrying until it's able to connect, use abortConnect=false in your connection string or AbortOnConnectFail=false; in your code.
  Stack Trace:
     at StackExchange.Redis.ConnectionMultiplexer.ConnectImpl(ConfigurationOptions configuration, TextWriter writer, Nullable`1 serverType, EndPointCollection endpoints) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 716
   at StackExchange.Redis.ConnectionMultiplexer.Connect(ConfigurationOptions configuration, TextWriter log) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 678
   at StackExchange.Redis.ConnectionMultiplexer.Connect(String configuration, TextWriter log) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 656
   at LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.Docker_NetworkConnectivity_WorksCorrectly() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DockerConnectivityTests.cs:line 140
--- End of stack trace from previous location ---
2026-01-24 08:38:38.713 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:38.744 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:02:18.80]     LankaConnect.IntegrationTests.Email.MailHogIntegrationTests.DeleteMailHogMessages_ShouldClearInbox [FAIL]
[xUnit.net 00:02:18.80]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:18.80]       Stack Trace:
[xUnit.net 00:02:18.80]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:18.80]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:18.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:18.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:18.80]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:39.051 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:39.191 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:39.192 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:39.192 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:39.192 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:39.192 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:39.192 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:39.192 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:39.192 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:39.192 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:39.192 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:39.193 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:39.193 -05:00 [INF]  Program: Applying database migrations...
  Failed LankaConnect.IntegrationTests.Email.MailHogIntegrationTests.DeleteMailHogMessages_ShouldClearInbox [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:02:20.88]     LankaConnect.IntegrationTests.Controllers.BusinessImagesControllerTests.UploadBusinessImage_WithLargeFile_ShouldReturnBadRequest [FAIL]
[xUnit.net 00:02:20.88]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:20.88]       Stack Trace:
[xUnit.net 00:02:20.88]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:20.88]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:20.88]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:20.88]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:20.88]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:41.435 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:41.441 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
  Failed LankaConnect.IntegrationTests.Controllers.BusinessImagesControllerTests.UploadBusinessImage_WithLargeFile_ShouldReturnBadRequest [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:02:22.43]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Register_WithValidData_ShouldReturn201Created [FAIL]
[xUnit.net 00:02:22.43]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:22.43]       Stack Trace:
[xUnit.net 00:02:22.43]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:22.44]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:22.44]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:22.44]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:22.44]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:42.695 -05:00 [INF]  : Starting LankaConnect API
[xUnit.net 00:02:22.64]     LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.RedisCommander_Container_IsAccessible [FAIL]
[xUnit.net 00:02:22.64]       System.Net.Http.HttpRequestException : No connection could be made because the target machine actively refused it. (localhost:8082)
[xUnit.net 00:02:22.64]       ---- System.Net.Sockets.SocketException : No connection could be made because the target machine actively refused it.
[xUnit.net 00:02:22.64]       Stack Trace:
[xUnit.net 00:02:22.64]            at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)
[xUnit.net 00:02:22.64]            at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
[xUnit.net 00:02:22.64]            at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
[xUnit.net 00:02:22.64]            at System.Net.Http.HttpConnectionPool.AddHttp11ConnectionAsync(QueueItem queueItem)
[xUnit.net 00:02:22.64]            at System.Threading.Tasks.TaskCompletionSourceWithCancellation`1.WaitWithCancellationAsync(CancellationToken cancellationToken)
[xUnit.net 00:02:22.64]            at System.Net.Http.HttpConnectionPool.SendWithVersionDetectionAndRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
[xUnit.net 00:02:22.64]            at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
[xUnit.net 00:02:22.64]            at System.Net.Http.HttpClient.<SendAsync>g__Core|83_0(HttpRequestMessage request, HttpCompletionOption completionOption, CancellationTokenSource cts, Boolean disposeCts, CancellationTokenSource pendingRequestsCts, CancellationToken originalCancellationToken)
[xUnit.net 00:02:22.64]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DockerConnectivityTests.cs(126,0): at LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.RedisCommander_Container_IsAccessible()
[xUnit.net 00:02:22.64]         --- End of stack trace from previous location ---
[xUnit.net 00:02:22.64]         ----- Inner Stack Trace -----
[xUnit.net 00:02:22.64]            at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
[xUnit.net 00:02:22.64]            at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
[xUnit.net 00:02:22.64]            at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)
2026-01-24 08:38:42.880 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:42.881 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:42.881 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:42.881 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:42.881 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:42.881 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:42.881 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:42.881 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:42.881 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:42.881 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:42.882 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:42.882 -05:00 [INF]  Program: Applying database migrations...
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Register_WithValidData_ShouldReturn201Created [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.RedisCommander_Container_IsAccessible [4 s]
  Error Message:
   System.Net.Http.HttpRequestException : No connection could be made because the target machine actively refused it. (localhost:8082)
---- System.Net.Sockets.SocketException : No connection could be made because the target machine actively refused it.
  Stack Trace:
     at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.AddHttp11ConnectionAsync(QueueItem queueItem)
   at System.Threading.Tasks.TaskCompletionSourceWithCancellation`1.WaitWithCancellationAsync(CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithVersionDetectionAndRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.<SendAsync>g__Core|83_0(HttpRequestMessage request, HttpCompletionOption completionOption, CancellationTokenSource cts, Boolean disposeCts, CancellationTokenSource pendingRequestsCts, CancellationToken originalCancellationToken)
   at LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.RedisCommander_Container_IsAccessible() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DockerConnectivityTests.cs:line 126
--- End of stack trace from previous location ---
----- Inner Stack Trace -----
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)
2026-01-24 08:38:43.285 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:43.291 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:02:25.15]     LankaConnect.IntegrationTests.Controllers.EntraAuthControllerTests.LoginWithEntra_WithEmailAlreadyRegisteredLocally_ShouldReturn400BadRequest [FAIL]
[xUnit.net 00:02:25.15]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:25.15]       Stack Trace:
[xUnit.net 00:02:25.15]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:25.15]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:25.16]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:25.16]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:25.16]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.EntraAuthControllerTests.LoginWithEntra_WithEmailAlreadyRegisteredLocally_ShouldReturn400BadRequest [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:38:45.406 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:45.552 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:45.552 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:45.552 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:45.552 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:45.552 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:45.552 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:45.552 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:45.552 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:45.552 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:45.552 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:45.553 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:45.553 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:38:46.973 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:46.982 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:02:26.80]     LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.Azurite_Container_IsAccessible [FAIL]
[xUnit.net 00:02:26.80]       System.Net.Http.HttpRequestException : No connection could be made because the target machine actively refused it. (localhost:10000)
[xUnit.net 00:02:26.80]       ---- System.Net.Sockets.SocketException : No connection could be made because the target machine actively refused it.
[xUnit.net 00:02:26.80]       Stack Trace:
[xUnit.net 00:02:26.80]            at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)
[xUnit.net 00:02:26.80]            at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
[xUnit.net 00:02:26.80]            at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
[xUnit.net 00:02:26.80]            at System.Net.Http.HttpConnectionPool.AddHttp11ConnectionAsync(QueueItem queueItem)
[xUnit.net 00:02:26.80]            at System.Threading.Tasks.TaskCompletionSourceWithCancellation`1.WaitWithCancellationAsync(CancellationToken cancellationToken)
[xUnit.net 00:02:26.80]            at System.Net.Http.HttpConnectionPool.SendWithVersionDetectionAndRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
[xUnit.net 00:02:26.80]            at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
[xUnit.net 00:02:26.80]            at System.Net.Http.HttpClient.<SendAsync>g__Core|83_0(HttpRequestMessage request, HttpCompletionOption completionOption, CancellationTokenSource cts, Boolean disposeCts, CancellationTokenSource pendingRequestsCts, CancellationToken originalCancellationToken)
[xUnit.net 00:02:26.80]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DockerConnectivityTests.cs(91,0): at LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.Azurite_Container_IsAccessible()
[xUnit.net 00:02:26.80]         --- End of stack trace from previous location ---
[xUnit.net 00:02:26.80]         ----- Inner Stack Trace -----
[xUnit.net 00:02:26.80]            at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
[xUnit.net 00:02:26.80]            at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
[xUnit.net 00:02:26.80]            at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)
  Failed LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.Azurite_Container_IsAccessible [4 s]
  Error Message:
   System.Net.Http.HttpRequestException : No connection could be made because the target machine actively refused it. (localhost:10000)
---- System.Net.Sockets.SocketException : No connection could be made because the target machine actively refused it.
  Stack Trace:
     at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.AddHttp11ConnectionAsync(QueueItem queueItem)
   at System.Threading.Tasks.TaskCompletionSourceWithCancellation`1.WaitWithCancellationAsync(CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithVersionDetectionAndRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.<SendAsync>g__Core|83_0(HttpRequestMessage request, HttpCompletionOption completionOption, CancellationTokenSource cts, Boolean disposeCts, CancellationTokenSource pendingRequestsCts, CancellationToken originalCancellationToken)
   at LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.Azurite_Container_IsAccessible() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DockerConnectivityTests.cs:line 91
--- End of stack trace from previous location ---
----- Inner Stack Trace -----
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)
[xUnit.net 00:02:27.04]     LankaConnect.IntegrationTests.Email.EmailIntegrationTests.EmailMetrics_ShouldTrackEmailStatistics [FAIL]
[xUnit.net 00:02:27.04]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:27.04]       Stack Trace:
[xUnit.net 00:02:27.04]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:27.04]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:27.04]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:27.04]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:27.04]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Email.EmailIntegrationTests.EmailMetrics_ShouldTrackEmailStatistics [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:38:49.612 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:02:29.38]     LankaConnect.IntegrationTests.Controllers.EntraAuthControllerTests.LoginWithEntra_WithInvalidToken_ShouldReturn401Unauthorized [FAIL]
[xUnit.net 00:02:29.38]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:29.38]       Stack Trace:
[xUnit.net 00:02:29.38]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:29.38]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:29.38]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:29.38]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:29.38]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.EntraAuthControllerTests.LoginWithEntra_WithInvalidToken_ShouldReturn401Unauthorized [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:02:30.65]     LankaConnect.IntegrationTests.Email.MailHogIntegrationTests.SendHtmlEmail_ShouldPreserveBothTextAndHtmlContent [FAIL]
[xUnit.net 00:02:30.65]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:30.65]       Stack Trace:
[xUnit.net 00:02:30.65]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:30.65]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:30.65]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:30.65]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:30.65]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:50.898 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:50.983 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:50.983 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:50.984 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:50.984 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:50.984 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:50.984 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:50.984 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:50.984 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:50.984 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:50.984 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:50.984 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:50.984 -05:00 [INF]  Program: Applying database migrations...
[xUnit.net 00:02:30.86]     LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.PgAdmin_Container_IsAccessible [FAIL]
[xUnit.net 00:02:30.86]       System.Net.Http.HttpRequestException : No connection could be made because the target machine actively refused it. (localhost:8081)
[xUnit.net 00:02:30.86]       ---- System.Net.Sockets.SocketException : No connection could be made because the target machine actively refused it.
[xUnit.net 00:02:30.86]       Stack Trace:
[xUnit.net 00:02:30.86]            at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)
[xUnit.net 00:02:30.86]            at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
[xUnit.net 00:02:30.86]            at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
[xUnit.net 00:02:30.86]            at System.Net.Http.HttpConnectionPool.AddHttp11ConnectionAsync(QueueItem queueItem)
[xUnit.net 00:02:30.86]            at System.Threading.Tasks.TaskCompletionSourceWithCancellation`1.WaitWithCancellationAsync(CancellationToken cancellationToken)
[xUnit.net 00:02:30.86]            at System.Net.Http.HttpConnectionPool.SendWithVersionDetectionAndRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
[xUnit.net 00:02:30.86]            at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
[xUnit.net 00:02:30.86]            at System.Net.Http.HttpClient.<SendAsync>g__Core|83_0(HttpRequestMessage request, HttpCompletionOption completionOption, CancellationTokenSource cts, Boolean disposeCts, CancellationTokenSource pendingRequestsCts, CancellationToken originalCancellationToken)
[xUnit.net 00:02:30.86]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DockerConnectivityTests.cs(118,0): at LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.PgAdmin_Container_IsAccessible()
[xUnit.net 00:02:30.86]         --- End of stack trace from previous location ---
[xUnit.net 00:02:30.86]         ----- Inner Stack Trace -----
[xUnit.net 00:02:30.86]            at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
[xUnit.net 00:02:30.86]            at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
[xUnit.net 00:02:30.86]            at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)
  Failed LankaConnect.IntegrationTests.Email.MailHogIntegrationTests.SendHtmlEmail_ShouldPreserveBothTextAndHtmlContent [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
  Failed LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.PgAdmin_Container_IsAccessible [4 s]
  Error Message:
   System.Net.Http.HttpRequestException : No connection could be made because the target machine actively refused it. (localhost:8081)
---- System.Net.Sockets.SocketException : No connection could be made because the target machine actively refused it.
  Stack Trace:
     at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.AddHttp11ConnectionAsync(QueueItem queueItem)
   at System.Threading.Tasks.TaskCompletionSourceWithCancellation`1.WaitWithCancellationAsync(CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithVersionDetectionAndRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.<SendAsync>g__Core|83_0(HttpRequestMessage request, HttpCompletionOption completionOption, CancellationTokenSource cts, Boolean disposeCts, CancellationTokenSource pendingRequestsCts, CancellationToken originalCancellationToken)
   at LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.PgAdmin_Container_IsAccessible() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DockerConnectivityTests.cs:line 118
--- End of stack trace from previous location ---
----- Inner Stack Trace -----
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)
[xUnit.net 00:02:33.35]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.ResetPassword_WithInvalidToken_ShouldReturn400BadRequest [FAIL]
[xUnit.net 00:02:33.35]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:33.35]       Stack Trace:
[xUnit.net 00:02:33.35]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:33.35]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:33.35]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:33.35]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:33.35]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.ResetPassword_WithInvalidToken_ShouldReturn400BadRequest [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:38:53.604 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:53.745 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:53.745 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:53.745 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:53.783 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:53.783 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:53.783 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:53.783 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:53.783 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:53.784 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:53.784 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:53.784 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:53.785 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:38:55.062 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:38:55.074 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:02:34.95]     LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.Seq_Container_IsAccessible [FAIL]
[xUnit.net 00:02:34.95]       System.Net.Http.HttpRequestException : No connection could be made because the target machine actively refused it. (localhost:8080)
[xUnit.net 00:02:34.95]       ---- System.Net.Sockets.SocketException : No connection could be made because the target machine actively refused it.
[xUnit.net 00:02:34.95]       Stack Trace:
[xUnit.net 00:02:34.95]            at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)
[xUnit.net 00:02:34.95]            at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
[xUnit.net 00:02:34.95]            at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
[xUnit.net 00:02:34.95]            at System.Net.Http.HttpConnectionPool.AddHttp11ConnectionAsync(QueueItem queueItem)
[xUnit.net 00:02:34.95]            at System.Threading.Tasks.TaskCompletionSourceWithCancellation`1.WaitWithCancellationAsync(CancellationToken cancellationToken)
[xUnit.net 00:02:34.95]            at System.Net.Http.HttpConnectionPool.SendWithVersionDetectionAndRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
[xUnit.net 00:02:34.95]            at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
[xUnit.net 00:02:34.95]            at System.Net.Http.HttpClient.<SendAsync>g__Core|83_0(HttpRequestMessage request, HttpCompletionOption completionOption, CancellationTokenSource cts, Boolean disposeCts, CancellationTokenSource pendingRequestsCts, CancellationToken originalCancellationToken)
[xUnit.net 00:02:34.95]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DockerConnectivityTests.cs(107,0): at LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.Seq_Container_IsAccessible()
[xUnit.net 00:02:34.95]         --- End of stack trace from previous location ---
[xUnit.net 00:02:34.95]         ----- Inner Stack Trace -----
[xUnit.net 00:02:34.95]            at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
[xUnit.net 00:02:34.95]            at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
[xUnit.net 00:02:34.95]            at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)
  Failed LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.Seq_Container_IsAccessible [4 s]
  Error Message:
   System.Net.Http.HttpRequestException : No connection could be made because the target machine actively refused it. (localhost:8080)
---- System.Net.Sockets.SocketException : No connection could be made because the target machine actively refused it.
  Stack Trace:
     at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.AddHttp11ConnectionAsync(QueueItem queueItem)
   at System.Threading.Tasks.TaskCompletionSourceWithCancellation`1.WaitWithCancellationAsync(CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithVersionDetectionAndRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.<SendAsync>g__Core|83_0(HttpRequestMessage request, HttpCompletionOption completionOption, CancellationTokenSource cts, Boolean disposeCts, CancellationTokenSource pendingRequestsCts, CancellationToken originalCancellationToken)
   at LankaConnect.IntegrationTests.Infrastructure.DockerConnectivityTests.Seq_Container_IsAccessible() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Infrastructure\DockerConnectivityTests.cs:line 107
--- End of stack trace from previous location ---
----- Inner Stack Trace -----
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)
2026-01-24 08:38:57.852 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:02:37.63]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Login_WithValidCredentials_ShouldReturn200OK [FAIL]
[xUnit.net 00:02:37.63]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:37.63]       Stack Trace:
[xUnit.net 00:02:37.63]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:37.63]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:37.63]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:37.63]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:37.63]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:38:57.881 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:38:57.980 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:38:57.980 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:38:57.980 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:38:57.980 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:38:57.980 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:38:57.980 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:38:57.980 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:38:57.980 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:38:57.980 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:38:57.980 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:38:57.981 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:38:57.981 -05:00 [INF]  Program: Applying database migrations...
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Login_WithValidCredentials_ShouldReturn200OK [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:02:41.55]     LankaConnect.IntegrationTests.Email.MailHogIntegrationTests.MailHog_ShouldBeRunningAndAccessible [FAIL]
[xUnit.net 00:02:41.55]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:41.55]       Stack Trace:
[xUnit.net 00:02:41.55]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:41.55]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:41.55]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:41.55]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:41.55]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Email.MailHogIntegrationTests.MailHog_ShouldBeRunningAndAccessible [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:39:01.804 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:39:01.960 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:39:01.960 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:39:01.960 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:39:01.996 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:39:01.997 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:39:01.997 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:39:01.997 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:39:01.997 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:39:01.997 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:39:01.997 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:39:01.997 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:39:01.998 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:39:02.054 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:39:02.073 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:39:06.069 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:02:45.84]     LankaConnect.IntegrationTests.Email.MailHogIntegrationTests.SendEmail_ShouldAppearInMailHog [FAIL]
[xUnit.net 00:02:45.84]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:45.84]       Stack Trace:
[xUnit.net 00:02:45.84]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:45.84]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:45.84]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:45.84]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:45.84]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Email.MailHogIntegrationTests.SendEmail_ShouldAppearInMailHog [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:39:06.107 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:39:06.230 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:39:06.230 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:39:06.230 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:39:06.230 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:39:06.230 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:39:06.230 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:39:06.231 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:39:06.231 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:39:06.231 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:39:06.231 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:39:06.232 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:39:06.232 -05:00 [INF]  Program: Applying database migrations...
[xUnit.net 00:02:49.76]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.ForgotPassword_WithValidEmail_ShouldReturn200OK [FAIL]
[xUnit.net 00:02:49.76]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:49.76]       Stack Trace:
[xUnit.net 00:02:49.76]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:49.77]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:49.77]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:49.77]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:49.77]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.ForgotPassword_WithValidEmail_ShouldReturn200OK [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:39:10.018 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:39:10.113 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:39:10.113 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:39:10.113 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:39:10.114 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:39:10.114 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:39:10.114 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:39:10.114 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:39:10.114 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:39:10.114 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:39:10.114 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:39:10.114 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:39:10.114 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:39:10.296 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:39:10.309 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:39:14.184 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:02:53.96]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.VerifyEmail_WithAlreadyVerifiedEmail_ShouldReturn200OK [FAIL]
[xUnit.net 00:02:53.96]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:53.96]       Stack Trace:
[xUnit.net 00:02:53.96]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:53.96]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:53.96]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:53.96]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:53.96]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.VerifyEmail_WithAlreadyVerifiedEmail_ShouldReturn200OK [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:39:14.232 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:39:14.394 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:39:14.394 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:39:14.395 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:39:14.395 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:39:14.395 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:39:14.395 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:39:14.395 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:39:14.395 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:39:14.395 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:39:14.395 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:39:14.396 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:39:14.397 -05:00 [INF]  Program: Applying database migrations...
[xUnit.net 00:02:57.93]     LankaConnect.IntegrationTests.Email.MailHogIntegrationTests.SendEmailWithAttachment_ShouldIncludeAttachment [FAIL]
[xUnit.net 00:02:57.93]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:02:57.93]       Stack Trace:
[xUnit.net 00:02:57.93]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:02:57.93]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:02:57.93]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:02:57.93]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:02:57.93]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
2026-01-24 08:39:18.448 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:39:18.470 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
  Failed LankaConnect.IntegrationTests.Email.MailHogIntegrationTests.SendEmailWithAttachment_ShouldIncludeAttachment [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
[xUnit.net 00:03:02.32]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Health_ShouldReturn200OK [FAIL]
[xUnit.net 00:03:02.32]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:03:02.32]       Stack Trace:
[xUnit.net 00:03:02.32]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:03:02.32]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:03:02.32]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:03:02.32]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:03:02.32]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Health_ShouldReturn200OK [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:39:22.569 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:39:22.685 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:39:22.685 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:39:22.685 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:39:22.685 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:39:22.685 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:39:22.685 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:39:22.685 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:39:22.685 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:39:22.686 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:39:22.686 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:39:22.686 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:39:22.686 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:39:26.760 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:39:26.777 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:03:10.65]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.ForgotPassword_WithInvalidEmail_ShouldReturn400BadRequest [FAIL]
[xUnit.net 00:03:10.65]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:03:10.65]       Stack Trace:
[xUnit.net 00:03:10.65]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:03:10.65]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:03:10.65]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:03:10.65]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:03:10.65]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.ForgotPassword_WithInvalidEmail_ShouldReturn400BadRequest [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:39:30.905 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:39:31.036 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:39:31.037 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:39:31.037 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:39:31.037 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:39:31.037 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:39:31.037 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:39:31.038 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:39:31.038 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:39:31.038 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:39:31.038 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:39:31.039 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:39:31.039 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:39:35.107 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:39:35.129 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:03:18.99]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.ResetPassword_WithValidTokenAndPassword_ShouldReturn200OK [FAIL]
[xUnit.net 00:03:19.00]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:03:19.00]       Stack Trace:
[xUnit.net 00:03:19.00]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:03:19.00]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:03:19.00]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:03:19.00]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:03:19.00]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.ResetPassword_WithValidTokenAndPassword_ShouldReturn200OK [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:39:39.254 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:39:39.373 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:39:39.373 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:39:39.373 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:39:39.374 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:39:39.374 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:39:39.374 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:39:39.374 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:39:39.374 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:39:39.374 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:39:39.374 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:39:39.374 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:39:39.375 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:39:43.443 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:39:43.454 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:03:27.34]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.VerifyEmail_WithInvalidToken_ShouldReturn400BadRequest [FAIL]
[xUnit.net 00:03:27.34]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:03:27.34]       Stack Trace:
[xUnit.net 00:03:27.34]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:03:27.34]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:03:27.34]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:03:27.34]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:03:27.34]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.VerifyEmail_WithInvalidToken_ShouldReturn400BadRequest [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:39:47.587 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:39:47.741 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:39:47.742 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:39:47.742 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:39:47.742 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:39:47.742 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:39:47.742 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:39:47.742 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:39:47.742 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:39:47.742 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:39:47.742 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:39:47.743 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:39:47.743 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:39:51.816 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:39:51.831 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:03:35.71]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.RefreshToken_WithoutCookie_ShouldReturn400BadRequest [FAIL]
[xUnit.net 00:03:35.71]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:03:35.71]       Stack Trace:
[xUnit.net 00:03:35.71]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:03:35.71]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:03:35.71]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:03:35.71]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:03:35.71]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.RefreshToken_WithoutCookie_ShouldReturn400BadRequest [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:39:55.966 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:39:56.053 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:39:56.053 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:39:56.053 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:39:56.053 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:39:56.053 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:39:56.053 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:39:56.053 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:39:56.053 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:39:56.053 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:39:56.053 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:39:56.054 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:39:56.054 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:40:00.125 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:40:00.134 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:03:43.99]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.GetProfile_WithoutAuthentication_ShouldReturn401Unauthorized [FAIL]
[xUnit.net 00:03:43.99]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:03:43.99]       Stack Trace:
[xUnit.net 00:03:43.99]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:03:43.99]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:03:43.99]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:03:43.99]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:03:43.99]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.GetProfile_WithoutAuthentication_ShouldReturn401Unauthorized [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:40:04.287 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:40:04.440 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:40:04.440 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:40:04.440 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:40:04.440 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:40:04.440 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:40:04.440 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:40:04.440 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:40:04.440 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:40:04.441 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:40:04.441 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:40:04.441 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:40:04.441 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:40:08.496 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:40:08.508 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:03:52.36]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Login_WithUnverifiedEmail_ShouldReturn401Unauthorized [FAIL]
[xUnit.net 00:03:52.36]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:03:52.36]       Stack Trace:
[xUnit.net 00:03:52.36]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:03:52.36]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:03:52.36]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:03:52.36]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:03:52.36]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Login_WithUnverifiedEmail_ShouldReturn401Unauthorized [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:40:12.612 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:40:12.721 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:40:12.721 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:40:12.721 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:40:12.721 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:40:12.721 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:40:12.721 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:40:12.721 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:40:12.721 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:40:12.721 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:40:12.721 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:40:12.722 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:40:12.722 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:40:16.805 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:40:16.815 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:04:00.69]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Register_WithInvalidEmail_ShouldReturn400BadRequest [FAIL]
[xUnit.net 00:04:00.69]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:04:00.69]       Stack Trace:
[xUnit.net 00:04:00.69]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:04:00.69]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:04:00.69]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:04:00.69]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:04:00.69]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Register_WithInvalidEmail_ShouldReturn400BadRequest [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:40:20.939 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:40:21.070 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:40:21.070 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:40:21.071 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:40:21.071 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:40:21.071 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:40:21.071 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:40:21.071 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:40:21.071 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:40:21.071 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:40:21.071 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:40:21.072 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:40:21.072 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:40:25.125 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:40:25.138 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:04:08.99]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.ResetPassword_WithExpiredToken_ShouldReturn400BadRequest [FAIL]
[xUnit.net 00:04:08.99]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:04:08.99]       Stack Trace:
[xUnit.net 00:04:08.99]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:04:08.99]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:04:08.99]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:04:08.99]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:04:08.99]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.ResetPassword_WithExpiredToken_ShouldReturn400BadRequest [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:40:29.236 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:40:29.323 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:40:29.323 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:40:29.323 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:40:29.323 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:40:29.324 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:40:29.324 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:40:29.324 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:40:29.324 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:40:29.324 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:40:29.324 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:40:29.324 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:40:29.324 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:40:33.410 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:40:33.420 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:04:17.30]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Register_WithDuplicateEmail_ShouldReturn400BadRequest [FAIL]
[xUnit.net 00:04:17.30]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:04:17.30]       Stack Trace:
[xUnit.net 00:04:17.30]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:04:17.30]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:04:17.30]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:04:17.30]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:04:17.30]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Register_WithDuplicateEmail_ShouldReturn400BadRequest [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:40:37.547 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:40:37.660 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:40:37.660 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:40:37.661 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:40:37.661 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:40:37.661 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:40:37.661 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:40:37.661 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:40:37.661 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:40:37.661 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:40:37.661 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:40:37.662 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:40:37.662 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:40:41.751 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:40:41.762 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:04:25.63]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Register_WithWeakPassword_ShouldReturn400BadRequest [FAIL]
[xUnit.net 00:04:25.63]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:04:25.63]       Stack Trace:
[xUnit.net 00:04:25.63]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:04:25.63]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:04:25.63]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:04:25.63]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:04:25.64]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Register_WithWeakPassword_ShouldReturn400BadRequest [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:40:45.883 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:40:45.977 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:40:45.977 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:40:45.977 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:40:45.977 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:40:45.977 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:40:45.977 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:40:45.977 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:40:45.977 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:40:45.978 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:40:45.978 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:40:45.978 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:40:45.978 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:40:50.053 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:40:50.072 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:04:33.92]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Logout_WithValidToken_ShouldReturn200OK [FAIL]
[xUnit.net 00:04:33.92]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:04:33.92]       Stack Trace:
[xUnit.net 00:04:33.92]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:04:33.92]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:04:33.92]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:04:33.92]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:04:33.92]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Logout_WithValidToken_ShouldReturn200OK [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:40:54.173 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:40:54.285 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:40:54.286 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:40:54.286 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:40:54.286 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:40:54.286 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:40:54.286 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:40:54.286 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:40:54.286 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:40:54.286 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:40:54.286 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:40:54.287 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:40:54.287 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:40:58.376 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:40:58.392 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:04:42.26]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.ForgotPassword_WithNonExistentUser_ShouldReturn200OK [FAIL]
[xUnit.net 00:04:42.26]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:04:42.26]       Stack Trace:
[xUnit.net 00:04:42.26]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:04:42.26]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:04:42.26]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:04:42.26]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:04:42.26]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.ForgotPassword_WithNonExistentUser_ShouldReturn200OK [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:41:02.513 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:41:02.589 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:41:02.590 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:41:02.590 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:41:02.590 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:41:02.590 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:41:02.590 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:41:02.590 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:41:02.590 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:41:02.590 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:41:02.590 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:41:02.590 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:41:02.590 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:41:06.677 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:41:06.710 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:04:50.57]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Login_WithInvalidCredentials_ShouldReturn400BadRequest [FAIL]
[xUnit.net 00:04:50.57]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:04:50.57]       Stack Trace:
[xUnit.net 00:04:50.57]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:04:50.57]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:04:50.57]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:04:50.57]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:04:50.57]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.Login_WithInvalidCredentials_ShouldReturn400BadRequest [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:41:10.817 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:41:10.905 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:41:10.906 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:41:10.906 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:41:10.906 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:41:10.906 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:41:10.906 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:41:10.906 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:41:10.906 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:41:10.906 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:41:10.906 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:41:10.906 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:41:10.906 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:41:14.990 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:41:15.002 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:04:58.83]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.VerifyEmail_WithValidToken_ShouldReturn200OK [FAIL]
[xUnit.net 00:04:58.83]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:04:58.83]       Stack Trace:
[xUnit.net 00:04:58.83]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:04:58.83]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:04:58.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:04:58.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:04:58.83]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.VerifyEmail_WithValidToken_ShouldReturn200OK [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:41:19.093 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:41:19.179 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:41:19.179 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:41:19.179 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:41:19.179 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:41:19.179 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:41:19.179 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:41:19.180 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:41:19.180 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:41:19.180 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:41:19.180 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:41:19.180 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:41:19.180 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:41:23.263 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:41:23.272 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:05:07.16]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.GetProfile_WithValidToken_ShouldReturn200OK [FAIL]
[xUnit.net 00:05:07.16]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:05:07.16]       Stack Trace:
[xUnit.net 00:05:07.16]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:05:07.16]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:05:07.16]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:05:07.16]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:05:07.16]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.GetProfile_WithValidToken_ShouldReturn200OK [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86
2026-01-24 08:41:27.411 -05:00 [INF]  : Starting LankaConnect API
2026-01-24 08:41:27.529 -05:00 [INF]  Program: Phase 6A.X: Validating configuration settings at startup
2026-01-24 08:41:27.529 -05:00 [INF]  Program: Configuration validation: Setting ConnectionStrings:DefaultConnection is present
2026-01-24 08:41:27.529 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Key is present
2026-01-24 08:41:27.529 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Issuer is present
2026-01-24 08:41:27.529 -05:00 [INF]  Program: Configuration validation: Setting Jwt:Audience is present
2026-01-24 08:41:27.529 -05:00 [WRN]  Program: Configuration validation: Missing optional setting AzureStorage:ConnectionString - feature may be disabled
2026-01-24 08:41:27.529 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:SecretKey - feature may be disabled
2026-01-24 08:41:27.530 -05:00 [WRN]  Program: Configuration validation: Missing optional setting Stripe:PublishableKey - feature may be disabled
2026-01-24 08:41:27.530 -05:00 [INF]  Program: Configuration validation: Setting EmailSettings:AzureConnectionString is present
2026-01-24 08:41:27.530 -05:00 [WRN]  Program: Configuration validation completed with 3 warnings:
Missing optional configuration: AzureStorage:ConnectionString (feature may be disabled)
Missing optional configuration: Stripe:SecretKey (feature may be disabled)
Missing optional configuration: Stripe:PublishableKey (feature may be disabled)
2026-01-24 08:41:27.530 -05:00 [INF]  LankaConnect.Infrastructure.Data.AppDbContext: AppDbContext initialized with IPublisher: MediatR.Mediator
2026-01-24 08:41:27.530 -05:00 [INF]  Program: Applying database migrations...
2026-01-24 08:41:31.593 -05:00 [ERR]  Program: An error occurred while migrating the database
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
2026-01-24 08:41:31.604 -05:00 [FTL]  : Application terminated unexpectedly
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Work\LankaConnect\src\LankaConnect.API\Program.cs:line 217
[xUnit.net 00:05:15.47]     LankaConnect.IntegrationTests.Controllers.AuthControllerTests.ResetPassword_WithWeakPassword_ShouldReturn400BadRequest [FAIL]
[xUnit.net 00:05:15.47]       System.InvalidOperationException : The server has not been started or no web application was configured.
[xUnit.net 00:05:15.47]       Stack Trace:
[xUnit.net 00:05:15.47]            at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
[xUnit.net 00:05:15.47]            at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
[xUnit.net 00:05:15.47]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:05:15.47]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:05:15.47]         C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs(86,0): at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync()
[xUnit.net 00:05:15.48]   Finished:    LankaConnect.IntegrationTests
  Failed LankaConnect.IntegrationTests.Controllers.AuthControllerTests.ResetPassword_WithWeakPassword_ShouldReturn400BadRequest [1 ms]
  Error Message:
   System.InvalidOperationException : The server has not been started or no web application was configured.
  Stack Trace:
     at Microsoft.AspNetCore.TestHost.TestServer.get_Application()
   at Microsoft.AspNetCore.TestHost.TestServer.CreateHandler()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at LankaConnect.IntegrationTests.Common.DockerComposeWebApiTestBase.InitializeAsync() in C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\Common\DockerComposeWebApiTestBase.cs:line 86

Test Run Failed.
Total tests: 209
     Passed: 18
     Failed: 182
    Skipped: 9
 Total time: 5.2797 Minutes
     1>Project "C:\Work\LankaConnect\LankaConnect.sln" (1) is building "C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\LankaConnect.IntegrationTests.csproj" (4) on node 6 (VSTest target(s)).
     4>_VSTestConsole:
         MSB4181: The "VSTestTask" task returned false but did not log an error.
     4>Done Building Project "C:\Work\LankaConnect\tests\LankaConnect.IntegrationTests\LankaConnect.IntegrationTests.csproj" (VSTest target(s)) -- FAILED.
     1>Done Building Project "C:\Work\LankaConnect\LankaConnect.sln" (VSTest target(s)) -- FAILED.

Build FAILED.
    0 Warning(s)
    0 Error(s)

Time Elapsed 00:05:19.42
