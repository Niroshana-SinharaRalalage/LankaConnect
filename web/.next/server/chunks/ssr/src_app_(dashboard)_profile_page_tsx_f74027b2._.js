module.exports=[43827,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(72493),e=a.i(72988),f=a.i(20226),g=a.i(62435),h=a.i(64668);let i=new class{basePath="/users";async getProfile(a){return await h.apiClient.get(`${this.basePath}/${a}`)}async uploadProfilePhoto(a,b){let c=new FormData;c.append("image",b);let d=`https://lankaconnect-api-staging.politebay-79d6e8a2.eastus2.azurecontainerapps.io/api${this.basePath}/${a}/profile-photo`,e=h.apiClient.authToken,f=await fetch(d,{method:"POST",body:c,credentials:"include",headers:{...e?{Authorization:`Bearer ${e}`}:{}}});if(!f.ok){let a=await f.text(),b=`Upload failed with status ${f.status}`;try{let c=JSON.parse(a);b=c.message||c.error||b}catch{}throw Error(b)}return await f.json()}async deleteProfilePhoto(a){return await h.apiClient.delete(`${this.basePath}/${a}/profile-photo`)}async updateLocation(a,b){return await h.apiClient.put(`${this.basePath}/${a}/location`,b)}async updateCulturalInterests(a,b){return await h.apiClient.put(`${this.basePath}/${a}/cultural-interests`,b),await this.getProfile(a)}async updateLanguages(a,b){return await h.apiClient.put(`${this.basePath}/${a}/languages`,b)}async updateBasicInfo(a,b){return await h.apiClient.put(`${this.basePath}/${a}`,b)}async updatePreferredMetroAreas(a,b){return await h.apiClient.put(`${this.basePath}/${a}/preferred-metro-areas`,b),await this.getProfile(a)}async getPreferredMetroAreas(a){return await h.apiClient.get(`${this.basePath}/${a}/preferred-metro-areas`)}},j={photo:"idle",basicInfo:"idle",location:"idle",culturalInterests:"idle",languages:"idle",preferredMetroAreas:"idle"},k=(0,f.create)()((0,g.devtools)((a,b)=>({profile:null,originalProfile:null,isLoading:!1,error:null,sectionStates:{...j},setProfile:b=>{a({profile:b,originalProfile:JSON.parse(JSON.stringify(b)),error:null})},loadProfile:async c=>{a({isLoading:!0,error:null});try{let a=await i.getProfile(c);b().setProfile(a)}catch(b){a({error:b instanceof Error?b.message:"Failed to load profile",profile:null,originalProfile:null})}finally{a({isLoading:!1})}},clearProfile:()=>{a({profile:null,originalProfile:null,isLoading:!1,error:null,sectionStates:{...j}})},uploadPhoto:async(b,c)=>{a(a=>({sectionStates:{...a.sectionStates,photo:"saving"},error:null}));try{let d=await i.uploadProfilePhoto(b,c);a(a=>({profile:a.profile?{...a.profile,profilePhotoUrl:d.profilePhotoUrl}:null,originalProfile:a.originalProfile?{...a.originalProfile,profilePhotoUrl:d.profilePhotoUrl}:null,sectionStates:{...a.sectionStates,photo:"success"}})),setTimeout(()=>{a(a=>({sectionStates:{...a.sectionStates,photo:"idle"}}))},2e3)}catch(c){let b=c instanceof Error?c.message:"Failed to upload photo";a(a=>({error:b,sectionStates:{...a.sectionStates,photo:"error"}}))}},deletePhoto:async b=>{a(a=>({sectionStates:{...a.sectionStates,photo:"saving"},error:null}));try{await i.deleteProfilePhoto(b),a(a=>({profile:a.profile?{...a.profile,profilePhotoUrl:null}:null,originalProfile:a.originalProfile?{...a.originalProfile,profilePhotoUrl:null}:null,sectionStates:{...a.sectionStates,photo:"success"}})),setTimeout(()=>{a(a=>({sectionStates:{...a.sectionStates,photo:"idle"}}))},2e3)}catch(c){let b=c instanceof Error?c.message:"Failed to delete photo";a(a=>({error:b,sectionStates:{...a.sectionStates,photo:"error"}}))}},updateBasicInfo:async(c,d)=>{a(a=>({sectionStates:{...a.sectionStates,basicInfo:"saving"},error:null}));try{let e=await i.updateBasicInfo(c,d);b().setProfile(e),a(a=>({sectionStates:{...a.sectionStates,basicInfo:"success"}})),setTimeout(()=>{a(a=>({sectionStates:{...a.sectionStates,basicInfo:"idle"}}))},2e3)}catch(c){let b=c instanceof Error?c.message:"Failed to update basic info";a(a=>({error:b,sectionStates:{...a.sectionStates,basicInfo:"error"}}))}},updateLocation:async(c,d)=>{a(a=>({sectionStates:{...a.sectionStates,location:"saving"},error:null}));try{let e=await i.updateLocation(c,d);b().setProfile(e),a(a=>({sectionStates:{...a.sectionStates,location:"success"}})),setTimeout(()=>{a(a=>({sectionStates:{...a.sectionStates,location:"idle"}}))},2e3)}catch(c){let b=c instanceof Error?c.message:"Failed to update location";a(a=>({error:b,sectionStates:{...a.sectionStates,location:"error"}}))}},updateCulturalInterests:async(c,d)=>{a(a=>({sectionStates:{...a.sectionStates,culturalInterests:"saving"},error:null}));try{let e=await i.updateCulturalInterests(c,d);b().setProfile(e),a(a=>({sectionStates:{...a.sectionStates,culturalInterests:"success"}})),setTimeout(()=>{a(a=>({sectionStates:{...a.sectionStates,culturalInterests:"idle"}}))},2e3)}catch(c){let b=c instanceof Error?c.message:"Failed to update cultural interests";a(a=>({error:b,sectionStates:{...a.sectionStates,culturalInterests:"error"}}))}},updateLanguages:async(c,d)=>{a(a=>({sectionStates:{...a.sectionStates,languages:"saving"},error:null}));try{let e=await i.updateLanguages(c,d);b().setProfile(e),a(a=>({sectionStates:{...a.sectionStates,languages:"success"}})),setTimeout(()=>{a(a=>({sectionStates:{...a.sectionStates,languages:"idle"}}))},2e3)}catch(c){let b=c instanceof Error?c.message:"Failed to update languages";a(a=>({error:b,sectionStates:{...a.sectionStates,languages:"error"}}))}},updatePreferredMetroAreas:async(c,d)=>{if(d.MetroAreaIds.length>20)return void a(a=>({error:"Cannot select more than 20 metro areas",sectionStates:{...a.sectionStates,preferredMetroAreas:"error"}}));a(a=>({sectionStates:{...a.sectionStates,preferredMetroAreas:"saving"},error:null}));try{let e=await i.updatePreferredMetroAreas(c,d);b().setProfile(e),a(a=>({sectionStates:{...a.sectionStates,preferredMetroAreas:"success"}})),setTimeout(()=>{a(a=>({sectionStates:{...a.sectionStates,preferredMetroAreas:"idle"}}))},2e3)}catch(c){let b=c instanceof Error?c.message:"Failed to update preferred metro areas";a(a=>({error:b,sectionStates:{...a.sectionStates,preferredMetroAreas:"error"}}))}},markSectionDirty:b=>{a(a=>({sectionStates:{...a.sectionStates,[b]:"dirty"}}))},markSectionClean:b=>{a(a=>({sectionStates:{...a.sectionStates,[b]:"idle"}}))},resetSectionState:b=>{a(a=>({sectionStates:{...a.sectionStates,[b]:"idle"}}))},isSectionDirty:a=>"dirty"===b().sectionStates[a]}),{name:"ProfileStore"}));var l=a.i(71987),m=a.i(70106);let n=(0,m.default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);var o=a.i(33508);let p=(0,m.default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var q=a.i(42043),r=a.i(18203);let s=["image/jpeg","image/jpg","image/png","image/webp"],t=5,u=({currentPhotoUrl:a,onUpload:d,onDelete:e,maxSizeMB:f=t,acceptedFormats:g=s,isLoading:h=!1,error:i})=>{let j=(0,c.useRef)(null),[k,m]=(0,c.useState)(!1),[u,v]=(0,c.useState)(""),w=()=>g.map(a=>a.replace("image/","").toUpperCase()).join(", "),x=(0,c.useCallback)(async a=>{a&&(((v(""),g.includes(a.type))?a.size/1048576>f&&(v(`File size exceeds ${f}MB`),1):(v(`Only ${w()} images are allowed`),1))||await d(a))},[d,f,g]),y=()=>{j.current?.click()},z=async()=>{h||await e()},A=i||u;return(0,b.jsxs)("div",{className:"space-y-4",children:[a&&(0,b.jsxs)("div",{className:"relative flex flex-col items-center space-y-4",children:[(0,b.jsx)("div",{className:"relative h-32 w-32 overflow-hidden rounded-full border-4 border-border",children:(0,b.jsx)(l.default,{src:a,alt:"Current profile photo",fill:!0,className:"object-cover",sizes:"128px"})}),(0,b.jsxs)(q.Button,{type:"button",variant:"destructive",size:"sm",onClick:z,disabled:h,"aria-label":"Delete photo",children:[(0,b.jsx)(o.X,{className:"mr-2 h-4 w-4"}),"Delete Photo"]})]}),!a&&(0,b.jsxs)("div",{className:(0,r.cn)("relative flex flex-col items-center justify-center rounded-lg border-2 border-dashed p-8 transition-colors",k&&"border-primary bg-primary/5",!k&&"border-border hover:border-primary/50",h&&"pointer-events-none opacity-50"),onDragOver:a=>{a.preventDefault(),a.stopPropagation(),m(!0)},onDragLeave:a=>{a.preventDefault(),a.stopPropagation(),m(!1)},onDrop:a=>{a.preventDefault(),a.stopPropagation(),m(!1);let b=a.dataTransfer.files?.[0];b&&x(b)},onClick:y,role:"button",tabIndex:0,onKeyDown:a=>{("Enter"===a.key||" "===a.key)&&y()},children:[(0,b.jsx)("input",{ref:j,type:"file",accept:g.join(","),onChange:a=>{let b=a.target.files?.[0];b&&x(b),j.current&&(j.current.value="")},className:"hidden",disabled:h,"aria-label":"Upload profile photo"}),h?(0,b.jsxs)("div",{className:"flex flex-col items-center space-y-2",role:"status","aria-live":"polite",children:[(0,b.jsx)(p,{className:"h-12 w-12 animate-spin text-primary"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Uploading..."})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n,{className:"mb-4 h-12 w-12 text-muted-foreground"}),(0,b.jsx)("p",{className:"mb-2 text-sm font-medium text-foreground",children:"Upload Photo"}),(0,b.jsx)("p",{className:"mb-1 text-xs text-muted-foreground",children:"Drag and drop or click to select"}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[w()," (Max ",f,"MB)"]})]})]}),A&&(0,b.jsx)("div",{className:"rounded-md bg-destructive/10 p-3",children:(0,b.jsx)("p",{className:"text-sm text-destructive",children:A})})]})};var v=a.i(50253);function w(){let{user:a,isAuthenticated:c}=(0,e.useAuthStore)(),{profile:d,error:f,sectionStates:g,uploadPhoto:h,deletePhoto:i}=k();if(!c||!a)return null;let j=d?.profilePhotoUrl||null,l="saving"===g.photo,m="error"===g.photo?f:null,n=async b=>{await h(a.userId,b)},o=async()=>{await i(a.userId)};return(0,b.jsx)("section",{role:"region","aria-labelledby":"profile-photo-heading",children:(0,b.jsxs)(v.Card,{children:[(0,b.jsxs)(v.CardHeader,{children:[(0,b.jsx)(v.CardTitle,{id:"profile-photo-heading",style:{color:"#8B1538"},children:"Profile Photo"}),(0,b.jsx)(v.CardDescription,{children:"Upload a photo to personalize your profile and help others recognize you"})]}),(0,b.jsx)(v.CardContent,{children:(0,b.jsx)(u,{currentPhotoUrl:j,onUpload:n,onDelete:o,isLoading:l,error:m||void 0,maxSizeMB:5,acceptedFormats:["image/jpeg","image/jpg","image/png","image/webp"]})})]})})}var x=a.i(13858);let y=[{code:"SL_CUISINE",name:"Sri Lankan Cuisine"},{code:"BUDDHIST_FEST",name:"Buddhist Festivals & Traditions"},{code:"HINDU_FEST",name:"Hindu Festivals & Traditions"},{code:"ISLAMIC_FEST",name:"Islamic Festivals & Traditions"},{code:"CHRISTIAN_FEST",name:"Christian Festivals & Traditions"},{code:"TRAD_DANCE",name:"Traditional Dance (Kandyan, Sabaragamuwa, Low Country)"},{code:"CRICKET",name:"Cricket & Sports"},{code:"AYURVEDA",name:"Ayurvedic Medicine & Wellness"},{code:"SINHALA_MUSIC",name:"Sinhala Music & Arts"},{code:"TAMIL_MUSIC",name:"Tamil Music & Arts"},{code:"VESAK",name:"Vesak & Poson Celebrations"},{code:"SINHALA_NY",name:"Sinhala & Tamil New Year (Aluth Avurudda)"},{code:"TEA_CULTURE",name:"Ceylon Tea Culture"},{code:"TRAD_ARTS",name:"Traditional Arts & Crafts (Masks, Batik, Pottery)"},{code:"SL_WEDDINGS",name:"Sri Lankan Wedding Traditions"},{code:"TEMPLE_ARCH",name:"Temple Architecture & Heritage Sites"},{code:"SL_LITERATURE",name:"Sinhala/Tamil Literature & Poetry"},{code:"TRAD_GAMES",name:"Traditional Games (Elle, Ankeliya)"},{code:"SL_FASHION",name:"Traditional Dress & Fashion (Saree, Sarong)"},{code:"DIASPORA_NET",name:"Diaspora Community & Networking"}],z=100,A=100,B=20,C=100,D=10,E={min:0,max:20};var F=a.i(33441),G=a.i(24987);function H(){let{user:a,isAuthenticated:d}=(0,e.useAuthStore)(),{profile:f,error:g,sectionStates:h,updateLocation:i}=k(),[j,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)({city:"",state:"",zipCode:"",country:""}),[o,p]=(0,c.useState)({});if(!d||!a)return null;let r=f?.location,s="saving"===h.location,t="success"===h.location,u="error"===h.location,w=async()=>{let b;if(b={},m.city.trim()?m.city.length>z&&(b.city=`City cannot exceed ${z} characters`):b.city="City is required",m.state.trim()?m.state.length>A&&(b.state=`State cannot exceed ${A} characters`):b.state="State is required",m.zipCode.trim()?m.zipCode.length>B&&(b.zipCode=`Zip code cannot exceed ${B} characters`):b.zipCode="Zip code is required",m.country.trim()?m.country.length>C&&(b.country=`Country cannot exceed ${C} characters`):b.country="Country is required",p(b),0===Object.keys(b).length)try{await i(a.userId,{city:m.city.trim(),state:m.state.trim(),zipCode:m.zipCode.trim(),country:m.country.trim()}),l(!1)}catch(a){}},y=(a,b)=>{n(c=>({...c,[a]:b})),o[a]&&p(b=>{let c={...b};return delete c[a],c})};return(0,b.jsx)("section",{role:"region","aria-labelledby":"location-heading",children:(0,b.jsxs)(v.Card,{children:[(0,b.jsxs)(v.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(G.MapPin,{className:"h-5 w-5",style:{color:"#FF7900"}}),(0,b.jsx)(v.CardTitle,{id:"location-heading",style:{color:"#8B1538"},children:"Location"})]}),!j&&(0,b.jsx)(q.Button,{onClick:()=>{n({city:r?.city||"",state:r?.state||"",zipCode:r?.zipCode||"",country:r?.country||""}),p({}),l(!0)},variant:"outline",size:"sm",disabled:s,style:{borderColor:"#FF7900",color:"#8B1538"},children:"Edit"})]}),(0,b.jsx)(v.CardDescription,{children:"Help others in the community find you by sharing your location"})]}),(0,b.jsx)(v.CardContent,{children:j?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"city",className:"block text-sm font-medium mb-1",children:"City *"}),(0,b.jsx)(x.Input,{id:"city",type:"text",value:m.city,onChange:a=>y("city",a.target.value),placeholder:"e.g., Toronto",disabled:s,error:!!o.city,"aria-label":"City","aria-invalid":!!o.city,"aria-describedby":o.city?"city-error":void 0,maxLength:z}),o.city&&(0,b.jsx)("p",{id:"city-error",className:"text-sm text-destructive mt-1",role:"alert",children:o.city})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"state",className:"block text-sm font-medium mb-1",children:"State/Province *"}),(0,b.jsx)(x.Input,{id:"state",type:"text",value:m.state,onChange:a=>y("state",a.target.value),placeholder:"e.g., Ontario",disabled:s,error:!!o.state,"aria-label":"State/Province","aria-invalid":!!o.state,"aria-describedby":o.state?"state-error":void 0,maxLength:A}),o.state&&(0,b.jsx)("p",{id:"state-error",className:"text-sm text-destructive mt-1",role:"alert",children:o.state})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"zipCode",className:"block text-sm font-medium mb-1",children:"Zip/Postal Code *"}),(0,b.jsx)(x.Input,{id:"zipCode",type:"text",value:m.zipCode,onChange:a=>y("zipCode",a.target.value),placeholder:"e.g., M5H 2N2",disabled:s,error:!!o.zipCode,"aria-label":"Zip/Postal Code","aria-invalid":!!o.zipCode,"aria-describedby":o.zipCode?"zipCode-error":void 0,maxLength:B}),o.zipCode&&(0,b.jsx)("p",{id:"zipCode-error",className:"text-sm text-destructive mt-1",role:"alert",children:o.zipCode})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"country",className:"block text-sm font-medium mb-1",children:"Country *"}),(0,b.jsx)(x.Input,{id:"country",type:"text",value:m.country,onChange:a=>y("country",a.target.value),placeholder:"e.g., Canada",disabled:s,error:!!o.country,"aria-label":"Country","aria-invalid":!!o.country,"aria-describedby":o.country?"country-error":void 0,maxLength:C}),o.country&&(0,b.jsx)("p",{id:"country-error",className:"text-sm text-destructive mt-1",role:"alert",children:o.country})]}),u&&g&&(0,b.jsx)("p",{className:"text-sm text-destructive",role:"alert",children:g}),(0,b.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,b.jsx)(q.Button,{onClick:w,disabled:s,className:"flex-1 text-white",style:{background:"#FF7900"},children:s?"Saving...":"Save Location"}),(0,b.jsx)(q.Button,{onClick:()=>{l(!1),p({})},variant:"outline",disabled:s,className:"flex-1",style:{borderColor:"#8B1538",color:"#8B1538"},children:"Cancel"})]})]}):(0,b.jsxs)("div",{className:"space-y-2",children:[r?(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsxs)("p",{className:"font-medium text-foreground",children:[r.city,", ",r.state," ",r.zipCode]}),(0,b.jsx)("p",{className:"text-muted-foreground",children:r.country})]}):(0,b.jsx)("p",{className:"text-sm text-muted-foreground italic",children:"Not set - Click Edit to add your location"}),t&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm",style:{color:"#006400"},children:[(0,b.jsx)(F.Check,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Location saved successfully!"})]}),u&&g&&(0,b.jsx)("p",{className:"text-sm text-destructive",role:"alert",children:g})]})})]})})}let I=(0,m.default)("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]);function J(){let{user:a,isAuthenticated:d}=(0,e.useAuthStore)(),{profile:f,error:g,sectionStates:h,updateCulturalInterests:i}=k(),[j,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)("");if(!d||!a)return null;let r=f?.culturalInterests||[],s="saving"===h.culturalInterests,t="success"===h.culturalInterests,u="error"===h.culturalInterests,w=async()=>{if(m.length>D)return void p(`Maximum ${D} interests allowed`);try{await i(a.userId,{InterestCodes:m}),l(!1)}catch(a){}};return(0,b.jsx)("section",{role:"region","aria-labelledby":"cultural-interests-heading",children:(0,b.jsxs)(v.Card,{children:[(0,b.jsxs)(v.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(I,{className:"h-5 w-5",style:{color:"#FF7900"}}),(0,b.jsx)(v.CardTitle,{id:"cultural-interests-heading",style:{color:"#8B1538"},children:"Cultural Interests"})]}),!j&&(0,b.jsx)(q.Button,{onClick:()=>{n([...r]),p(""),l(!0)},variant:"outline",size:"sm",disabled:s,style:{borderColor:"#FF7900",color:"#8B1538"},children:"Edit"})]}),(0,b.jsxs)(v.CardDescription,{children:["Share your cultural interests to connect with others (select 0-",D,")"]})]}),(0,b.jsx)(v.CardContent,{children:j?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:y.map(a=>{let c=m.includes(a.code);return(0,b.jsxs)("label",{className:`flex items-start gap-3 p-3 rounded-lg border cursor-pointer transition-colors ${s?"opacity-50 cursor-not-allowed":""}`,style:{background:c?"#FFE8CC":"white",borderColor:c?"#FF7900":"#e2e8f0"},children:[(0,b.jsx)("input",{type:"checkbox",checked:c,onChange:()=>{var b;return b=a.code,void n(a=>a.includes(b)?a.filter(a=>a!==b):a.length>=D?(p(`You can select up to ${D} interests`),a):(p(""),[...a,b]))},disabled:s,className:"mt-1 h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary","aria-label":a.name}),(0,b.jsx)("span",{className:"text-sm flex-1",children:a.name})]},a.code)})}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[m.length," of ",D," selected"]}),o&&(0,b.jsx)("p",{className:"text-sm text-destructive",role:"alert",children:o}),u&&g&&(0,b.jsx)("p",{className:"text-sm text-destructive",role:"alert",children:g}),(0,b.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,b.jsx)(q.Button,{onClick:w,disabled:s,className:"flex-1 text-white",style:{background:"#FF7900"},children:s?"Saving...":"Save Interests"}),(0,b.jsx)(q.Button,{onClick:()=>{l(!1),p("")},variant:"outline",disabled:s,className:"flex-1",style:{borderColor:"#8B1538",color:"#8B1538"},children:"Cancel"})]})]}):(0,b.jsxs)("div",{className:"space-y-2",children:[r.length>0?(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:r.map(a=>{let c=y.find(b=>b.code===a);return c?(0,b.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium",style:{background:"#FFE8CC",color:"#8B1538"},children:c.name},a):null})}):(0,b.jsx)("p",{className:"text-sm text-muted-foreground italic",children:"No interests selected - Click Edit to add your cultural interests"}),t&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm",style:{color:"#006400"},children:[(0,b.jsx)(F.Check,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Cultural interests saved successfully!"})]}),u&&g&&(0,b.jsx)("p",{className:"text-sm text-destructive",role:"alert",children:g})]})})]})})}var K=a.i(2973),L=a.i(12863),M=a.i(99225),N=a.i(37927),O=a.i(74934);function P(){let{user:a}=(0,e.useAuthStore)(),{profile:d,updatePreferredMetroAreas:f,sectionStates:g,error:h,isLoading:i}=k(),j=(0,N.useQueryClient)(),{metroAreas:l,metroAreasByState:m,stateLevelMetros:n,isLoading:o,error:p}=(0,L.useMetroAreas)(),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)([]),[w,x]=(0,c.useState)(""),y=g.preferredMetroAreas,z=i||"saving"===y,A=d?.preferredMetroAreas||[],{max:B}=E,C=(0,c.useMemo)(()=>{let a=[];return M.US_STATES.forEach(b=>{let c=m.get(b.code)||[];if(0===c.length)return;let d=c.find(a=>a.isStateLevelArea),e=c.filter(a=>!a.isStateLevelArea),f=[];d&&f.push({id:d.id,label:d.name,checked:t.includes(d.id)}),e.forEach(a=>{f.push({id:a.id,label:a.name,checked:t.includes(a.id)})}),a.push({id:b.code,label:b.name,checked:!1,children:f})}),a},[m,n,t]);if(!a)return null;if(o)return(0,b.jsxs)(v.Card,{role:"region","aria-label":"Preferred Metro Areas",children:[(0,b.jsxs)(v.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(G.MapPin,{className:"h-5 w-5",style:{color:"#FF7900"}}),(0,b.jsx)(v.CardTitle,{style:{color:"#8B1538"},children:"Preferred Metro Areas"})]}),(0,b.jsx)(v.CardDescription,{children:"Loading metro areas..."})]}),(0,b.jsx)(v.CardContent,{children:(0,b.jsx)("div",{className:"flex items-center justify-center p-4",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2",style:{borderColor:"#FF7900"}})})})]});if(p)return(0,b.jsxs)(v.Card,{role:"region","aria-label":"Preferred Metro Areas",children:[(0,b.jsx)(v.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(G.MapPin,{className:"h-5 w-5",style:{color:"#FF7900"}}),(0,b.jsx)(v.CardTitle,{style:{color:"#8B1538"},children:"Preferred Metro Areas"})]})}),(0,b.jsx)(v.CardContent,{children:(0,b.jsxs)("p",{className:"text-sm text-destructive",role:"alert",children:["Failed to load metro areas: ",p]})})]});let D=async()=>{if(a?.userId){console.log("=== DEBUG: Attempting to save metro areas ==="),console.log("Selected IDs:",t),console.log("Selected Count:",t.length),t.forEach(a=>{let b=H(a);console.log(`  - ${a}: ${b?`${b.name}, ${b.state}`:"NOT FOUND IN LOCAL DATA"}`)});try{await f(a.userId,{MetroAreaIds:t}),console.log("✅ Save successful"),j.invalidateQueries({queryKey:O.eventKeys.featured(a.userId)}),console.log("✅ Featured events cache invalidated"),s(!1),x("")}catch(a){console.error("❌ Save failed:",a)}}},H=a=>l.find(b=>b.id===a);return(0,b.jsxs)(v.Card,{role:"region","aria-label":"Preferred Metro Areas",children:[(0,b.jsxs)(v.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(G.MapPin,{className:"h-5 w-5",style:{color:"#FF7900"}}),(0,b.jsx)(v.CardTitle,{style:{color:"#8B1538"},children:"Preferred Metro Areas"})]}),!r&&(0,b.jsx)(q.Button,{variant:"outline",size:"sm",onClick:()=>{s(!0),u([...A]),x("")},disabled:z,style:{borderColor:"#FF7900",color:"#8B1538"},children:"Edit"})]}),(0,b.jsxs)(v.CardDescription,{children:["Select up to ",B," metro areas for personalized event and content filtering. You can opt out by leaving this empty."]})]}),(0,b.jsx)(v.CardContent,{children:r?(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Select metro areas by expanding states and checking your preferred locations"}),(0,b.jsx)(K.TreeDropdown,{nodes:C,selectedIds:t,onSelectionChange:a=>{a.length>B?x(`You cannot select more than ${B} metro areas`):(x(""),u(a))},placeholder:`Select up to ${B} metro areas`,maxSelections:B,disabled:z,className:"w-full"}),(0,b.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t",style:{borderColor:"#e2e8f0"},children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[t.length," of ",B," selected"]}),w&&(0,b.jsx)("p",{className:"text-sm text-destructive",role:"alert",children:w})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,b.jsx)(q.Button,{onClick:D,disabled:z||!!w,className:"flex-1 text-white",style:{background:"#FF7900"},children:z?"Saving...":"Save Changes"}),(0,b.jsx)(q.Button,{onClick:()=>{s(!1),u([]),x("")},variant:"outline",disabled:z,className:"flex-1",style:{borderColor:"#8B1538",color:"#8B1538"},children:"Cancel"})]})]}):(0,b.jsxs)("div",{className:"space-y-2",children:[A.length>0?(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:A.map(a=>{let c,d=H(a);return d?(0,b.jsxs)("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium",style:{background:"#FFE8CC",color:"#8B1538"},children:[d.name,(c=H(a),!c?.isStateLevelArea&&`, ${d.state}`)]},a):null})}):(0,b.jsx)("p",{className:"text-sm text-muted-foreground italic",children:"No metro areas selected - Click Edit to add your preferred locations"}),"success"===y&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm",style:{color:"#006400"},children:[(0,b.jsx)(F.Check,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Preferred metro areas saved successfully!"})]}),"error"===y&&h&&(0,b.jsx)("p",{className:"text-sm text-destructive",role:"alert",children:h})]})})]})}var Q=a.i(33483),R=a.i(50944),S=a.i(43061),T=a.i(210),U=a.i(93003);function V(){let a=(0,R.useRouter)(),{user:f,clearAuth:g,isAuthenticated:h,isLoading:i}=(0,e.useAuthStore)(),{loadProfile:j,profile:l,isLoading:m}=k();(0,c.useEffect)(()=>{h&&f?.userId&&!l&&!m&&j(f.userId)},[h,f?.userId,l,m,j]);let n=async()=>{try{await S.authRepository.logout()}catch(a){}finally{g(),a.push("/login")}};return(0,b.jsx)(d.ProtectedRoute,{children:(0,b.jsxs)("div",{className:"min-h-screen",style:{background:"#f7fafc"},children:[(0,b.jsx)("header",{className:"bg-white border-b sticky top-0 z-40",style:{background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",boxShadow:"0 2px 20px rgba(0,0,0,0.1)"},children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(Q.OfficialLogo,{size:"md"}),(0,b.jsx)("div",{className:"h-6 w-px bg-gray-300"}),(0,b.jsx)("h1",{className:"text-2xl font-bold",style:{color:"#8B1538"},children:"My Profile"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)(q.Button,{onClick:()=>{a.push("/dashboard")},variant:"outline",size:"sm",style:{borderColor:"#FF7900",color:"#8B1538"},children:[(0,b.jsx)(T.ArrowLeft,{className:"w-4 h-4 mr-2"}),"Dashboard"]}),(0,b.jsx)(q.Button,{onClick:n,variant:"outline",size:"sm",style:{borderColor:"#8B1538",color:"#8B1538"},children:"Logout"})]})]})})}),(0,b.jsx)("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"rounded-xl overflow-hidden",style:{background:"white",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.05)"},children:(0,b.jsx)("div",{className:"p-6",style:{background:"linear-gradient(135deg, #FF7900 0%, #8B1538 50%, #006400 100%)",color:"white"},children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"w-16 h-16 rounded-full flex items-center justify-center text-white font-bold text-xl",style:{background:"rgba(255, 255, 255, 0.2)"},children:(f?.fullName||"U").split(" ").map(a=>a[0]).join("").toUpperCase()}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{className:"text-2xl font-semibold mb-1",children:["Welcome, ",f?.fullName,"!"]}),(0,b.jsx)("p",{className:"text-white/90",children:"Manage your profile information to help others in the Sri Lankan community connect with you."})]})]})})}),(0,b.jsx)(w,{}),(0,b.jsx)(H,{}),(0,b.jsx)(J,{}),(0,b.jsx)(P,{}),m&&(0,b.jsx)("div",{className:"bg-white rounded-xl shadow p-6 text-center",children:(0,b.jsxs)("div",{className:"flex items-center justify-center gap-3",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2",style:{borderColor:"#FF7900"}}),(0,b.jsx)("p",{style:{color:"#8B1538"},children:"Loading profile..."})]})})]})}),(0,b.jsx)(U.default,{})]})})}a.s(["default",()=>V],43827)}];

//# sourceMappingURL=src_app_%28dashboard%29_profile_page_tsx_f74027b2._.js.map